# è¶…çº§å¤§è„‘ - åˆçº¦äº¤æ˜“æ–¹æ¡ˆ

> **æœ€åæ›´æ–°**: 2026-02-05
> **ç³»ç»Ÿç‰ˆæœ¬**: V3.0 - 30H+5HåŒé‡éªŒè¯ + è‡ªé€‚åº”è¶‹åŠ¿åˆ¤æ–­
> **æ ¸å¿ƒç‰¹æ€§**: Big4åŒé‡è¶‹åŠ¿éªŒè¯ + æ™ºèƒ½åˆ†æ‰¹å»ºä»“ + æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢ + æ™ºèƒ½å¹³ä»“ä¼˜åŒ–

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒæ¶æ„](#æ ¸å¿ƒæ¶æ„)
3. [äº¤æ˜“æµç¨‹](#äº¤æ˜“æµç¨‹)
4. [Big4è¶‹åŠ¿åˆ¤æ–­ç³»ç»Ÿ](#big4è¶‹åŠ¿åˆ¤æ–­ç³»ç»Ÿ)
5. [ä¿¡å·ç³»ç»Ÿ](#ä¿¡å·ç³»ç»Ÿ)
6. [é£é™©æ§åˆ¶](#é£é™©æ§åˆ¶)
7. [æ™ºèƒ½å»ºä»“ä¸å¹³ä»“](#æ™ºèƒ½å»ºä»“ä¸å¹³ä»“)
8. [æ¨¡å¼åˆ‡æ¢ç³»ç»Ÿ](#æ¨¡å¼åˆ‡æ¢ç³»ç»Ÿ)
9. [æ€§èƒ½æŒ‡æ ‡](#æ€§èƒ½æŒ‡æ ‡)
10. [è¿ç»´ç®¡ç†](#è¿ç»´ç®¡ç†)

---

## ç³»ç»Ÿæ¦‚è¿°

### å®šä½

**è¶…çº§å¤§è„‘åˆçº¦äº¤æ˜“ç³»ç»Ÿ** æ˜¯ä¸€ä¸ªå…·å¤‡è‡ªæˆ‘å­¦ä¹ èƒ½åŠ›çš„æ™ºèƒ½åŒ–æœŸè´§åˆçº¦äº¤æ˜“å¹³å°ï¼Œé€šè¿‡**30H+5HåŒé‡è¶‹åŠ¿éªŒè¯**ã€å¤šå±‚ä¿¡å·è¯„åˆ†ã€æ™ºèƒ½åˆ†æ‰¹å»ºä»“å’ŒåŠ¨æ€æ¨¡å¼åˆ‡æ¢æœºåˆ¶ï¼Œå®ç°ç¨³å®šç›ˆåˆ©ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- ğŸ§  **åŒé‡è¶‹åŠ¿éªŒè¯**: 30Hå¤§è¶‹åŠ¿ + 5Hå°è¶‹åŠ¿ï¼Œé¿å…è¶‹åŠ¿è½¬æŠ˜ç‚¹é€†åŠ¿å¼€ä»“
- ğŸ“Š **Big4å¸‚åœºåˆ¤æ–­**: åŸºäºBTC/ETH/BNB/SOLçš„1H/15M/5Må¤šçº§åˆ†æ
- ğŸ¯ **æ™ºèƒ½åˆ†æ‰¹å»ºä»“**: 3æ‰¹æ¬¡å…¥åœº(30%-30%-40%)ï¼Œ60åˆ†é’ŸåŠ¨æ€ä»·æ ¼ä¼˜åŒ–
- ğŸ›¡ï¸ **8å±‚é£æ§ä½“ç³»**: ä»å›ºå®šæ­¢æŸåˆ°æ™ºèƒ½å¹³ä»“ï¼Œå…¨æ–¹ä½ä¿æŠ¤èµ„é‡‘
- ğŸ”„ **è‡ªåŠ¨æ¨¡å¼åˆ‡æ¢**: è¶‹åŠ¿å¸‚/éœ‡è¡å¸‚è‡ªåŠ¨è¯†åˆ«ï¼Œå·®å¼‚åŒ–ç­–ç•¥
- âš¡ **å®æ—¶æ™ºèƒ½ç›‘æ§**: WebSocketä»·æ ¼ + Kçº¿å¼ºåº¦æ£€æµ‹ + åŠ¨æ€å¹³ä»“çª—å£

### é€‚ç”¨åœºæ™¯

- âœ… 24å°æ—¶è‡ªåŠ¨åŒ–äº¤æ˜“
- âœ… çŸ­çº¿è¶‹åŠ¿æ•æ‰(4å°æ—¶æŒä»“)
- âœ… Uæœ¬ä½åˆçº¦5xæ æ†
- âœ… ç›‘æ§100+ä¸»æµäº¤æ˜“å¯¹

### ç³»ç»Ÿè§„æ¨¡

- **æ ¸å¿ƒä»£ç **: 7195è¡Œ
- **ä¸»è¦æ¨¡å—**: 6ä¸ª
- **æ‰«æé¢‘ç‡**: Big4æ¯15åˆ†é’Ÿï¼Œä¿¡å·æ¯5åˆ†é’Ÿï¼Œå¹³ä»“æ¯ç§’

---

## æ ¸å¿ƒæ¶æ„

### ç³»ç»Ÿç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è¶…çº§å¤§è„‘åˆçº¦äº¤æ˜“ç³»ç»Ÿ V3.0                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Big4è¶‹åŠ¿æ£€æµ‹  â”‚  â”‚ ä»·æ ¼æ¨é€æœåŠ¡  â”‚  â”‚ ä¿¡å·ç”Ÿæˆå™¨   â”‚     â”‚
â”‚  â”‚ 30H+5HéªŒè¯   â”‚â†’ â”‚ WebSocket    â”‚â†’ â”‚ 10ç§è¯„åˆ†ä¿¡å· â”‚     â”‚
â”‚  â”‚ è¶‹åŠ¿ä¿®æ­£é€»è¾‘  â”‚  â”‚ Price Cache  â”‚  â”‚ 35åˆ†é˜ˆå€¼     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â†“                                    â†“              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ æ¨¡å¼åˆ‡æ¢å™¨    â”‚                    â”‚ ä¿¡å·è¿‡æ»¤ç³»ç»Ÿ  â”‚     â”‚
â”‚  â”‚ Trend/Range â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’   â”‚ é»‘åå•+åˆ†çº§  â”‚     â”‚
â”‚  â”‚ è‡ªåŠ¨åˆ¤æ–­     â”‚                    â”‚ é˜²æŠ¤æœºåˆ¶     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                             â†“              â”‚
â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚                                      â”‚ æ™ºèƒ½äº¤æ˜“æœåŠ¡  â”‚     â”‚
â”‚                                      â”‚ Smart Trader â”‚     â”‚
â”‚                                      â”‚ 3045è¡Œä»£ç    â”‚     â”‚
â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                             â†“              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â”‚          å»ºä»“ä¸å¹³ä»“ç³»ç»Ÿ                 â”‚         â”‚
â”‚         â”‚  â€¢ æ™ºèƒ½å»ºä»“ (3æ‰¹10åˆ†é’Ÿä»·æ ¼ä¼˜åŒ–)        â”‚         â”‚
â”‚         â”‚  â€¢ æ™ºèƒ½å¹³ä»“ (8å±‚æ£€æŸ¥+30åˆ†é’Ÿçª—å£)       â”‚         â”‚
â”‚         â”‚  â€¢ Kçº¿å¼ºåº¦ (15åˆ†é’Ÿè¡°å‡æ£€æµ‹)            â”‚         â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                          â†“                                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â”‚         éœ‡è¡å¸‚ç­–ç•¥ (å¯é€‰)               â”‚         â”‚
â”‚         â”‚  â€¢ å¸ƒæ—å¸¦å‡å€¼å›å½’                      â”‚         â”‚
â”‚         â”‚  â€¢ Big4=NEUTRALæ—¶å¯ç”¨                 â”‚         â”‚
â”‚         â”‚  â€¢ 15Mæ—¶é—´æ¡†æ¶                        â”‚         â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Python 3.9+
- **æ¡†æ¶**: FastAPI (å¼‚æ­¥Webæ¡†æ¶)
- **æ•°æ®åº“**: MySQL 8.0
- **äº¤æ˜“æ‰€**: Binance Futures API
- **å®æ—¶é€šè®¯**: WebSocket
- **è°ƒåº¦**: scheduleåº“ + asyncio

---

## äº¤æ˜“æµç¨‹

### å®Œæ•´äº¤æ˜“ç”Ÿå‘½å‘¨æœŸ

```
1. Big4è¶‹åŠ¿åˆ¤æ–­é˜¶æ®µ (15åˆ†é’Ÿä¸€æ¬¡ï¼Œç¼“å­˜1å°æ—¶)
   â”œâ”€ 1H 30æ ¹Kçº¿åˆ†æ (å¤§è¶‹åŠ¿: BULL/BEAR/NEUTRAL)
   â”œâ”€ 1H 5æ ¹Kçº¿åˆ†æ (å°è¶‹åŠ¿: BULL/BEAR/NEUTRAL)
   â”œâ”€ è¶‹åŠ¿ä¿®æ­£é€»è¾‘:
   â”‚  â€¢ 30Hä¸‹è·Œ+5Hä¸Šæ¶¨ â†’ NEUTRAL (ä¸åšç©º)
   â”‚  â€¢ 30Hä¸Šæ¶¨+5Hä¸‹è·Œ â†’ NEUTRAL (ä¸åšå¤š)
   â”‚  â€¢ 30Héœ‡è¡ â†’ è·Ÿéš5H
   â”‚  â€¢ 30Hä¸5Hä¸€è‡´ â†’ ä¿æŒå¤§è¶‹åŠ¿
   â””â”€ è¾“å‡º: BULLISH/BEARISH/NEUTRAL + å¼ºåº¦0-100

2. ä¿¡å·äº§ç”Ÿé˜¶æ®µ (5åˆ†é’Ÿä¸€æ¬¡)
   â”œâ”€ Kçº¿æ•°æ®åŠ è½½ (1D/1H/15M, 72å°æ—¶)
   â”œâ”€ 10ç§ä¿¡å·è¯„åˆ†:
   â”‚  â€¢ position_low/mid/high (ä½ç½®è¯„åˆ† 20/5/20åˆ†)
   â”‚  â€¢ momentum_up/down_3pct (åŠ¨é‡ 10åˆ†)
   â”‚  â€¢ trend_1h_bull/bear (è¶‹åŠ¿ 20åˆ†)
   â”‚  â€¢ volatility_high (æ³¢åŠ¨ 10åˆ†)
   â”‚  â€¢ consecutive_bull/bear (è¿ç»­ 15åˆ†)
   â”‚  â€¢ volume_power_bull/bear (é‡èƒ½ 25åˆ†)
   â”‚  â€¢ breakout_long/breakdown_short (çªç ´ 20åˆ†)
   â””â”€ ç»¼åˆè¯„åˆ† (é˜ˆå€¼35åˆ†)

3. ä¿¡å·è¿‡æ»¤é˜¶æ®µ
   â”œâ”€ Big4è¿‡æ»¤:
   â”‚  â€¢ BEARISHå¸‚åœº + LONGä¿¡å· â†’ é™åˆ†æˆ–è·³è¿‡
   â”‚  â€¢ BULLISHå¸‚åœº + SHORTä¿¡å· â†’ é™åˆ†æˆ–è·³è¿‡
   â”‚  â€¢ é¡ºåŠ¿ä¿¡å· â†’ åŠ åˆ† + ä»“ä½Ã—1.2
   â”œâ”€ é»‘åå•æ£€æŸ¥ (ä¿¡å·ç»„åˆ/å¸ç§)
   â”œâ”€ åˆ†çº§æ£€æŸ¥ (Level 0-3, 3ç¦æ­¢)
   â”œâ”€ é˜²è¿½é«˜æ£€æŸ¥ (ä¸Šå½±çº¿/è¿ç»­ä¸Šæ¶¨)
   â””â”€ ä»“ä½æ•°é‡é™åˆ¶

4. æ™ºèƒ½å»ºä»“é˜¶æ®µ (60åˆ†é’Ÿçª—å£ï¼Œ3æ‰¹åˆ†é…)
   â”œâ”€ å¯åŠ¨ä»·æ ¼é‡‡æ ·å™¨ (0-60åˆ†é’Ÿå®æ—¶é‡‡æ ·)
   â”œâ”€ Batch 1 (30%): 5-15åˆ†é’Ÿæœ€ä¼˜ä»·æ ¼
   â”‚  â€¢ ä»·æ ¼è¯„åˆ†â‰¥80 (æä¼˜)
   â”‚  â€¢ ä»·æ ¼çªç ´åŸºçº¿æå€¼
   â”‚  â€¢ å¼ºè¶‹åŠ¿+ä»·æ ¼å‡è‡³p75
   â”‚  â€¢ 12åˆ†é’Ÿå…œåº• / 15åˆ†é’Ÿå¼ºåˆ¶
   â”œâ”€ Batch 2 (30%): 5-20åˆ†é’Ÿæœ€ä¼˜ä»·æ ¼
   â”‚  â€¢ ä»·æ ¼å›è°ƒè‡³Batch1-0.3%
   â”‚  â€¢ ä»·æ ¼åœ¨p25ä»¥ä¸‹
   â”‚  â€¢ 10åˆ†é’Ÿå…œåº• / 20åˆ†é’Ÿå¼ºåˆ¶
   â””â”€ Batch 3 (40%): 8-28åˆ†é’Ÿæœ€ä¼˜ä»·æ ¼
      â€¢ ä»·æ ¼â‰¤å‰ä¸¤æ‰¹å¹³å‡
      â€¢ ä»·æ ¼åœ¨p50ä¸­ä½ä»¥ä¸‹
      â€¢ è·Batch2 8åˆ†é’Ÿ / 28åˆ†é’Ÿå¼ºåˆ¶

5. æŒä»“ç›‘æ§é˜¶æ®µ (8å±‚æ£€æŸ¥)
   â”œâ”€ ä¼˜å…ˆçº§1: å›ºå®šæ­¢æŸ (2%, æ— å»¶è¿Ÿ)
   â”œâ”€ ä¼˜å…ˆçº§2: å›ºå®šæ­¢ç›ˆ (6%, æ— å»¶è¿Ÿ)
   â”œâ”€ ä¼˜å…ˆçº§3: Kçº¿åè½¬ + äºæŸ>1%
   â”œâ”€ ä¼˜å…ˆçº§4: æ™ºèƒ½é¡¶åº•è¯†åˆ« (ç›ˆåˆ©â‰¥2% + å¼ºçƒˆåå‘)
   â”œâ”€ ä¼˜å…ˆçº§5: åŠ¨æ€è¶…æ—¶ (timeout_atå­—æ®µ)
   â”œâ”€ ä¼˜å…ˆçº§6: åˆ†é˜¶æ®µè¶…æ—¶ (1H-4Håˆ†æ®µæ£€æŸ¥)
   â”œâ”€ ä¼˜å…ˆçº§7: 4å°æ—¶ç»å¯¹è¶…æ—¶
   â””â”€ ä¼˜å…ˆçº§8: Kçº¿å¼ºåº¦è¡°å‡ + åˆ†æ‰¹å¹³ä»“

6. æ™ºèƒ½å¹³ä»“é˜¶æ®µ
   â”œâ”€ 30åˆ†é’Ÿå¹³ä»“çª—å£:
   â”‚  â€¢ T-30: å¯åŠ¨ä»·æ ¼é‡‡æ · (10åˆ†é’Ÿçª—å£)
   â”‚  â€¢ T-20: å®ŒæˆåŸºçº¿ï¼Œå¼€å§‹å¯»æ‰¾æœ€ä¼˜ä»·
   â”‚  â€¢ T+0: å¿…é¡»å¼ºåˆ¶æ‰§è¡Œ
   â”œâ”€ åˆ†æ‰¹å¹³ä»“ç­–ç•¥:
   â”‚  â€¢ ç›ˆåˆ©â‰¥2% + å¼ºåº¦<15 â†’ å¹³50%
   â”‚  â€¢ ç›ˆåˆ©â‰¥4% + å¼ºåº¦<20 â†’ å¹³70%
   â”‚  â€¢ æŒä»“â‰¥5å°æ—¶ â†’ å¹³100%
   â””â”€ è®°å½•å¹³ä»“åŸå› å’Œç›ˆäº

7. æ¨¡å¼åˆ‡æ¢æ£€æŸ¥ (è‡ªåŠ¨æ¨¡å¼)
   â”œâ”€ Big4=NEUTRAL + å¼ºåº¦<50 â†’ åˆ‡æ¢åˆ°éœ‡è¡æ¨¡å¼
   â”œâ”€ Big4=BULLISH/BEARISH + å¼ºåº¦â‰¥60 â†’ åˆ‡æ¢åˆ°è¶‹åŠ¿æ¨¡å¼
   â”œâ”€ å†·å´æœŸä¿æŠ¤ (120åˆ†é’Ÿ)
   â””â”€ å·®å¼‚åŒ–å‚æ•°åº”ç”¨
```

---

## Big4è¶‹åŠ¿åˆ¤æ–­ç³»ç»Ÿ

### ç³»ç»Ÿæ¶æ„

**æ–‡ä»¶**: `app/services/big4_trend_detector.py` (547è¡Œ)

**ç›‘æ§å¸ç§**:
- BTC/USDT (æƒé‡æœ€é«˜)
- ETH/USDT
- BNB/USDT
- SOL/USDT

### 30H+5HåŒé‡éªŒè¯é€»è¾‘

**æ ¸å¿ƒæ”¹è¿›** (2026-02-05):

é—®é¢˜: æŒä»“4å°æ—¶ï¼Œå´ç”¨30å°æ—¶è¶‹åŠ¿åˆ¤æ–­ â†’ æ—¶é—´ç»´åº¦ä¸åŒ¹é…ï¼Œå¯¼è‡´åœ¨çŸ­æœŸåå¼¹æ—¶ä»é€†åŠ¿åšç©º

è§£å†³æ–¹æ¡ˆ: **30Hå¤§è¶‹åŠ¿ + 5Hå°è¶‹åŠ¿åŒé‡éªŒè¯**

```
å¯¹æ¯ä¸ªå¸ç§ (BTC/ETH/BNB/SOL):

  â”Œâ”€ 1H Kçº¿ 30æ ¹åˆ†æ (å¤§è¶‹åŠ¿) â”€â”
  â”‚  â”œâ”€ ç»Ÿè®¡é˜³çº¿/é˜´çº¿æ•°é‡      â”‚
  â”‚  â”œâ”€ è®¡ç®—åŠ›åº¦ (ä»·æ ¼80% + æˆäº¤é‡20%)
  â”‚  â”œâ”€ æ£€æµ‹å¤§æ³¢åŠ¨Kçº¿ (>3%)   â”‚
  â”‚  â”œâ”€ ç»¼åˆåˆ¤æ–­:              â”‚
  â”‚  â”‚  â€¢ æ³¢åŠ¨ç‡<3% â†’ NEUTRAL  â”‚
  â”‚  â”‚  â€¢ æ¶¨è·Œå¹…<2% â†’ NEUTRAL  â”‚
  â”‚  â”‚  â€¢ é˜³çº¿â‰¥18/30 â†’ BULL   â”‚
  â”‚  â”‚  â€¢ é˜´çº¿â‰¥18/30 â†’ BEAR   â”‚
  â”‚  â””â”€ è¾“å‡º: 30Hå¤§è¶‹åŠ¿        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
  â”Œâ”€ 1H Kçº¿ 5æ ¹åˆ†æ (å°è¶‹åŠ¿) â”€â”
  â”‚  â”œâ”€ åŒæ ·çš„åŠ›åº¦è®¡ç®—é€»è¾‘     â”‚
  â”‚  â”œâ”€ åŠ¨æ€é˜ˆå€¼:              â”‚
  â”‚  â”‚  â€¢ é˜³çº¿â‰¥3/5 â†’ BULL     â”‚
  â”‚  â”‚  â€¢ é˜´çº¿â‰¥3/5 â†’ BEAR     â”‚
  â”‚  â””â”€ è¾“å‡º: 5Hå°è¶‹åŠ¿         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
  â”Œâ”€ è¶‹åŠ¿ä¿®æ­£è§„åˆ™ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          â”‚
  â”‚  IF 30H=BEAR AND 5H=BULL:
  â”‚     ä¿®æ­£ä¸º NEUTRAL
  â”‚     âš ï¸ å¤§è¶‹åŠ¿ä¸‹è·Œä½†çŸ­æœŸåå¼¹
  â”‚     â†’ ä¸åšç©ºäº†ï¼
  â”‚                          â”‚
  â”‚  IF 30H=BULL AND 5H=BEAR:
  â”‚     ä¿®æ­£ä¸º NEUTRAL
  â”‚     âš ï¸ å¤§è¶‹åŠ¿ä¸Šæ¶¨ä½†çŸ­æœŸå›è°ƒ
  â”‚     â†’ ä¸åšå¤šäº†ï¼
  â”‚                          â”‚
  â”‚  IF 30H=NEUTRAL:
  â”‚     è·Ÿéš5Hå°è¶‹åŠ¿
  â”‚                          â”‚
  â”‚  ELSE (30Hä¸5Hä¸€è‡´):
  â”‚     ä¿æŒ30Hå¤§è¶‹åŠ¿
  â”‚                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
  â”Œâ”€ ä¿¡å·ç”Ÿæˆ (æƒé‡æ‰“åˆ†) â”€â”€â”€â”
  â”‚  â€¢ ä¿®æ­£å1H: 60åˆ†        â”‚
  â”‚  â€¢ 15Mç¡®è®¤: 30åˆ†         â”‚
  â”‚  â€¢ 5Mæ—¶æœº: 10åˆ†          â”‚
  â”‚                          â”‚
  â”‚  æ€»åˆ†>30 â†’ BULLISH       â”‚
  â”‚  æ€»åˆ†<-30 â†’ BEARISH      â”‚
  â”‚  å…¶ä»– â†’ NEUTRAL          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®é™…æ¡ˆä¾‹

**åœºæ™¯**: å¸‚åœºå¤§è¶‹åŠ¿ä¸‹è·Œï¼Œä½†æœ€è¿‘å‡ å°æ—¶å¼€å§‹åå¼¹

```
å½“å‰çŠ¶æ€ (2026-02-05):
  BTC: 30Hæœ‰20æ ¹é˜´çº¿ï¼Œ5Hæœ‰3æ ¹é˜´çº¿ â†’ è¶‹åŠ¿ä¸€è‡´ â†’ BEARISH
  ETH: 30Hæœ‰21æ ¹é˜´çº¿ï¼Œ5Hæœ‰2æ ¹é˜´çº¿ â†’ è¶‹åŠ¿ä¸€è‡´ â†’ BEARISH

å‡è®¾æœªæ¥å‡ºç°åå¼¹:
  BTC: 30Hæœ‰20æ ¹é˜´çº¿ï¼Œ5Hæœ‰3æ ¹é˜³çº¿ â†’ è¶‹åŠ¿å†²çª
    â†’ ä¿®æ­£ä¸ºNEUTRAL
    â†’ âš ï¸è¶‹åŠ¿ä¿®æ­£: 30Hä¸‹è·Œ(20é˜´)ä½†5Håå¼¹(3é˜³) â†’ éœ‡è¡
    â†’ ç³»ç»Ÿä¸ä¼šå†åšç©ºäº†ï¼
```

### åº”ç”¨åˆ°äº¤æ˜“

**å¯¹å››å¤§å¤©ç‹æœ¬èº«**:
```python
if symbol in ['BTC/USDT', 'ETH/USDT', 'BNB/USDT', 'SOL/USDT']:
    use_symbol_specific_signal()  # ä½¿ç”¨è¯¥å¸ä¸“å±ä¿¡å·
```

**å¯¹å…¶ä»–å¸ç§**:
```python
market_signal = big4_result['overall_signal']  # æ•´ä½“å¸‚åœºåˆ¤æ–­

# å¸‚åœºçœ‹ç©º + LONGä¿¡å· â†’ æƒ©ç½š
if market_signal == 'BEARISH' and side == 'LONG':
    if signal_strength >= 60:
        skip_this_signal()  # å¼ºçƒˆçœ‹ç©ºï¼Œç›´æ¥è·³è¿‡
    else:
        penalty = signal_strength * 0.5
        final_score -= penalty

# å¸‚åœºçœ‹å¤š + SHORTä¿¡å· â†’ æƒ©ç½š
elif market_signal == 'BULLISH' and side == 'SHORT':
    if signal_strength >= 60:
        skip_this_signal()
    else:
        penalty = signal_strength * 0.5
        final_score -= penalty

# é¡ºåŠ¿ä¿¡å· â†’ å¥–åŠ±
elif (market_signal == 'BEARISH' and side == 'SHORT') or \
     (market_signal == 'BULLISH' and side == 'LONG'):
    bonus = min(20, signal_strength * 0.3)
    final_score += bonus
```

**ä»“ä½å€æ•°è°ƒæ•´**:
```python
# é¡ºåŠ¿åŠ ä»“
if (market_signal == 'BULLISH' and side == 'LONG') or \
   (market_signal == 'BEARISH' and side == 'SHORT'):
    position_multiplier = 1.2
else:
    position_multiplier = 1.0
```

### ç¼“å­˜æœºåˆ¶

- **æ£€æµ‹é¢‘ç‡**: 15åˆ†é’Ÿä¸€æ¬¡
- **ç¼“å­˜æ—¶é•¿**: 1å°æ—¶
- **é™çº§ä¿æŠ¤**: DBæŸ¥è¯¢å¤±è´¥è¿”å›NEUTRAL

---

## ä¿¡å·ç³»ç»Ÿ

### 10ç§è¯„åˆ†ä¿¡å·

**æ–‡ä»¶**: `smart_trader_service.py` (3045è¡Œ)

**Kçº¿æ•°æ®æº**:
- 1D: 50æ ¹ (ä½ç½®åˆ†æ)
- 1H: 100æ ¹ (è¶‹åŠ¿+é‡èƒ½)
- 15M: 96æ ¹ (é‡èƒ½ç¡®è®¤)

| ä¿¡å· | LONGæƒé‡ | SHORTæƒé‡ | è§¦å‘æ¡ä»¶ |
|------|---------|---------|--------|
| position_low | 20 | 0 | 72Hä»·æ ¼ä½ç½®<30% |
| position_mid | 5 | 5 | 72Hä»·æ ¼ä½ç½®30-70% |
| position_high | 0 | 20 | 72Hä»·æ ¼ä½ç½®>70% |
| momentum_up_3pct | 10 | 0 | 24Hæ¶¨å¹…â‰¥3% |
| momentum_down_3pct | 0 | 10 | 24Hè·Œå¹…â‰¥3% |
| trend_1h_bull | 20 | 0 | 48Hå†…62.5%é˜³çº¿ |
| trend_1h_bear | 0 | 20 | 48Hå†…62.5%é˜´çº¿ |
| volatility_high | 10 | 10 | 24Hæ³¢åŠ¨ç‡>5% |
| consecutive_bull | 15 | 0 | æœ€è¿‘10Hä¸­7æ ¹é˜³çº¿ |
| consecutive_bear | 0 | 15 | æœ€è¿‘10Hä¸­7æ ¹é˜´çº¿ |
| volume_power_bull | 25 | 0 | 1H+15MåŒå¼ºæˆ–å•å¼º |
| volume_power_bear | 0 | 25 | 1H+15MåŒå¼±æˆ–å•å¼± |
| breakout_long | 20 | 0 | é«˜ä½+é‡èƒ½ç¡®è®¤ |
| breakdown_short | 0 | 20 | ä½ä½+å‹åŠ›ç¡®è®¤ |

### é‡èƒ½è¯„åˆ†ç³»ç»Ÿ

**1Hé‡èƒ½** (æœ€è¿‘24H):
```python
net_power_1h = å¼ºé˜³çº¿æ•°é‡ - å¼ºé˜´çº¿æ•°é‡
```

**15Mé‡èƒ½** (æœ€è¿‘6H):
```python
net_power_15m = å¼ºé˜³çº¿æ•°é‡ - å¼ºé˜´çº¿æ•°é‡
```

**èåˆåˆ¤æ–­**:
```python
if net_power_1h >= 2 and net_power_15m >= 2:
    volume_power_bull +25åˆ†  # åŒé‡ç¡®è®¤
elif net_power_1h >= 3:
    volume_power_bull +20åˆ†  # 1Hå•ç‹¬å¼º
elif net_power_15m >= 3:
    volume_power_bull +15åˆ†  # 15Må•ç‹¬å¼º
```

### ä¿¡å·è¿‡æ»¤

**3å±‚éªŒè¯**:

1. **æ—¶é—´æ¡†æ¶ä¸€è‡´æ€§**
   ```python
   if side == 'LONG' and 'trend_1h_bear' in signals:
       return False  # åšå¤šä¸èƒ½æœ‰trend_1h_bear
   ```

2. **position_highé¢å¤–éªŒè¯**
   ```python
   if 'position_high' in signals and side == 'SHORT':
       # æ£€æŸ¥æœ€è¿‘10æ ¹Kçº¿ä¸Šå½±çº¿æ¯”ä¾‹
       if long_upper_shadow_ratio > 50%:
           return False  # å¯èƒ½æ˜¯ä¸Šæ¶¨è¶‹åŠ¿çš„å›è°ƒ

       # æ£€æŸ¥æˆäº¤é‡èç¼©
       if recent_volume < avg_volume * 0.8:
           return False  # é¡¶éƒ¨ç‰¹å¾ä¸æ˜æ˜¾
   ```

3. **ä¿¡å·ç»„åˆé»‘åå•**
   ```python
   signal_key = "position_low + volume_power_bull_LONG"
   if signal_key in blacklist:
       return False  # å†å²è¡¨ç°å·®
   ```

---

## é£é™©æ§åˆ¶

### ä»“ä½ç®¡ç†

**å•ä»“ä½é…ç½®**:
```yaml
base_margin: 400 USDT      # åŸºç¡€ä¿è¯é‡‘
leverage: 5x               # æ æ†å€æ•°
stop_loss: 2%              # æ­¢æŸæ¯”ä¾‹
take_profit: 6%            # æ­¢ç›ˆæ¯”ä¾‹
```

**åŠ¨æ€ä»“ä½è°ƒæ•´**:
```python
# 1. å¸ç§åˆ†çº§è°ƒæ•´
if rating_level == 1:
    margin *= 0.75   # Level1: -25%
elif rating_level == 2:
    margin *= 0.875  # Level2: -12.5%
elif rating_level == 3:
    margin *= 0      # Level3: ç¦æ­¢

# 2. Big4é¡ºåŠ¿åŠ ä»“
if (big4 == 'BULLISH' and side == 'LONG') or \
   (big4 == 'BEARISH' and side == 'SHORT'):
    margin *= 1.2    # é¡ºåŠ¿+20%

# 3. éœ‡è¡å¸‚ç­–ç•¥
if strategy == 'bollinger_mean_reversion':
    margin = 1.0     # å›ºå®šå€æ•°ï¼Œä¸ä½¿ç”¨Big4è°ƒæ•´
```

### 8å±‚é£æ§ä½“ç³»

**ä¼˜å…ˆçº§ä»é«˜åˆ°ä½**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¼˜å…ˆçº§0: æœ€å°æŒä»“2å°æ—¶é™åˆ¶                   â”‚
â”‚ â€¢ å¼€ä»“2å°æ—¶å†…åªå…è®¸æ­¢æŸ/æ­¢ç›ˆ                 â”‚
â”‚ â€¢ é¿å…è¿‡åº¦é¢‘ç¹å¹³ä»“                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§1: å›ºå®šæ­¢æŸ (2%)                      â”‚
â”‚ â€¢ LONG: price <= stop_loss_price            â”‚
â”‚ â€¢ SHORT: price >= stop_loss_price           â”‚
â”‚ â€¢ æ— å»¶è¿Ÿï¼Œç«‹å³å¸‚ä»·å¹³ä»“                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§2: å›ºå®šæ­¢ç›ˆ (6%)                      â”‚
â”‚ â€¢ LONG: price >= take_profit_price          â”‚
â”‚ â€¢ SHORT: price <= take_profit_price         â”‚
â”‚ â€¢ æ— å»¶è¿Ÿï¼Œç«‹å³å¸‚ä»·å¹³ä»“                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æ»¡è¶³2å°æ—¶æœ€å°æŒä»“åï¼Œè¿›è¡Œä»¥ä¸‹æ£€æŸ¥]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§3: Kçº¿å¼ºåº¦è¡°å‡ + äºæŸåè½¬              â”‚
â”‚ â€¢ äºæŸ>1% AND Kçº¿æ–¹å‘åè½¬                   â”‚
â”‚ â€¢ ç´§æ€¥é£æ§                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§4: æ™ºèƒ½é¡¶åº•è¯†åˆ«                       â”‚
â”‚ â€¢ LONGé¡¶éƒ¨: ç›ˆåˆ©â‰¥2% + 1H/4Hå¼ºçƒˆçœ‹ç©º        â”‚
â”‚ â€¢ SHORTåº•éƒ¨: ç›ˆåˆ©â‰¥2% + 1H/4Hå¼ºçƒˆçœ‹å¤š       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§5: åŠ¨æ€è¶…æ—¶æ£€æŸ¥                       â”‚
â”‚ â€¢ æ£€æŸ¥timeout_atå­—æ®µ                        â”‚
â”‚ â€¢ max_hold_minutesé…ç½®                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§6: åˆ†é˜¶æ®µè¶…æ—¶æ£€æŸ¥ (1H/2H/3H/4H)       â”‚
â”‚ â€¢ 1H: -2.5%äºæŸ â†’ å¼ºåˆ¶å¹³ä»“                 â”‚
â”‚ â€¢ 2H: -2.0%äºæŸ â†’ å¼ºåˆ¶å¹³ä»“                 â”‚
â”‚ â€¢ 3H: -1.5%äºæŸ â†’ å¼ºåˆ¶å¹³ä»“                 â”‚
â”‚ â€¢ 4H: -1.0%äºæŸ â†’ å¼ºåˆ¶å¹³ä»“                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§7: 4å°æ—¶ç»å¯¹æ—¶é—´å¼ºåˆ¶å¹³ä»“              â”‚
â”‚ â€¢ max_hold_minutes = 240åˆ†é’Ÿ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä¼˜å…ˆçº§8: Kçº¿å¼ºåº¦è¡°å‡ + åˆ†é˜¶æ®µéƒ¨åˆ†å¹³ä»“       â”‚
â”‚ â€¢ ç›ˆåˆ©â‰¥2% + å¼ºåº¦<15 â†’ å¹³50%                â”‚
â”‚ â€¢ ç›ˆåˆ©â‰¥4% + å¼ºåº¦<20 â†’ å¹³70%                â”‚
â”‚ â€¢ æŒä»“â‰¥5å°æ—¶ â†’ å¹³100%                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3çº§é»‘åå•åˆ¶åº¦

| ç­‰çº§ | ä¿è¯é‡‘å€æ•° | è¯´æ˜ |
|------|----------|------|
| Level0 | 1.0 | ç™½åå•ï¼ˆé»˜è®¤ï¼‰ |
| Level1 | 0.75 | è­¦å‘Šï¼šé™25% |
| Level2 | 0.875 | è°¨æ…ï¼šé™12.5% |
| Level3 | 0 | æ°¸ä¹…ç¦æ­¢ |

**ç™½åå•ä¿æŠ¤**: BTC, ETH, BNB, SOLæ°¸ä¸è¿›å…¥é»‘åå•

---

## æ™ºèƒ½å»ºä»“ä¸å¹³ä»“

### åˆ†æ‰¹å»ºä»“ (SmartEntryExecutor)

**æ–‡ä»¶**: `app/services/smart_entry_executor.py` (1281è¡Œ)

**3æ‰¹é…ç½®**:
```yaml
batch_1: 30%  # 5-15åˆ†é’Ÿ
batch_2: 30%  # 5-20åˆ†é’Ÿ
batch_3: 40%  # 8-28åˆ†é’Ÿ
total_window: 60åˆ†é’Ÿ
```

**ä»·æ ¼é‡‡æ ·å™¨**:
```python
# å¯åŠ¨åå°é‡‡æ · (10ç§’é—´éš”)
sampler.start_sampling()

# é‡‡æ ·æ•°æ®
{
    'min_price': æœ€ä½ä»·,
    'max_price': æœ€é«˜ä»·,
    'p25': 25åˆ†ä½,
    'p50': ä¸­ä½æ•°,
    'p75': 75åˆ†ä½,
    'trend': è¶‹åŠ¿æ–¹å‘,
    'stop_falling_score': æ­¢è·Œä¿¡å·å¼ºåº¦
}
```

**æ‰§è¡Œç­–ç•¥**:

```python
# Batch 1 (30%): æä¼˜ä»·æ ¼æˆ–12åˆ†é’Ÿå…œåº•
if price_score >= 80 or \
   (price_score >= 60 and stop_falling >= 50) or \
   elapsed >= 12åˆ†é’Ÿ:
    execute_batch_1()

# Batch 2 (30%): å›è°ƒä»·æ ¼æˆ–10åˆ†é’Ÿå…œåº•
if price <= batch1_price - 0.3% or \
   price <= baseline_p25 or \
   elapsed_since_batch1 >= 10åˆ†é’Ÿ:
    execute_batch_2()

# Batch 3 (40%): ä¸é«˜äºå¹³å‡æˆ–8åˆ†é’Ÿå…œåº•
if price <= avg(batch1, batch2) or \
   price <= baseline_p50 or \
   elapsed_since_batch2 >= 8åˆ†é’Ÿ:
    execute_batch_3()

# è¶…æ—¶å¼ºåˆ¶: è·ä¿¡å·28åˆ†é’Ÿæˆ–æ€»æ—¶é•¿60åˆ†é’Ÿ
if elapsed >= 60åˆ†é’Ÿ:
    force_execute_remaining()
```

### æ™ºèƒ½å¹³ä»“ (SmartExitOptimizer)

**æ–‡ä»¶**: `app/services/smart_exit_optimizer.py` (1354è¡Œ)

**30åˆ†é’Ÿå¹³ä»“çª—å£**:

```
è®¡åˆ’å¹³ä»“æ—¶é—´ (planned_close_time)
   â†“
[T-30åˆ†é’Ÿ] å¯åŠ¨ä»·æ ¼é‡‡æ ·å™¨
   â”œâ”€ 10åˆ†é’Ÿçª—å£é‡‡æ ·
   â”œâ”€ å»ºç«‹ä»·æ ¼åŸºçº¿ (min/max/p25/p50/p75)
   â””â”€ è®°å½•è¶‹åŠ¿æ–¹å‘
   â†“
[T-20åˆ†é’Ÿ] å¼€å§‹å¯»æ‰¾æœ€ä¼˜å¹³ä»“ä»·æ ¼
   â”œâ”€ æ¯ç§’æ£€æŸ¥ä»·æ ¼è¯„åˆ†
   â”œâ”€ è¯„åˆ†>=95 (æä½³) â†’ ç«‹å³å¹³ä»“
   â”œâ”€ è¯„åˆ†>=85 (ä¼˜ç§€) â†’ ç«‹å³å¹³ä»“
   â””â”€ è¯„åˆ†>=60 + æ¥è¿‘æˆªæ­¢ â†’ å¹³ä»“
   â†“
[T+0] å¿…é¡»å¼ºåˆ¶æ‰§è¡Œ
   â””â”€ æ— è®ºä»·æ ¼å¦‚ä½•ï¼Œå¸‚ä»·å¹³ä»“
```

**åˆ†æ‰¹å¹³ä»“** (Kçº¿å¼ºåº¦è¡°å‡):

```python
# æ¯15åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
def check_kline_strength():
    if profit >= 2% and kline_score < 15:
        close_partial(50%)  # é”å®š50%åˆ©æ¶¦

    if profit >= 4% and kline_score < 20:
        close_partial(70%)  # é”å®š70%åˆ©æ¶¦

    if holding_time >= 5å°æ—¶:
        close_position(100%)  # å…¨å¹³
```

---

## æ¨¡å¼åˆ‡æ¢ç³»ç»Ÿ

### TradingModeSwitcher

**æ–‡ä»¶**: `app/strategies/mode_switcher.py` (316è¡Œ)

**è‡ªåŠ¨åˆ‡æ¢è§„åˆ™**:

```python
def auto_switch_check(big4_signal, big4_strength):
    """
    å‰æ: auto_switch_enabled = True
    """

    # éœ‡è¡å¸‚åˆ¤æ–­
    is_ranging = (big4_signal == 'NEUTRAL' and big4_strength < 50)

    # è¶‹åŠ¿å¸‚åˆ¤æ–­
    is_trending = (big4_signal in ['BULLISH', 'BEARISH'] and
                   big4_strength >= 60)

    # åˆ‡æ¢å†³ç­–
    if is_ranging and current_mode != 'range':
        switch_to('range')  # åˆ‡æ¢åˆ°éœ‡è¡æ¨¡å¼

    elif is_trending and current_mode != 'trend':
        switch_to('trend')  # åˆ‡æ¢åˆ°è¶‹åŠ¿æ¨¡å¼

    # å†·å´æœŸä¿æŠ¤: 120åˆ†é’Ÿ
```

### æ¨¡å¼å‚æ•°å·®å¼‚

| å‚æ•° | è¶‹åŠ¿æ¨¡å¼ | éœ‡è¡æ¨¡å¼ |
|------|---------|---------|
| ç­–ç•¥ | å¤šä¿¡å·è¯„åˆ† | å¸ƒæ—å¸¦å‡å€¼å›å½’ |
| æ—¶é—´æ¡†æ¶ | 1H/15M | 15M |
| ä»“ä½å¤§å° | åŠ¨æ€(Big4è°ƒæ•´) | å›ºå®š1.0 |
| å»ºä»“æ–¹å¼ | åˆ†æ‰¹(3æ‰¹60åˆ†é’Ÿ) | ä¸€æ¬¡æ€§ |
| æŒä»“æ—¶é—´ | 4å°æ—¶ | å¯é… |
| Big4è¿‡æ»¤ | æ˜¯ | å¦(ä»…NEUTRALæ—¶å¯ç”¨) |

### éœ‡è¡å¸‚ç­–ç•¥ (BollingerMeanReversion)

**æ–‡ä»¶**: `app/strategies/bollinger_mean_reversion.py` (362è¡Œ)

**å‚æ•°**:
```yaml
bb_period: 20
bb_std: 2.0
rsi_period: 14
rsi_oversold: 25
rsi_overbought: 75
bb_lower: 0.10  # åšå¤šé˜ˆå€¼
bb_upper: 0.90  # åšç©ºé˜ˆå€¼
```

**åšå¤šä¿¡å·**:
```python
if bb_position < 0.10 and rsi < 25:
    if not has_downtrend:
        signal = 'LONG'
        score = 60

        if bb_position < 0.05:
            score += 15  # ç´§è´´ä¸‹è½¨
        if bb_width >= 4.0:
            score += 10  # æ³¢åŠ¨ç‡å……è¶³
```

**è¿‡æ»¤æ¡ä»¶**:
1. Big4å¿…é¡»æ˜¯NEUTRAL
2. BBå®½åº¦â‰¥2%
3. æˆäº¤é‡æ”¾å¤§>1.2å€å¹³å‡
4. ä¸åœ¨æ˜æ˜¾è¶‹åŠ¿ä¸­

---

## æ€§èƒ½æŒ‡æ ‡

### ä»£ç è§„æ¨¡

```
smart_trader_service.py      3,045è¡Œ  â† æ ¸å¿ƒå¤§è„‘+å¼€ä»“
smart_exit_optimizer.py      1,354è¡Œ  â† å¹³ä»“å¼•æ“
smart_entry_executor.py      1,281è¡Œ  â† åˆ†æ‰¹å»ºä»“
big4_trend_detector.py         547è¡Œ  â† å¸‚åœºåˆ¤æ–­
bollinger_mean_reversion.py    362è¡Œ  â† éœ‡è¡ç­–ç•¥
mode_switcher.py               316è¡Œ  â† æ¨¡å¼åˆ‡æ¢
range_market_detector.py       290è¡Œ  â† åŒºé—´æ£€æµ‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                         7,195è¡Œ
```

### æ‰«æé¢‘ç‡

- **Big4æ£€æµ‹**: 15åˆ†é’Ÿ/æ¬¡ï¼ˆç¼“å­˜1å°æ—¶ï¼‰
- **äº¤æ˜“æœºä¼šæ‰«æ**: 5åˆ†é’Ÿ/æ¬¡
- **å¹³ä»“ç›‘æ§**: æ¯ç§’å®æ—¶
- **Kçº¿å¼ºåº¦æ£€æŸ¥**: 15åˆ†é’Ÿ/æ¬¡
- **æ¨¡å¼åˆ‡æ¢æ£€æŸ¥**: éšBig4æ›´æ–°

### å…³é”®ç»©æ•ˆæŒ‡æ ‡

**ç›ˆåˆ©æŒ‡æ ‡**:
- èƒœç‡ (Win Rate): >55%
- ç›ˆäºæ¯” (P/L Ratio): >2.0
- åˆ©æ¶¦å› å­ (Profit Factor): >1.5

**é£é™©æŒ‡æ ‡**:
- æœ€å¤§å›æ’¤ (Max Drawdown): <15%
- å¤æ™®æ¯”ç‡ (Sharpe Ratio): >1.5
- ç´¢æè¯ºæ¯”ç‡ (Sortino Ratio): >2.0

**äº¤æ˜“æŒ‡æ ‡**:
- å¹³å‡æŒä»“æ—¶é—´: 4å°æ—¶
- å¹³å‡å…¥åœºè¯„åˆ†: >40åˆ†
- æ—¥å‡äº¤æ˜“æ•°: 10-20ç¬”

---

## è¿ç»´ç®¡ç†

### å¯åŠ¨æœåŠ¡

```bash
# æ–¹å¼1: ç›´æ¥è¿è¡Œ
python app/main.py

# æ–¹å¼2: åå°è¿è¡Œ
nohup python app/main.py > logs/smart_trader.log 2>&1 &

# æ–¹å¼3: systemdæœåŠ¡ (æ¨è)
sudo systemctl start smart-trader
sudo systemctl enable smart-trader
```

### æ—¥å¿—ç›‘æ§

**å…³é”®æ—¥å¿—æ ‡ç­¾**:
```
[BIG4-MARKET]    - Big4å¸‚åœºè¶‹åŠ¿åˆ¤æ–­
[BIG4-CORRECT]   - è¶‹åŠ¿ä¿®æ­£é€»è¾‘
[BIG4-SKIP]      - Big4è¿‡æ»¤è·³è¿‡çš„ä¿¡å·
[BIG4-ADJUST]    - Big4è°ƒæ•´åçš„è¯„åˆ†
[BLACKLIST]      - ä¿¡å·é»‘åå•è¿‡æ»¤
[BATCH-ENTRY]    - åˆ†æ‰¹å»ºä»“æ‰§è¡Œ
[SMART-EXIT]     - æ™ºèƒ½å¹³ä»“æ‰§è¡Œ
[MODE-SWITCH]    - æ¨¡å¼åˆ‡æ¢
```

**æ—¥å¿—æŸ¥çœ‹**:
```bash
# å®æ—¶æŸ¥çœ‹
tail -f logs/smart_trader.log

# æŸ¥çœ‹Big4è¶‹åŠ¿ä¿®æ­£
grep "BIG4-CORRECT" logs/smart_trader.log

# æŸ¥çœ‹åˆ†æ‰¹å»ºä»“
grep "BATCH-ENTRY" logs/smart_trader.log

# æŸ¥çœ‹æ¨¡å¼åˆ‡æ¢
grep "MODE-SWITCH" logs/smart_trader.log
```

### å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹å½“å‰æŒä»“
mysql -h $DB_HOST -u $DB_USER -p$DB_PASSWORD -D binance-data \
  -e "SELECT symbol, position_side, unrealized_pnl_pct, status FROM futures_positions WHERE status='open';"

# æŸ¥çœ‹24Hç›ˆäº
mysql -h $DB_HOST -u $DB_USER -p$DB_PASSWORD -D binance-data \
  -e "SELECT SUM(realized_pnl) as total_pnl, COUNT(*) as trades FROM futures_positions WHERE close_time >= DATE_SUB(NOW(), INTERVAL 24 HOUR);"

# æŸ¥çœ‹Big4çŠ¶æ€
mysql -h $DB_HOST -u $DB_USER -p$DB_PASSWORD -D binance-data \
  -e "SELECT * FROM big4_trend_signals ORDER BY checked_at DESC LIMIT 1;"

# æŸ¥çœ‹æ¨¡å¼é…ç½®
mysql -h $DB_HOST -u $DB_USER -p$DB_PASSWORD -D binance-data \
  -e "SELECT * FROM trading_mode_config WHERE account_id='binance_tonny_usdt_futures';"

# æµ‹è¯•Big4æ£€æµ‹
python -c "from app.services.big4_trend_detector import Big4TrendDetector; d = Big4TrendDetector(); r = d.detect_market_trend(); print(f\"ä¿¡å·: {r['overall_signal']} | å¼ºåº¦: {r['signal_strength']:.0f}\")"
```

---

## é™„å½•

### æ•°æ®åº“è¡¨ç»“æ„

#### trading_mode_config (æ¨¡å¼é…ç½®è¡¨)

```sql
CREATE TABLE trading_mode_config (
    id INT AUTO_INCREMENT PRIMARY KEY,
    account_id VARCHAR(100) UNIQUE NOT NULL,
    trading_type VARCHAR(50) NOT NULL,
    current_mode ENUM('trend', 'range', 'auto') DEFAULT 'trend',
    auto_switch_enabled BOOLEAN DEFAULT FALSE,
    mode_updated_at DATETIME,
    mode_change_reason VARCHAR(500),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

#### big4_trend_signals (Big4è¶‹åŠ¿è®°å½•è¡¨)

```sql
CREATE TABLE big4_trend_signals (
    id INT AUTO_INCREMENT PRIMARY KEY,
    overall_signal ENUM('BULLISH', 'BEARISH', 'NEUTRAL') NOT NULL,
    signal_strength DECIMAL(5,2),
    bullish_count INT,
    bearish_count INT,
    recommendation TEXT,

    -- BTCæ•°æ®
    btc_signal VARCHAR(20),
    btc_strength DECIMAL(5,2),
    btc_reason TEXT,
    btc_1h_30_dominant VARCHAR(20),
    btc_1h_5_dominant VARCHAR(20),
    btc_15m_dominant VARCHAR(20),

    -- ETHæ•°æ®
    eth_signal VARCHAR(20),
    eth_strength DECIMAL(5,2),
    eth_reason TEXT,
    eth_1h_30_dominant VARCHAR(20),
    eth_1h_5_dominant VARCHAR(20),
    eth_15m_dominant VARCHAR(20),

    -- BNBæ•°æ®
    bnb_signal VARCHAR(20),
    bnb_strength DECIMAL(5,2),
    bnb_reason TEXT,
    bnb_1h_30_dominant VARCHAR(20),
    bnb_1h_5_dominant VARCHAR(20),
    bnb_15m_dominant VARCHAR(20),

    -- SOLæ•°æ®
    sol_signal VARCHAR(20),
    sol_strength DECIMAL(5,2),
    sol_reason TEXT,
    sol_1h_30_dominant VARCHAR(20),
    sol_1h_5_dominant VARCHAR(20),
    sol_15m_dominant VARCHAR(20),

    checked_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_checked_at (checked_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### é…ç½®ç¤ºä¾‹

**è‡ªåŠ¨æ¨¡å¼å¯ç”¨**:
```sql
UPDATE trading_mode_config
SET current_mode = 'auto',
    auto_switch_enabled = 1
WHERE account_id = 'binance_tonny_usdt_futures';
```

**æ‰‹åŠ¨åˆ‡æ¢åˆ°éœ‡è¡æ¨¡å¼**:
```sql
UPDATE trading_mode_config
SET current_mode = 'range',
    auto_switch_enabled = 0
WHERE account_id = 'binance_tonny_usdt_futures';
```

---

## æ€»ç»“

è¶…çº§å¤§è„‘åˆçº¦äº¤æ˜“ç³»ç»Ÿ V3.0 é€šè¿‡ä»¥ä¸‹æ ¸å¿ƒæœºåˆ¶å®ç°ç¨³å®šç›ˆåˆ©:

1. âœ… **30H+5HåŒé‡è¶‹åŠ¿éªŒè¯** - é¿å…è¶‹åŠ¿è½¬æŠ˜ç‚¹é€†åŠ¿å¼€ä»“
2. âœ… **Big4å¸‚åœºåˆ¤æ–­** - 1H/15M/5Må¤šçº§åˆ†æï¼ŒåŠ¨æ€ä»“ä½è°ƒæ•´
3. âœ… **10ç§ä¿¡å·è¯„åˆ†** - ä½ç½®+åŠ¨é‡+è¶‹åŠ¿+æ³¢åŠ¨+é‡èƒ½+çªç ´
4. âœ… **æ™ºèƒ½åˆ†æ‰¹å»ºä»“** - 3æ‰¹60åˆ†é’ŸåŠ¨æ€ä»·æ ¼ä¼˜åŒ–
5. âœ… **8å±‚é£æ§ä½“ç³»** - ä»å›ºå®šæ­¢æŸåˆ°æ™ºèƒ½å¹³ä»“å…¨è¦†ç›–
6. âœ… **è‡ªåŠ¨æ¨¡å¼åˆ‡æ¢** - è¶‹åŠ¿å¸‚/éœ‡è¡å¸‚è‡ªé€‚åº”ç­–ç•¥
7. âœ… **å®æ—¶æ™ºèƒ½ç›‘æ§** - WebSocketä»·æ ¼ + Kçº¿å¼ºåº¦ + 30åˆ†é’Ÿå¹³ä»“çª—å£

**å…³é”®æ”¹è¿›** (V3.0):
- è§£å†³äº†æŒä»“4Hä½†ç”¨30Håˆ¤æ–­çš„æ—¶é—´ç»´åº¦ä¸åŒ¹é…é—®é¢˜
- é€šè¿‡5Hå°è¶‹åŠ¿ä¿®æ­£30Hå¤§è¶‹åŠ¿ï¼Œç²¾å‡†è¯†åˆ«çŸ­æœŸåè½¬
- åŠ¨æ€é˜ˆå€¼è‡ªé€‚åº”ï¼ˆ30æ ¹ç”¨60%ï¼Œ5æ ¹ä¹Ÿç”¨60%ï¼‰
- è¶‹åŠ¿å†²çªæ—¶è‡ªåŠ¨ä¿®æ­£ä¸ºNEUTRALï¼Œé¿å…é€†åŠ¿å¼€ä»“

ç³»ç»Ÿå°†æŒç»­è¿›åŒ–ï¼Œé€šè¿‡æ•°æ®é©±åŠ¨å’Œè‡ªé€‚åº”å­¦ä¹ ä¸æ–­ä¼˜åŒ–äº¤æ˜“ç­–ç•¥ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: V3.0
**æœ€åæ›´æ–°**: 2026-02-05
**ç»´æŠ¤è€…**: è¶…çº§å¤§è„‘å¼€å‘å›¢é˜Ÿ
