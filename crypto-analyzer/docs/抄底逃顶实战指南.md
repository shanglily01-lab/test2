# åŠ å¯†è´§å¸æŠ„åº•é€ƒé¡¶å®æˆ˜æŒ‡å—

## ğŸ“– ç›®å½•

1. [å¤§è·Œè¡Œæƒ…æŠ„åº•ç¯‡](#1-å¤§è·Œè¡Œæƒ…æŠ„åº•ç¯‡)
2. [å¤§æ¶¨è¡Œæƒ…é€ƒé¡¶ç¯‡](#2-å¤§æ¶¨è¡Œæƒ…é€ƒé¡¶ç¯‡)
3. [ç»¼åˆå®æˆ˜æ¡ˆä¾‹](#3-ç»¼åˆå®æˆ˜æ¡ˆä¾‹)
4. [é£é™©æ§åˆ¶è¦ç‚¹](#4-é£é™©æ§åˆ¶è¦ç‚¹)

---

## 1. å¤§è·Œè¡Œæƒ…æŠ„åº•ç¯‡

### 1.1 æŠ„åº•çš„æœ¬è´¨

**æŠ„åº•ä¸æ˜¯èµŒåšï¼Œè€Œæ˜¯åŸºäºå¤šé‡ä¿¡å·ç¡®è®¤çš„æ¦‚ç‡æ¸¸æˆ**

```
é”™è¯¯çš„æŠ„åº• âŒ
â”œâ”€ æ„Ÿè§‰è·Œå¤šäº†å°±ä¹°
â”œâ”€ ä¸è®¾æ­¢æŸ
â””â”€ ä¸€æŠŠæ¢­å“ˆ

æ­£ç¡®çš„æŠ„åº• âœ…
â”œâ”€ å¤šé‡ä¿¡å·ç¡®è®¤
â”œâ”€ åˆ†æ‰¹å»ºä»“
â”œâ”€ ä¸¥æ ¼æ­¢æŸ
â””â”€ å¿«é€Ÿæ­¢ç›ˆ
```

---

### 1.2 æŠ„åº•çš„äº”å¤§æ ¸å¿ƒä¿¡å·

#### ğŸ¯ ä¿¡å·1: è¶…è·Œå¹…åº¦ï¼ˆå¿…è¦æ¡ä»¶ï¼‰

**çŸ­æœŸæš´è·Œæ‰æœ‰åå¼¹ç©ºé—´**

```python
def check_oversold_level(price_changes):
    """
    æ£€æŸ¥è¶…è·Œç¨‹åº¦

    Returns:
        level, is_oversold, potential_bounce
    """
    # è®¡ç®—ä¸åŒå‘¨æœŸè·Œå¹…
    drop_5m = price_changes['5m']    # 5åˆ†é’Ÿè·Œå¹…
    drop_15m = price_changes['15m']  # 15åˆ†é’Ÿè·Œå¹…
    drop_1h = price_changes['1h']    # 1å°æ—¶è·Œå¹…
    drop_4h = price_changes['4h']    # 4å°æ—¶è·Œå¹…
    drop_1d = price_changes['1d']    # 1å¤©è·Œå¹…

    # å®šä¹‰è¶…è·Œçº§åˆ«
    if drop_5m < -0.10:  # 5åˆ†é’Ÿè·Œè¶…10%
        return "EXTREME", True, "å¼ºçƒˆåå¼¹å¯èƒ½"

    if drop_15m < -0.12:  # 15åˆ†é’Ÿè·Œè¶…12%
        return "VERY_HIGH", True, "æå¤§åå¼¹å¯èƒ½"

    if drop_1h < -0.15:  # 1å°æ—¶è·Œè¶…15%
        return "HIGH", True, "é«˜åå¼¹å¯èƒ½"

    if drop_4h < -0.20:  # 4å°æ—¶è·Œè¶…20%
        return "HIGH", True, "é«˜åå¼¹å¯èƒ½"

    if drop_1d < -0.25:  # 1å¤©è·Œè¶…25%
        return "HIGH", True, "é«˜åå¼¹å¯èƒ½"

    if drop_1d < -0.15:  # 1å¤©è·Œè¶…15%
        return "MEDIUM", True, "ä¸­ç­‰åå¼¹å¯èƒ½"

    return "LOW", False, "è·Œå¹…ä¸å¤Ÿ"
```

**æŠ„åº•æœºä¼šåˆ†çº§**:
- ğŸ”´ **é—ªå´©çº§** (5åˆ†é’Ÿ > 10%): æœ€ä½³æŠ„åº•æœºä¼šï¼Œä½†è¦å¿«ï¼
- ğŸŸ  **æš´è·Œçº§** (1å°æ—¶ > 15%): ä¼˜è´¨æŠ„åº•æœºä¼š
- ğŸŸ¡ **æ·±è·Œçº§** (1å¤© > 20%): è‰¯å¥½æŠ„åº•æœºä¼š
- ğŸŸ¢ **ä¸­è·Œçº§** (1å¤© 10-20%): è§‚å¯Ÿæœºä¼š

---

#### ğŸ¯ ä¿¡å·2: RSIæåº¦è¶…å–ï¼ˆæ ¸å¿ƒæŒ‡æ ‡ï¼‰

**RSI < 20 æ˜¯é»„é‡‘æŠ„åº•åŒº**

```python
def check_rsi_oversold(rsi_values, threshold=20):
    """
    æ£€æŸ¥RSIè¶…å–ç¨‹åº¦

    Args:
        rsi_values: {'5m': rsi5, '15m': rsi15, '1h': rsi1h}
        threshold: è¶…å–é˜ˆå€¼

    Returns:
        score (0-100), level, reason
    """
    score = 50  # åŸºç¡€åˆ†
    reasons = []

    # RSI 5åˆ†é’Ÿ
    if rsi_values.get('5m', 50) < 15:
        score += 30
        reasons.append(f"5åˆ†é’ŸRSIæåº¦è¶…å–({rsi_values['5m']:.1f})")
    elif rsi_values.get('5m', 50) < 20:
        score += 20
        reasons.append(f"5åˆ†é’ŸRSIè¶…å–({rsi_values['5m']:.1f})")

    # RSI 15åˆ†é’Ÿ
    if rsi_values.get('15m', 50) < 20:
        score += 15
        reasons.append(f"15åˆ†é’ŸRSIè¶…å–({rsi_values['15m']:.1f})")
    elif rsi_values.get('15m', 50) < 25:
        score += 10
        reasons.append(f"15åˆ†é’ŸRSIåä½({rsi_values['15m']:.1f})")

    # RSI 1å°æ—¶
    if rsi_values.get('1h', 50) < 25:
        score += 15
        reasons.append(f"1å°æ—¶RSIè¶…å–({rsi_values['1h']:.1f})")
    elif rsi_values.get('1h', 50) < 30:
        score += 10
        reasons.append(f"1å°æ—¶RSIåä½({rsi_values['1h']:.1f})")

    # ç¡®å®šç­‰çº§
    if score >= 85:
        level = "EXTREME_OVERSOLD"
    elif score >= 75:
        level = "VERY_OVERSOLD"
    elif score >= 65:
        level = "OVERSOLD"
    else:
        level = "NORMAL"

    return score, level, reasons
```

**æŠ„åº•æ—¶æœºåˆ¤æ–­**:
```python
# æœ€ä½³æŠ„åº•: å¤šå‘¨æœŸRSIåŒæ—¶è¶…å–
if rsi_5m < 20 and rsi_15m < 25 and rsi_1h < 30:
    confidence = 0.90
    action = "ç«‹å³å»ºä»“20%"

# ä¼˜è´¨æŠ„åº•: ä¸¤ä¸ªå‘¨æœŸRSIè¶…å–
elif rsi_5m < 20 and rsi_15m < 30:
    confidence = 0.75
    action = "åˆ†æ‰¹å»ºä»“15%"

# è§‚å¯ŸæŠ„åº•: å•å‘¨æœŸRSIè¶…å–
elif rsi_15m < 20:
    confidence = 0.60
    action = "è¯•æ¢å»ºä»“10%"
```

---

#### ğŸ¯ ä¿¡å·3: æˆäº¤é‡æåº¦æ”¾å¤§ï¼ˆç¡®è®¤ææ…Œï¼‰

**ææ…Œæ€§æŠ›å”® = åº•éƒ¨ä¿¡å·**

```python
def detect_panic_selling(volume, volume_ma20, price_drop):
    """
    æ£€æµ‹ææ…Œæ€§æŠ›å”®

    Returns:
        is_panic, volume_level, confidence
    """
    volume_ratio = volume / volume_ma20

    # å¤©é‡ä¸‹è·Œ = ææ…ŒæŠ›å”®
    if volume_ratio > 5.0 and price_drop < -0.08:
        return True, "EXTREME_VOLUME", 0.95, "å¤©é‡ä¸‹è·Œï¼Œæåº¦ææ…Œ"

    if volume_ratio > 3.0 and price_drop < -0.05:
        return True, "VERY_HIGH_VOLUME", 0.85, "æˆäº¤é‡æš´å¢ï¼Œææ…ŒæŠ›å”®"

    if volume_ratio > 2.0 and price_drop < -0.03:
        return True, "HIGH_VOLUME", 0.70, "æˆäº¤é‡æ”¾å¤§ï¼ŒæŠ›å‹è¾ƒé‡"

    # ç¼©é‡ä¸‹è·Œ = ä¸æ˜¯åº•éƒ¨
    if volume_ratio < 1.0:
        return False, "LOW_VOLUME", 0.30, "ç¼©é‡ä¸‹è·Œï¼Œå¯èƒ½ç»§ç»­è·Œ"

    return False, "NORMAL_VOLUME", 0.50, "æˆäº¤é‡æ­£å¸¸"
```

**ææ…Œå–å‡ºçš„ç‰¹å¾**:
- âœ… æˆäº¤é‡ > 20æ—¥å‡é‡çš„**3-5å€**
- âœ… è·Œå¹… > 5-10%
- âœ… å¤§é‡æ­¢æŸå•è¢«è§¦å‘
- âœ… å¸‚åœºæåº¦ææ…Œ

**æŠ„åº•ç­–ç•¥**:
```python
# å¤©é‡ææ…Œ â†’ ç«‹å³æŠ„åº•
if volume_ratio > 5.0 and price_drop > 0.10:
    buy(position=0.25, leverage=3)  # 25%ä»“ä½ï¼Œ3å€æ æ†
    reason = "å¤©é‡ææ…ŒæŠ›å”®ï¼Œæä½³æŠ„åº•æœºä¼š"
```

---

#### ğŸ¯ ä¿¡å·4: æ”¯æ’‘ä½ç¡®è®¤ï¼ˆä»·æ ¼ä¼ç¨³ï¼‰

**ä¸æŠ„ä¸‹è·Œè¶‹åŠ¿ï¼Œç­‰ä¼ç¨³åæŠ„åº•**

```python
def check_price_stabilization(recent_candles, support_level):
    """
    æ£€æŸ¥ä»·æ ¼æ˜¯å¦ä¼ç¨³

    Args:
        recent_candles: æœ€è¿‘10-20æ ¹Kçº¿
        support_level: å…³é”®æ”¯æ’‘ä½

    Returns:
        is_stabilized, confidence, entry_price
    """
    # 1. æ£€æŸ¥æ˜¯å¦è§¦åŠæ”¯æ’‘ä½
    lowest_price = min([c['low'] for c in recent_candles])
    support_distance = abs(lowest_price - support_level) / support_level

    if support_distance > 0.03:  # è·ç¦»æ”¯æ’‘ä½ > 3%
        return False, 0.3, None, "æœªè§¦åŠæ”¯æ’‘ä½"

    # 2. æ£€æŸ¥æ˜¯å¦å‡ºç°æ­¢è·Œä¿¡å·
    last_5_candles = recent_candles[-5:]

    # ä¿¡å·A: å‡ºç°ä¸‹å½±çº¿ï¼ˆä¹°ç›˜æ‰¿æ¥ï¼‰
    long_lower_shadows = 0
    for candle in last_5_candles:
        body_size = abs(candle['close'] - candle['open'])
        lower_shadow = min(candle['close'], candle['open']) - candle['low']

        if lower_shadow > body_size * 2:  # ä¸‹å½±çº¿ > 2å€å®ä½“
            long_lower_shadows += 1

    if long_lower_shadows >= 2:
        return True, 0.80, support_level * 1.01, "å‡ºç°é•¿ä¸‹å½±çº¿ï¼Œä¹°ç›˜æ‰¿æ¥"

    # ä¿¡å·B: å‡ºç°åå­—æ˜Ÿæˆ–é”¤å­çº¿
    last_candle = recent_candles[-1]
    body_size = abs(last_candle['close'] - last_candle['open'])
    total_range = last_candle['high'] - last_candle['low']

    if body_size < total_range * 0.3:  # å®ä½“ < 30%
        return True, 0.75, last_candle['close'], "å‡ºç°åå­—æ˜Ÿï¼ŒçŠ¹è±«ä¿¡å·"

    # ä¿¡å·C: è¿ç»­2-3æ ¹Kçº¿ä¸åˆ›æ–°ä½
    lows = [c['low'] for c in last_5_candles]
    if lows[-1] > lows[-2] and lows[-2] > lows[-3]:
        return True, 0.70, last_candle['close'], "è¿ç»­ä¸åˆ›æ–°ä½ï¼Œæ­¢è·Œä¼ç¨³"

    # ä¿¡å·D: å‡ºç°åå¼¹Kçº¿ï¼ˆé˜³çº¿ï¼‰
    if last_candle['close'] > last_candle['open']:
        rebound_size = (last_candle['close'] - last_candle['open']) / last_candle['open']
        if rebound_size > 0.02:  # åå¼¹ > 2%
            return True, 0.85, last_candle['close'], f"å‡ºç°åå¼¹é˜³çº¿(+{rebound_size*100:.1f}%)"

    return False, 0.40, None, "å°šæœªä¼ç¨³ï¼Œç»§ç»­è§‚å¯Ÿ"
```

**Kçº¿æ­¢è·Œå½¢æ€**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº•éƒ¨åè½¬Kçº¿å½¢æ€                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ 1. é”¤å­çº¿ï¼ˆHammerï¼‰                  â”‚
â”‚    â”‚                                 â”‚
â”‚    â”‚   â”€â”  â† å°å®ä½“                  â”‚
â”‚    â”‚    â”‚                            â”‚
â”‚    â”‚    â”‚                            â”‚
â”‚    â””â”€â”€â”€â”€â”˜  â† é•¿ä¸‹å½±çº¿ï¼ˆ2å€å®ä½“ï¼‰     â”‚
â”‚                                      â”‚
â”‚ 2. æ—©æ™¨ä¹‹æ˜Ÿï¼ˆMorning Starï¼‰          â”‚
â”‚    â”€â”                                â”‚
â”‚     â”‚  X  â”€â”  â† ä¸‰æ ¹Kçº¿ç»„åˆ          â”‚
â”‚    â”€â”˜     â””â”€                         â”‚
â”‚                                      â”‚
â”‚ 3. çœ‹æ¶¨åæ²¡ï¼ˆBullish Engulfingï¼‰     â”‚
â”‚    â”€â”                                â”‚
â”‚     â”‚  â”Œâ”€â”€â”€â”  â† å¤§é˜³çº¿åæ²¡å°é˜´çº¿     â”‚
â”‚    â”€â”˜  â””â”€â”€â”€â”˜                         â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼ç¨³åˆ¤æ–­æ ‡å‡†**:
1. âœ… è§¦åŠå…³é”®æ”¯æ’‘ä½ï¼ˆå‰ä½ç‚¹ã€æ•´æ•°å…³å£ã€EMAå‡çº¿ï¼‰
2. âœ… å‡ºç°é•¿ä¸‹å½±çº¿æˆ–åå¼¹é˜³çº¿
3. âœ… è¿ç»­2-3æ ¹Kçº¿ä¸åˆ›æ–°ä½
4. âœ… RSIä»ä½ä½å›å‡

---

#### ğŸ¯ ä¿¡å·5: èµ„é‡‘è´¹ç‡æåº¦è´Ÿå€¼ï¼ˆç©ºå¤´è¿‡åº¦ï¼‰

**èµ„é‡‘è´¹ç‡ < -0.05% = ç©ºå¤´è¿‡åº¦æ‹¥æŒ¤**

```python
def check_funding_rate_extreme(funding_rate, funding_history):
    """
    æ£€æŸ¥èµ„é‡‘è´¹ç‡æ˜¯å¦æç«¯

    Returns:
        is_extreme_short, score, reason
    """
    score = 50
    reasons = []

    # å½“å‰èµ„é‡‘è´¹ç‡
    if funding_rate < -0.001:  # < -0.1%
        score += 30
        reasons.append(f"èµ„é‡‘è´¹ç‡æåº¦è´Ÿå€¼({funding_rate*100:.3f}%)")
    elif funding_rate < -0.0005:  # < -0.05%
        score += 20
        reasons.append(f"èµ„é‡‘è´¹ç‡è´Ÿå€¼({funding_rate*100:.3f}%)")

    # èµ„é‡‘è´¹ç‡è¶‹åŠ¿
    if len(funding_history) >= 3:
        if all(f < -0.0003 for f in funding_history[-3:]):
            score += 15
            reasons.append("è¿ç»­3æœŸè´Ÿè´¹ç‡ï¼Œç©ºå¤´è¿‡åº¦")

    # èµ„é‡‘è´¹ç‡æ€¥å‰§è½¬è´Ÿ
    if len(funding_history) >= 2:
        rate_change = funding_rate - funding_history[-2]
        if rate_change < -0.0005:
            score += 10
            reasons.append("èµ„é‡‘è´¹ç‡æ€¥å‰§è½¬è´Ÿ")

    is_extreme = score >= 75

    return is_extreme, score, reasons
```

**èµ„é‡‘è´¹ç‡æŠ„åº•ç­–ç•¥**:
```python
# æåº¦è´Ÿè´¹ç‡ = ç©ºå¤´å³å°†è¢«è½§
if funding_rate < -0.001:  # < -0.1%
    if rsi < 30:  # RSIä¹Ÿè¶…å–
        action = "åšå¤šç°è´§ + å¼€å¤šåˆçº¦"
        position = 0.30
        confidence = 0.90
        reason = "èµ„é‡‘è´¹ç‡æåº¦è´Ÿå€¼ï¼Œç©ºå¤´å³å°†è¢«è½§ç©º"
```

---

### 1.3 ç»¼åˆæŠ„åº•ä¿¡å·è¯„åˆ†ç³»ç»Ÿ

```python
def calculate_bottom_fishing_score(
    price_drop,        # è·Œå¹…
    rsi_values,        # RSIå€¼
    volume_ratio,      # æˆäº¤é‡å€æ•°
    is_stabilized,     # æ˜¯å¦ä¼ç¨³
    funding_rate,      # èµ„é‡‘è´¹ç‡
    smart_money_flow   # èªæ˜é’±æµå‘
):
    """
    è®¡ç®—æŠ„åº•ä¿¡å·ç»¼åˆè¯„åˆ†

    Returns:
        total_score (0-100), confidence, action
    """
    score = 0
    details = []

    # 1. è·Œå¹…è¯„åˆ† (æƒé‡30%)
    if price_drop < -0.15:  # è·Œè¶…15%
        score += 30
        details.append(f"è·Œå¹…{price_drop*100:.1f}% - æåº¦è¶…è·Œ")
    elif price_drop < -0.10:
        score += 20
        details.append(f"è·Œå¹…{price_drop*100:.1f}% - è¶…è·Œ")
    elif price_drop < -0.05:
        score += 10
        details.append(f"è·Œå¹…{price_drop*100:.1f}% - åä½")

    # 2. RSIè¯„åˆ† (æƒé‡25%)
    rsi_score, rsi_level, rsi_reasons = check_rsi_oversold(rsi_values)
    score += (rsi_score - 50) * 0.5  # å½’ä¸€åŒ–åˆ°25åˆ†
    details.extend(rsi_reasons)

    # 3. æˆäº¤é‡è¯„åˆ† (æƒé‡20%)
    if volume_ratio > 4.0:
        score += 20
        details.append(f"æˆäº¤é‡{volume_ratio:.1f}å€ - ææ…ŒæŠ›å”®")
    elif volume_ratio > 2.5:
        score += 15
        details.append(f"æˆäº¤é‡{volume_ratio:.1f}å€ - æ”¾é‡ä¸‹è·Œ")
    elif volume_ratio > 1.5:
        score += 10
        details.append(f"æˆäº¤é‡{volume_ratio:.1f}å€ - é€‚åº¦æ”¾é‡")

    # 4. ä¼ç¨³è¯„åˆ† (æƒé‡15%)
    if is_stabilized:
        score += 15
        details.append("ä»·æ ¼å·²ä¼ç¨³")
    else:
        score += 0
        details.append("âš ï¸ ä»·æ ¼å°šæœªä¼ç¨³")

    # 5. èµ„é‡‘è´¹ç‡è¯„åˆ† (æƒé‡10%)
    if funding_rate < -0.001:
        score += 10
        details.append(f"èµ„é‡‘è´¹ç‡{funding_rate*100:.3f}% - ç©ºå¤´è¿‡åº¦")
    elif funding_rate < -0.0005:
        score += 5
        details.append(f"èµ„é‡‘è´¹ç‡{funding_rate*100:.3f}% - åè´Ÿ")

    # 6. èªæ˜é’±è¯„åˆ† (å¥–åŠ±é¡¹ï¼Œæœ€å¤š+10åˆ†)
    if smart_money_flow > 100000:  # æµå…¥ > $100K
        score += 10
        details.append(f"èªæ˜é’±æµå…¥${smart_money_flow/1000:.0f}K")

    # é™åˆ¶åœ¨0-100
    score = max(0, min(100, score))

    # ç¡®å®šæ“ä½œå»ºè®®
    if score >= 85:
        confidence = 0.90
        action = "ç«‹å³å»ºä»“30%"
        level = "ğŸ”´ æä½³æŠ„åº•æœºä¼š"
    elif score >= 75:
        confidence = 0.80
        action = "åˆ†æ‰¹å»ºä»“20%"
        level = "ğŸŸ  ä¼˜è´¨æŠ„åº•æœºä¼š"
    elif score >= 65:
        confidence = 0.70
        action = "è¯•æ¢å»ºä»“10%"
        level = "ğŸŸ¡ è‰¯å¥½æŠ„åº•æœºä¼š"
    elif score >= 55:
        confidence = 0.60
        action = "è§‚å¯Ÿï¼Œç­‰å¾…ä¼ç¨³"
        level = "ğŸŸ¢ æ½œåœ¨æŠ„åº•æœºä¼š"
    else:
        confidence = 0.40
        action = "ä¸å»ºè®®æŠ„åº•"
        level = "âšª æ¡ä»¶ä¸è¶³"

    return {
        'score': round(score, 1),
        'confidence': confidence,
        'action': action,
        'level': level,
        'details': details
    }
```

---

### 1.4 æŠ„åº•å®æˆ˜ç­–ç•¥

#### ç­–ç•¥A: åˆ†æ‰¹æŠ„åº•ï¼ˆæ¨èï¼‰

**ä¸è¦ä¸€æŠŠæ¢­ï¼Œåˆ†3-4æ‰¹å»ºä»“**

```python
def pyramid_bottom_fishing(entry_score, current_price, capital):
    """
    é‡‘å­—å¡”å¼åˆ†æ‰¹æŠ„åº•

    Returns:
        positions: [(price, size, reason), ...]
    """
    positions = []

    # ç¬¬ä¸€æ‰¹: åˆå§‹ä¿¡å·å‡ºç°
    if entry_score >= 65:
        batch_1_size = capital * 0.10  # 10%
        positions.append({
            'price': current_price,
            'size': batch_1_size,
            'percentage': 0.10,
            'reason': "åˆå§‹ä¿¡å·ï¼Œè¯•æ¢æ€§å»ºä»“"
        })

    # ç¬¬äºŒæ‰¹: ä»·æ ¼ç»§ç»­ä¸‹è·Œ3-5%
    if entry_score >= 70:
        batch_2_price = current_price * 0.97  # å›è°ƒ3%
        batch_2_size = capital * 0.15  # 15%
        positions.append({
            'price': batch_2_price,
            'size': batch_2_size,
            'percentage': 0.15,
            'reason': "å›è°ƒåŠ ä»“"
        })

    # ç¬¬ä¸‰æ‰¹: å‡ºç°æ˜æ˜¾ä¼ç¨³ä¿¡å·
    if entry_score >= 75:
        batch_3_price = current_price * 0.95  # å›è°ƒ5%
        batch_3_size = capital * 0.10  # 10%
        positions.append({
            'price': batch_3_price,
            'size': batch_3_size,
            'percentage': 0.10,
            'reason': "ä¼ç¨³åŠ ä»“"
        })

    # ç¬¬å››æ‰¹ï¼ˆå¯é€‰ï¼‰: ç¡®è®¤åå¼¹å¼€å§‹
    if entry_score >= 80:
        batch_4_price = current_price * 1.02  # åå¼¹2%
        batch_4_size = capital * 0.05  # 5%
        positions.append({
            'price': batch_4_price,
            'size': batch_4_size,
            'percentage': 0.05,
            'reason': "ç¡®è®¤åå¼¹ï¼Œæœ€ååŠ ä»“"
        })

    total_percentage = sum(p['percentage'] for p in positions)

    return {
        'positions': positions,
        'total_percentage': total_percentage,
        'average_price': sum(p['price'] * p['percentage'] for p in positions) / total_percentage if total_percentage > 0 else 0
    }
```

**ç¤ºä¾‹**:
```
BTC ä» $100,000 æš´è·Œè‡³ $85,000 (-15%)
ç»¼åˆæŠ„åº•è¯„åˆ†: 78åˆ†

åˆ†æ‰¹å»ºä»“è®¡åˆ’:
â”œâ”€ ç¬¬1æ‰¹: $85,000 â†’ 10%ä»“ä½ (è¯•æ¢)
â”œâ”€ ç¬¬2æ‰¹: $82,450 â†’ 15%ä»“ä½ (å›è°ƒ-3%)
â”œâ”€ ç¬¬3æ‰¹: $80,750 â†’ 10%ä»“ä½ (å›è°ƒ-5%)
â””â”€ ç¬¬4æ‰¹: $86,700 â†’ 5%ä»“ä½  (åå¼¹+2%)

æ€»ä»“ä½: 40%
å¹³å‡æˆæœ¬: $83,287
```

---

#### ç­–ç•¥B: é—ªå´©æé€ŸæŠ„åº•

**5-15åˆ†é’Ÿå†…å®Œæˆï¼Œå¿«è¿›å¿«å‡º**

```python
def flash_crash_bottom_fishing(
    price_drop_5m,     # 5åˆ†é’Ÿè·Œå¹…
    volume_ratio,      # æˆäº¤é‡å€æ•°
    current_price
):
    """
    é—ªå´©æŠ„åº•ç­–ç•¥

    é€‚ç”¨åœºæ™¯: 5-15åˆ†é’Ÿå†…æš´è·Œ8-15%
    """
    if price_drop_5m < -0.08 and volume_ratio > 4.0:
        # é—ªå´©ç¡®è®¤
        return {
            'action': 'BUY_IMMEDIATELY',
            'position': 0.25,          # 25%ä»“ä½
            'leverage': 3,             # 3å€æ æ†
            'entry': current_price,
            'stop_loss': current_price * 0.95,    # æ­¢æŸ-5%
            'take_profit_1': current_price * 1.05, # æ­¢ç›ˆ+5%
            'take_profit_2': current_price * 1.08, # æ­¢ç›ˆ+8%
            'time_limit': '30åˆ†é’Ÿ',    # 30åˆ†é’Ÿå†…å¹³ä»“
            'reason': 'é—ªå´©æŠ„åº•ï¼Œå¿«è¿›å¿«å‡º'
        }

    return None
```

**é—ªå´©æŠ„åº•è¦ç‚¹**:
1. âœ… **é€Ÿåº¦**: 5åˆ†é’Ÿå†…å†³ç­–å¹¶æ‰§è¡Œ
2. âœ… **ä»“ä½**: ä¸è¶…è¿‡30%
3. âœ… **æ æ†**: 3-5å€æ”¾å¤§æ”¶ç›Š
4. âœ… **æ­¢æŸ**: -5%ä¸¥æ ¼æ­¢æŸ
5. âœ… **æ­¢ç›ˆ**: +5-8%å¿«é€Ÿæ­¢ç›ˆ
6. âœ… **æ—¶é™**: 30åˆ†é’Ÿ-2å°æ—¶å†…å¹³ä»“

**é£é™©æé†’**:
- âš ï¸ é—ªå´©å¯èƒ½ç»§ç»­è·Œ
- âš ï¸ è¦å¿«é€Ÿæ­¢æŸ
- âš ï¸ ä¸è¦è´ªå¿ƒ

---

#### ç­–ç•¥C: æ”¯æ’‘ä½åŸ‹ä¼æŠ„åº•

**æå‰æŒ‚å•ï¼Œç­‰å¾…è§¦åŠ**

```python
def support_level_ambush(
    current_price,
    support_levels,    # å…³é”®æ”¯æ’‘ä½
    capital
):
    """
    æ”¯æ’‘ä½åŸ‹ä¼æŠ„åº•

    æå‰åœ¨æ”¯æ’‘ä½æŒ‚é™ä»·å•
    """
    orders = []

    for i, support in enumerate(support_levels):
        # è®¡ç®—è·ç¦»
        distance = (current_price - support) / current_price

        if 0.03 < distance < 0.15:  # è·ç¦»3-15%
            # ä»“ä½åˆ†é…: è¶Šè¿‘çš„æ”¯æ’‘ä½ä»“ä½è¶Šå°
            position_pct = 0.05 + (i * 0.03)

            orders.append({
                'type': 'LIMIT_BUY',
                'price': support * 1.001,  # æ”¯æ’‘ä½ä¸Šæ–¹0.1%
                'size': capital * position_pct,
                'percentage': position_pct,
                'stop_loss': support * 0.97,  # ç ´ä½æ­¢æŸ-3%
                'reason': f"ç¬¬{i+1}æ”¯æ’‘ä½åŸ‹ä¼"
            })

    return orders
```

**ç¤ºä¾‹**:
```
BTC å½“å‰ä»·: $95,000
å…³é”®æ”¯æ’‘ä½:
â”œâ”€ S1: $92,000 (å‰ä½ç‚¹)
â”œâ”€ S2: $90,000 (æ•´æ•°å…³å£)
â””â”€ S3: $87,500 (EMA200)

åŸ‹ä¼æŒ‚å•:
â”œâ”€ $92,092: 5%ä»“ä½
â”œâ”€ $90,090: 8%ä»“ä½
â””â”€ $87,588: 11%ä»“ä½
```

---

### 1.5 æŠ„åº•åçš„ç®¡ç†

#### æ­¢æŸè®¾ç½®

```python
def set_stop_loss_for_bottom_fishing(entry_price, support_level):
    """
    æŠ„åº•æ­¢æŸè®¾ç½®
    """
    # æ–¹æ³•1: å›ºå®šç™¾åˆ†æ¯”æ­¢æŸ
    fixed_stop = entry_price * 0.95  # -5%

    # æ–¹æ³•2: æ”¯æ’‘ä½ç ´ä½æ­¢æŸ
    support_stop = support_level * 0.97  # æ”¯æ’‘ä½ä¸‹æ–¹3%

    # å–ä¸¤è€…è¾ƒä½å€¼ï¼ˆæ›´å®‰å…¨ï¼‰
    stop_loss = min(fixed_stop, support_stop)

    return stop_loss
```

#### æ­¢ç›ˆç­–ç•¥

```python
def set_take_profit_for_bottom_fishing(entry_price, rebound_target):
    """
    æŠ„åº•æ­¢ç›ˆç­–ç•¥ - å¿«é€Ÿæ­¢ç›ˆ
    """
    # æŠ„åº•è¿½æ±‚å¿«é€Ÿåå¼¹ï¼Œä¸è¦è´ªå¿ƒ
    return {
        'target_1': {
            'price': entry_price * 1.05,   # +5%
            'size': 0.40,                   # æ­¢ç›ˆ40%
            'reason': 'å¿«é€Ÿåå¼¹ï¼Œå…ˆä¿æœ¬'
        },
        'target_2': {
            'price': entry_price * 1.08,   # +8%
            'size': 0.40,                   # æ­¢ç›ˆ40%
            'reason': 'ç»§ç»­åå¼¹ï¼Œé”å®šåˆ©æ¶¦'
        },
        'target_3': {
            'price': entry_price * 1.12,   # +12%
            'size': 0.20,                   # æ­¢ç›ˆ20%
            'reason': 'å¼ºåŠ¿åå¼¹ï¼Œè¿½æ±‚æé™'
        }
    }
```

**æŠ„åº•æ­¢ç›ˆåŸåˆ™**:
- âœ… æ­¢ç›ˆè¦å¿«ï¼Œä¸è¦è´ªå¿ƒ
- âœ… åˆ†æ‰¹æ­¢ç›ˆï¼Œä¿æŠ¤åˆ©æ¶¦
- âœ… åå¼¹5-8%å°±å¯ä»¥æ­¢ç›ˆ50%
- âœ… ä¸è¦ç­‰å¾…å¤§åå¼¹ï¼ˆå¯èƒ½ç­‰ä¸åˆ°ï¼‰

---

## 2. å¤§æ¶¨è¡Œæƒ…é€ƒé¡¶ç¯‡

### 2.1 é€ƒé¡¶çš„æœ¬è´¨

**é€ƒé¡¶æ˜¯å–åœ¨ç›¸å¯¹é«˜ä½ï¼Œä¸æ˜¯è¿½æ±‚ç»å¯¹é¡¶éƒ¨**

```
é”™è¯¯çš„é€ƒé¡¶ âŒ
â”œâ”€ ç­‰å¾…ç»å¯¹é¡¶éƒ¨
â”œâ”€ ä¸€æ¬¡æ€§æ¸…ä»“
â””â”€ è´ªå¿ƒä¸æ­¢ç›ˆ

æ­£ç¡®çš„é€ƒé¡¶ âœ…
â”œâ”€ å¤šé‡ä¿¡å·ç¡®è®¤
â”œâ”€ åˆ†æ‰¹å‡ä»“
â”œâ”€ åŠæ—¶æ­¢ç›ˆ
â””â”€ é€‚æ—¶åšç©º
```

---

### 2.2 é€ƒé¡¶çš„å…­å¤§æ ¸å¿ƒä¿¡å·

#### ğŸ¯ ä¿¡å·1: RSIæåº¦è¶…ä¹°ï¼ˆæ ¸å¿ƒæŒ‡æ ‡ï¼‰

**RSI > 80 = é¡¶éƒ¨è­¦å‘ŠåŒº**

```python
def check_rsi_overbought(rsi_values):
    """
    æ£€æŸ¥RSIè¶…ä¹°ç¨‹åº¦

    Returns:
        score, level, reasons
    """
    score = 50
    reasons = []

    # RSI 5åˆ†é’Ÿ
    if rsi_values.get('5m', 50) > 85:
        score += 30
        reasons.append(f"5åˆ†é’ŸRSIæåº¦è¶…ä¹°({rsi_values['5m']:.1f})")
    elif rsi_values.get('5m', 50) > 80:
        score += 20
        reasons.append(f"5åˆ†é’ŸRSIè¶…ä¹°({rsi_values['5m']:.1f})")

    # RSI 15åˆ†é’Ÿ
    if rsi_values.get('15m', 50) > 80:
        score += 15
        reasons.append(f"15åˆ†é’ŸRSIè¶…ä¹°({rsi_values['15m']:.1f})")
    elif rsi_values.get('15m', 50) > 75:
        score += 10
        reasons.append(f"15åˆ†é’ŸRSIåé«˜({rsi_values['15m']:.1f})")

    # RSI 1å°æ—¶
    if rsi_values.get('1h', 50) > 75:
        score += 15
        reasons.append(f"1å°æ—¶RSIè¶…ä¹°({rsi_values['1h']:.1f})")
    elif rsi_values.get('1h', 50) > 70:
        score += 10
        reasons.append(f"1å°æ—¶RSIåé«˜({rsi_values['1h']:.1f})")

    # RSI 4å°æ—¶
    if rsi_values.get('4h', 50) > 70:
        score += 10
        reasons.append(f"4å°æ—¶RSIè¶…ä¹°({rsi_values['4h']:.1f})")

    # ç¡®å®šç­‰çº§
    if score >= 85:
        level = "EXTREME_OVERBOUGHT"  # æåº¦è¶…ä¹°
    elif score >= 75:
        level = "VERY_OVERBOUGHT"      # éå¸¸è¶…ä¹°
    elif score >= 65:
        level = "OVERBOUGHT"           # è¶…ä¹°
    else:
        level = "NORMAL"

    return score, level, reasons
```

**é€ƒé¡¶æ—¶æœº**:
```python
# æœ€ä½³é€ƒé¡¶: å¤šå‘¨æœŸRSIåŒæ—¶è¶…ä¹°
if rsi_5m > 85 and rsi_15m > 80 and rsi_1h > 75:
    confidence = 0.95
    action = "ç«‹å³å‡ä»“50%æˆ–åšç©º"

# ä¼˜è´¨é€ƒé¡¶: ä¸¤ä¸ªå‘¨æœŸRSIè¶…ä¹°
elif rsi_15m > 80 and rsi_1h > 75:
    confidence = 0.85
    action = "åˆ†æ‰¹å‡ä»“30%"

# è­¦æƒ•é€ƒé¡¶: å•å‘¨æœŸRSIè¶…ä¹°
elif rsi_1h > 80:
    confidence = 0.70
    action = "å‡ä»“20%ï¼Œåšå¥½å‡†å¤‡"
```

---

#### ğŸ¯ ä¿¡å·2: é¡¶èƒŒç¦»ï¼ˆæœ€å¼ºå–å‡ºä¿¡å·ï¼‰

**ä»·æ ¼åˆ›æ–°é«˜ï¼ŒæŒ‡æ ‡ä¸åˆ›æ–°é«˜ = é¡¶éƒ¨**

```python
def detect_bearish_divergence(prices, indicators, window=20):
    """
    æ£€æµ‹é¡¶èƒŒç¦»

    Args:
        prices: ä»·æ ¼åºåˆ—
        indicators: æŒ‡æ ‡åºåˆ— (RSI/MACDç­‰)
        window: æ£€æµ‹çª—å£

    Returns:
        has_divergence, divergence_type, confidence
    """
    recent_prices = prices[-window:]
    recent_indicators = indicators[-window:]

    # æ‰¾åˆ°ä»·æ ¼é«˜ç‚¹
    price_peaks = []
    for i in range(1, len(recent_prices) - 1):
        if recent_prices[i] > recent_prices[i-1] and recent_prices[i] > recent_prices[i+1]:
            price_peaks.append((i, recent_prices[i]))

    if len(price_peaks) < 2:
        return False, None, 0

    # å¯¹æ¯”æœ€è¿‘ä¸¤ä¸ªé«˜ç‚¹
    peak1_idx, peak1_price = price_peaks[-2]
    peak2_idx, peak2_price = price_peaks[-1]

    peak1_indicator = recent_indicators[peak1_idx]
    peak2_indicator = recent_indicators[peak2_idx]

    # é¡¶èƒŒç¦»: ä»·æ ¼æ–°é«˜ï¼ŒæŒ‡æ ‡ä¸åˆ›æ–°é«˜
    if peak2_price > peak1_price and peak2_indicator < peak1_indicator:
        # è®¡ç®—èƒŒç¦»å¼ºåº¦
        price_increase = (peak2_price - peak1_price) / peak1_price
        indicator_decrease = (peak1_indicator - peak2_indicator) / peak1_indicator

        divergence_strength = indicator_decrease / price_increase

        if divergence_strength > 1.0:
            return True, "STRONG_DIVERGENCE", 0.90
        elif divergence_strength > 0.5:
            return True, "MODERATE_DIVERGENCE", 0.75
        else:
            return True, "WEAK_DIVERGENCE", 0.60

    return False, None, 0
```

**é¡¶èƒŒç¦»ç±»å‹**:

```
ç±»å‹1: RSIé¡¶èƒŒç¦»
ä»·æ ¼: $90K â†’ $95K â†’ $100K (åˆ›æ–°é«˜)
RSI:   65  â†’  70  â†’   68   (ä¸åˆ›æ–°é«˜) âš ï¸

ç±»å‹2: MACDé¡¶èƒŒç¦»
ä»·æ ¼: $90K â†’ $95K â†’ $100K (åˆ›æ–°é«˜)
MACD:  50  â†’  80  â†’   70   (ä¸åˆ›æ–°é«˜) âš ï¸

ç±»å‹3: æˆäº¤é‡é¡¶èƒŒç¦»
ä»·æ ¼: $90K â†’ $95K â†’ $100K (åˆ›æ–°é«˜)
æˆäº¤é‡: 10B â†’  8B â†’   6B   (èç¼©) âš ï¸
```

**æ“ä½œå»ºè®®**:
```python
if has_strong_divergence:
    # å¼ºèƒŒç¦» â†’ ç«‹å³å‡ä»“æˆ–åšç©º
    action = "ç«‹å³å‡ä»“50%æˆ–å¼€ç©º"
    confidence = 0.90

elif has_moderate_divergence:
    # ä¸­åº¦èƒŒç¦» â†’ åˆ†æ‰¹å‡ä»“
    action = "åˆ†æ‰¹å‡ä»“30%"
    confidence = 0.75
```

---

#### ğŸ¯ ä¿¡å·3: æˆäº¤é‡èç¼©ï¼ˆä¸Šæ¶¨ä¹åŠ›ï¼‰

**ä»·æ ¼æ–°é«˜ä½†æˆäº¤é‡èç¼© = å¤šå¤´åŠ›é‡è¡°ç«­**

```python
def detect_volume_divergence(prices, volumes, volume_ma20, window=10):
    """
    æ£€æµ‹æˆäº¤é‡èƒŒç¦»

    Returns:
        has_divergence, confidence, reason
    """
    recent_prices = prices[-window:]
    recent_volumes = volumes[-window:]

    # ä»·æ ¼è¶‹åŠ¿
    price_change = (recent_prices[-1] - recent_prices[0]) / recent_prices[0]

    # æˆäº¤é‡è¶‹åŠ¿
    volume_change = (recent_volumes[-1] - recent_volumes[0]) / recent_volumes[0]

    # æˆäº¤é‡ä¸å‡é‡å¯¹æ¯”
    current_volume_ratio = recent_volumes[-1] / volume_ma20

    # æƒ…å†µ1: ä»·æ ¼ä¸Šæ¶¨ä½†æˆäº¤é‡ä¸‹é™
    if price_change > 0.05 and volume_change < -0.20:
        return True, 0.85, f"ä»·æ ¼æ¶¨{price_change*100:.1f}%ä½†æˆäº¤é‡é™{abs(volume_change)*100:.0f}%"

    # æƒ…å†µ2: ä»·æ ¼æ–°é«˜ä½†æˆäº¤é‡ä½äºå‡é‡
    if price_change > 0.08 and current_volume_ratio < 0.8:
        return True, 0.80, f"ä»·æ ¼åˆ›æ–°é«˜ä½†æˆäº¤é‡ä»…{current_volume_ratio:.1f}å€å‡é‡"

    # æƒ…å†µ3: è¿ç»­ç¼©é‡ä¸Šæ¶¨
    if all(v < volume_ma20 for v in recent_volumes[-5:]) and price_change > 0:
        return True, 0.75, "è¿ç»­5æ ¹Kçº¿ç¼©é‡ä¸Šæ¶¨"

    return False, 0.40, "æˆäº¤é‡æ­£å¸¸"
```

---

#### ğŸ¯ ä¿¡å·4: èµ„é‡‘è´¹ç‡æåº¦æ­£å€¼ï¼ˆå¤šå¤´è¿‡çƒ­ï¼‰

**èµ„é‡‘è´¹ç‡ > 0.1% = å¤šå¤´ç–¯ç‹‚ï¼Œå³å°†å›è°ƒ**

```python
def check_funding_rate_extreme_positive(funding_rate, funding_history):
    """
    æ£€æŸ¥èµ„é‡‘è´¹ç‡æ˜¯å¦æç«¯æ­£å€¼
    """
    score = 50
    reasons = []

    # å½“å‰èµ„é‡‘è´¹ç‡
    if funding_rate > 0.001:  # > 0.1%
        score += 35
        reasons.append(f"èµ„é‡‘è´¹ç‡æé«˜({funding_rate*100:.3f}%) - å¤šå¤´ç–¯ç‹‚")
    elif funding_rate > 0.0005:  # > 0.05%
        score += 25
        reasons.append(f"èµ„é‡‘è´¹ç‡åé«˜({funding_rate*100:.3f}%) - å¤šå¤´è¿‡çƒ­")
    elif funding_rate > 0.0003:  # > 0.03%
        score += 15
        reasons.append(f"èµ„é‡‘è´¹ç‡æ­£å€¼({funding_rate*100:.3f}%)")

    # è¿ç»­å¤šæœŸæ­£è´¹ç‡
    if len(funding_history) >= 3:
        if all(f > 0.0003 for f in funding_history[-3:]):
            score += 15
            reasons.append("è¿ç»­3æœŸæ­£è´¹ç‡ - å¤šå¤´æŒç»­æ‹¥æŒ¤")

    # èµ„é‡‘è´¹ç‡æ€¥å‰§ä¸Šå‡
    if len(funding_history) >= 2:
        rate_change = funding_rate - funding_history[-2]
        if rate_change > 0.0003:
            score += 10
            reasons.append("èµ„é‡‘è´¹ç‡æ€¥å‰§ä¸Šå‡")

    is_extreme = score >= 80

    return is_extreme, score, reasons
```

**åšç©ºæ—¶æœº**:
```python
# èµ„é‡‘è´¹ç‡æé«˜ + RSIè¶…ä¹° = é»„é‡‘åšç©ºæœºä¼š
if funding_rate > 0.001 and rsi > 75:
    action = "åšç©ºåˆçº¦"
    position = 0.30
    leverage = 5
    confidence = 0.90
    reason = "å¤šå¤´è¿‡åº¦æ‹¥æŒ¤ï¼Œå³å°†è¢«æ‰“çˆ†"
```

---

#### ğŸ¯ ä¿¡å·5: èªæ˜é’±å¤§é¢æµå‡º

**èªæ˜é’±æå‰æ’¤é€€ = é¡¶éƒ¨ä¿¡å·**

```python
def detect_smart_money_outflow(
    hyperliquid_net_flow,
    ethereum_net_flow,
    etf_net_outflow,
    price_trend
):
    """
    æ£€æµ‹èªæ˜é’±æµå‡º
    """
    score = 50
    reasons = []

    # Hyperliquidæµå‡º
    if hyperliquid_net_flow < -200000:  # æµå‡º > $200K
        score += 25
        reasons.append(f"Hyperliquidå‡€æµå‡º${abs(hyperliquid_net_flow)/1000:.0f}K")
    elif hyperliquid_net_flow < -100000:
        score += 15
        reasons.append(f"Hyperliquidå‡€æµå‡º${abs(hyperliquid_net_flow)/1000:.0f}K")

    # ä»¥å¤ªåŠé“¾ä¸Šæµå‡º
    if ethereum_net_flow < -500000:
        score += 20
        reasons.append(f"é“¾ä¸Šå‡€æµå‡º${abs(ethereum_net_flow)/1000:.0f}K")
    elif ethereum_net_flow < -200000:
        score += 10
        reasons.append(f"é“¾ä¸Šå‡€æµå‡º${abs(ethereum_net_flow)/1000:.0f}K")

    # ETFæµå‡º
    if etf_net_outflow < -100000000:  # æµå‡º > $100M
        score += 15
        reasons.append(f"ETFå‡€æµå‡º${abs(etf_net_outflow)/1e6:.0f}M")

    # ä»·æ ¼èƒŒç¦»: ä»·æ ¼ä¸Šæ¶¨ä½†èµ„é‡‘æµå‡º
    if price_trend > 0.05 and (hyperliquid_net_flow < -50000 or ethereum_net_flow < -100000):
        score += 10
        reasons.append("âš ï¸ ä»·æ ¼ä¸Šæ¶¨ä½†èªæ˜é’±æµå‡º - å±é™©ä¿¡å·")

    is_outflow = score >= 70

    return is_outflow, score, reasons
```

---

#### ğŸ¯ ä¿¡å·6: Kçº¿é¡¶éƒ¨å½¢æ€

**è¯†åˆ«é¡¶éƒ¨åè½¬Kçº¿å½¢æ€**

```python
def detect_top_reversal_patterns(recent_candles):
    """
    æ£€æµ‹é¡¶éƒ¨åè½¬å½¢æ€

    Returns:
        pattern_type, confidence, action
    """
    if len(recent_candles) < 5:
        return None, 0, None

    last_3 = recent_candles[-3:]

    # å½¢æ€1: é»„æ˜ä¹‹æ˜Ÿ (Evening Star)
    if is_evening_star(last_3):
        return "EVENING_STAR", 0.85, "é»„æ˜ä¹‹æ˜Ÿå½¢æˆï¼Œå¼ºçƒˆå–å‡ºä¿¡å·"

    # å½¢æ€2: å°„å‡»ä¹‹æ˜Ÿ (Shooting Star)
    if is_shooting_star(recent_candles[-1]):
        return "SHOOTING_STAR", 0.75, "å°„å‡»ä¹‹æ˜Ÿï¼Œé¡¶éƒ¨è­¦å‘Š"

    # å½¢æ€3: çœ‹è·Œåæ²¡ (Bearish Engulfing)
    if is_bearish_engulfing(recent_candles[-2:]):
        return "BEARISH_ENGULFING", 0.80, "çœ‹è·Œåæ²¡ï¼Œåè½¬ä¿¡å·"

    # å½¢æ€4: åå­—æ˜Ÿåœ¨é«˜ä½
    if is_doji_at_top(recent_candles[-1], recent_candles):
        return "DOJI_AT_TOP", 0.70, "é«˜ä½åå­—æ˜Ÿï¼ŒçŠ¹è±«ä¿¡å·"

    # å½¢æ€5: è¿ç»­ä¸Šå½±çº¿
    upper_shadows = 0
    for candle in recent_candles[-5:]:
        body_size = abs(candle['close'] - candle['open'])
        upper_shadow = candle['high'] - max(candle['close'], candle['open'])
        if upper_shadow > body_size * 2:
            upper_shadows += 1

    if upper_shadows >= 3:
        return "MULTIPLE_UPPER_SHADOWS", 0.75, "è¿ç»­ä¸Šå½±çº¿ï¼ŒæŠ›å‹æ²‰é‡"

    return None, 0, None

def is_evening_star(candles):
    """é»„æ˜ä¹‹æ˜Ÿ: å¤§é˜³çº¿ â†’ å°å®ä½“ â†’ å¤§é˜´çº¿"""
    if len(candles) != 3:
        return False

    c1, c2, c3 = candles

    # ç¬¬ä¸€æ ¹: å¤§é˜³çº¿
    body1 = c1['close'] - c1['open']
    is_bullish1 = body1 > 0 and body1 / c1['open'] > 0.03

    # ç¬¬äºŒæ ¹: å°å®ä½“ï¼ˆåå­—æ˜Ÿæˆ–å°é˜³/é˜´çº¿ï¼‰
    body2 = abs(c2['close'] - c2['open'])
    is_small2 = body2 / c2['open'] < 0.01

    # ç¬¬ä¸‰æ ¹: å¤§é˜´çº¿
    body3 = c3['open'] - c3['close']
    is_bearish3 = body3 > 0 and body3 / c3['open'] > 0.03

    return is_bullish1 and is_small2 and is_bearish3

def is_shooting_star(candle):
    """å°„å‡»ä¹‹æ˜Ÿ: é•¿ä¸Šå½±çº¿ï¼Œå°å®ä½“ï¼Œæ— ä¸‹å½±çº¿"""
    body_size = abs(candle['close'] - candle['open'])
    upper_shadow = candle['high'] - max(candle['close'], candle['open'])
    lower_shadow = min(candle['close'], candle['open']) - candle['low']

    # ä¸Šå½±çº¿ > 2å€å®ä½“ï¼Œä¸‹å½±çº¿å¾ˆå°
    return (upper_shadow > body_size * 2 and
            lower_shadow < body_size * 0.5 and
            body_size / candle['open'] < 0.02)
```

**é¡¶éƒ¨Kçº¿å½¢æ€å›¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¶éƒ¨åè½¬Kçº¿å½¢æ€                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚ 1. å°„å‡»ä¹‹æ˜Ÿ (Shooting Star)          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”  â† é•¿ä¸Šå½±çº¿                â”‚
â”‚    â”‚    â”‚                            â”‚
â”‚    â””â”€Xâ”€â”€â”˜  â† å°å®ä½“ï¼Œæ— ä¸‹å½±çº¿         â”‚
â”‚                                      â”‚
â”‚ 2. é»„æ˜ä¹‹æ˜Ÿ (Evening Star)           â”‚
â”‚    â”Œâ”€â”                               â”‚
â”‚    â””â”€â”˜  X  â”Œâ”€â”  â† ä¸‰æ ¹Kçº¿ç»„åˆ        â”‚
â”‚            â””â”€â”˜                       â”‚
â”‚                                      â”‚
â”‚ 3. çœ‹è·Œåæ²¡ (Bearish Engulfing)      â”‚
â”‚    â”Œâ”€â”€â”€â”                             â”‚
â”‚    â””â”€â”€â”€â”˜  â”Œâ”€â”  â† å¤§é˜´çº¿åæ²¡å°é˜³çº¿    â”‚
â”‚           â””â”€â”˜                        â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2.3 ç»¼åˆé€ƒé¡¶ä¿¡å·è¯„åˆ†ç³»ç»Ÿ

```python
def calculate_top_escape_score(
    rsi_values,              # RSIå€¼
    has_divergence,          # æ˜¯å¦èƒŒç¦»
    volume_decreasing,       # æˆäº¤é‡æ˜¯å¦èç¼©
    funding_rate,            # èµ„é‡‘è´¹ç‡
    smart_money_outflow,     # èªæ˜é’±æµå‡º
    top_pattern,             # é¡¶éƒ¨å½¢æ€
    price_gain               # æ¶¨å¹…
):
    """
    è®¡ç®—é€ƒé¡¶ä¿¡å·ç»¼åˆè¯„åˆ†

    Returns:
        total_score (0-100), confidence, action
    """
    score = 0
    details = []

    # 1. RSIè¶…ä¹°è¯„åˆ† (æƒé‡30%)
    rsi_score, rsi_level, rsi_reasons = check_rsi_overbought(rsi_values)
    score += (rsi_score - 50) * 0.6  # å½’ä¸€åŒ–åˆ°30åˆ†
    details.extend(rsi_reasons)

    # 2. èƒŒç¦»è¯„åˆ† (æƒé‡25%)
    if has_divergence:
        score += 25
        details.append("âš ï¸ é¡¶èƒŒç¦»å‡ºç° - å¼ºçƒˆåè½¬ä¿¡å·")

    # 3. æˆäº¤é‡è¯„åˆ† (æƒé‡15%)
    if volume_decreasing:
        score += 15
        details.append("æˆäº¤é‡èç¼© - ä¸Šæ¶¨ä¹åŠ›")

    # 4. èµ„é‡‘è´¹ç‡è¯„åˆ† (æƒé‡15%)
    if funding_rate > 0.001:
        score += 15
        details.append(f"èµ„é‡‘è´¹ç‡{funding_rate*100:.3f}% - å¤šå¤´è¿‡çƒ­")
    elif funding_rate > 0.0005:
        score += 10
        details.append(f"èµ„é‡‘è´¹ç‡{funding_rate*100:.3f}% - åé«˜")

    # 5. èªæ˜é’±è¯„åˆ† (æƒé‡10%)
    if smart_money_outflow:
        score += 10
        details.append("èªæ˜é’±æµå‡º - å¤§æˆ·æ’¤é€€")

    # 6. Kçº¿å½¢æ€è¯„åˆ† (æƒé‡5%)
    if top_pattern:
        score += 5
        details.append(f"é¡¶éƒ¨å½¢æ€: {top_pattern}")

    # 7. æ¶¨å¹…è¿‡å¤§å¥–åŠ± (å¥–åŠ±é¡¹ï¼Œæœ€å¤š+10åˆ†)
    if price_gain > 0.30:  # æ¶¨è¶…30%
        score += 10
        details.append(f"çŸ­æœŸæ¶¨å¹…{price_gain*100:.0f}% - è·åˆ©ç›˜æ²‰é‡")
    elif price_gain > 0.20:
        score += 5
        details.append(f"çŸ­æœŸæ¶¨å¹…{price_gain*100:.0f}%")

    # é™åˆ¶åœ¨0-100
    score = max(0, min(100, score))

    # ç¡®å®šæ“ä½œå»ºè®®
    if score >= 85:
        confidence = 0.95
        action = "ç«‹å³å‡ä»“50%æˆ–åšç©º30%"
        level = "ğŸ”´ æä½³é€ƒé¡¶/åšç©ºæœºä¼š"
    elif score >= 75:
        confidence = 0.85
        action = "åˆ†æ‰¹å‡ä»“30%æˆ–åšç©º20%"
        level = "ğŸŸ  ä¼˜è´¨é€ƒé¡¶/åšç©ºæœºä¼š"
    elif score >= 65:
        confidence = 0.75
        action = "å‡ä»“20%æˆ–è¯•æ¢åšç©º10%"
        level = "ğŸŸ¡ è‰¯å¥½é€ƒé¡¶/åšç©ºæœºä¼š"
    elif score >= 55:
        confidence = 0.65
        action = "å‡ä»“10%ï¼Œåšå¥½å‡†å¤‡"
        level = "ğŸŸ¢ æ½œåœ¨é€ƒé¡¶æœºä¼š"
    else:
        confidence = 0.40
        action = "ç»§ç»­æŒæœ‰ï¼Œå¯†åˆ‡è§‚å¯Ÿ"
        level = "âšª æ¡ä»¶ä¸è¶³"

    return {
        'score': round(score, 1),
        'confidence': confidence,
        'action': action,
        'level': level,
        'details': details
    }
```

---

### 2.4 é€ƒé¡¶å®æˆ˜ç­–ç•¥

#### ç­–ç•¥A: åˆ†æ‰¹å‡ä»“é€ƒé¡¶ï¼ˆæ¨èï¼‰

```python
def pyramid_top_escape(top_score, current_price, position_size):
    """
    é‡‘å­—å¡”å¼åˆ†æ‰¹é€ƒé¡¶

    Returns:
        exit_plan: [(price, percentage, reason), ...]
    """
    exits = []

    # ç¬¬ä¸€æ‰¹: åˆå§‹ä¿¡å·å‡ºç° (å¾—åˆ†65+)
    if top_score >= 65:
        exits.append({
            'trigger': 'score >= 65',
            'price': current_price,
            'percentage': 0.20,  # å‡ä»“20%
            'reason': 'åˆå§‹é¡¶éƒ¨ä¿¡å·ï¼Œå…ˆæ­¢ç›ˆ20%'
        })

    # ç¬¬äºŒæ‰¹: ä¿¡å·å¢å¼º (å¾—åˆ†75+)
    if top_score >= 75:
        exits.append({
            'trigger': 'score >= 75',
            'price': current_price * 1.02,  # æ¶¨2%
            'percentage': 0.30,              # å†å‡30%
            'reason': 'ä¿¡å·å¢å¼ºï¼Œå†æ­¢ç›ˆ30%'
        })

    # ç¬¬ä¸‰æ‰¹: æå¼ºä¿¡å· (å¾—åˆ†85+)
    if top_score >= 85:
        exits.append({
            'trigger': 'score >= 85',
            'price': current_price * 1.03,  # æ¶¨3%
            'percentage': 0.30,              # å†å‡30%
            'reason': 'æå¼ºä¿¡å·ï¼Œå†æ­¢ç›ˆ30%'
        })

    # ç¬¬å››æ‰¹: ç ´ä½æ­¢æŸ (è·Œç ´å…³é”®æ”¯æ’‘)
    exits.append({
        'trigger': 'break_support',
        'price': current_price * 0.95,  # è·Œ5%
        'percentage': 0.20,              # å‰©ä½™å…¨æ¸…
        'reason': 'ç ´ä½æ­¢æŸï¼Œæ¸…ä»“å‰©ä½™20%'
    })

    return exits
```

**ç¤ºä¾‹**:
```
BTC ä» $95,000 æ¶¨è‡³ $110,000 (+15.8%)
ç»¼åˆé€ƒé¡¶è¯„åˆ†: 82åˆ†
å½“å‰æŒä»“: 40%

åˆ†æ‰¹å‡ä»“è®¡åˆ’:
â”œâ”€ ç¬¬1æ‰¹: $110,000 â†’ å‡ä»“20% (8%ä»“ä½)
â”œâ”€ ç¬¬2æ‰¹: $112,200 â†’ å‡ä»“30% (12%ä»“ä½)
â”œâ”€ ç¬¬3æ‰¹: $113,300 â†’ å‡ä»“30% (12%ä»“ä½)
â””â”€ ç¬¬4æ‰¹: $104,500 â†’ å‰©ä½™æ¸…ä»“ (8%ä»“ä½)

é¢„æœŸå‡ä»“: 32% (ä¿ç•™8%è¿½è¸ªæ­¢ç›ˆ)
```

---

#### ç­–ç•¥B: å»ºç«‹ç©ºä»“åˆçº¦

**é€ƒé¡¶ + åšç©º = åŒå‘è·åˆ©**

```python
def establish_short_position(
    top_score,
    current_price,
    cash_available
):
    """
    å»ºç«‹ç©ºä»“åˆçº¦ç­–ç•¥

    Returns:
        short_plan
    """
    # åšç©ºæ¡ä»¶
    if top_score < 75:
        return None  # ä¿¡å·ä¸å¤Ÿå¼ºï¼Œä¸åšç©º

    # è®¡ç®—åšç©ºä»“ä½
    if top_score >= 85:
        short_percentage = 0.30  # 30%èµ„é‡‘åšç©º
        leverage = 5             # 5å€æ æ†
        confidence = 0.90
    elif top_score >= 75:
        short_percentage = 0.20  # 20%èµ„é‡‘åšç©º
        leverage = 3             # 3å€æ æ†
        confidence = 0.80
    else:
        short_percentage = 0.10  # 10%èµ„é‡‘åšç©º
        leverage = 2             # 2å€æ æ†
        confidence = 0.70

    # æ­¢æŸæ­¢ç›ˆè®¾ç½®
    stop_loss = current_price * 1.05      # æ­¢æŸ+5%
    take_profit_1 = current_price * 0.95  # æ­¢ç›ˆ-5%
    take_profit_2 = current_price * 0.92  # æ­¢ç›ˆ-8%
    take_profit_3 = current_price * 0.88  # æ­¢ç›ˆ-12%

    return {
        'action': 'SHORT',
        'entry_price': current_price,
        'position_size': short_percentage,
        'leverage': leverage,
        'confidence': confidence,
        'stop_loss': stop_loss,
        'take_profits': [
            {'price': take_profit_1, 'size': 0.30, 'reason': 'å¿«é€Ÿå›è°ƒ-5%'},
            {'price': take_profit_2, 'size': 0.40, 'reason': 'ç»§ç»­ä¸‹è·Œ-8%'},
            {'price': take_profit_3, 'size': 0.30, 'reason': 'æ·±åº¦å›è°ƒ-12%'}
        ],
        'max_holding_time': '24-48å°æ—¶',
        'reason': f'é¡¶éƒ¨ä¿¡å·å¼ºçƒˆ(è¯„åˆ†{top_score})ï¼Œåšç©ºè·åˆ©'
    }
```

**åšç©ºå®æˆ˜è¦ç‚¹**:

1. **å…¥åœºæ—¶æœº**:
   ```python
   # æœ€ä½³åšç©º: å¾—åˆ†85+ + RSI > 80 + èµ„é‡‘è´¹ç‡ > 0.1%
   if score >= 85 and rsi > 80 and funding_rate > 0.001:
       short_position = 0.30  # 30%èµ„é‡‘
       leverage = 5           # 5å€æ æ†
   ```

2. **æ­¢æŸè®¾ç½®**:
   ```python
   # åšç©ºæ­¢æŸ: çªç ´å‰é«˜ + 3-5%
   stop_loss = previous_high * 1.03
   ```

3. **æ­¢ç›ˆè®¾ç½®**:
   ```
   å¿«é€Ÿæ­¢ç›ˆ: -5%  â†’ æ­¢ç›ˆ30%
   ä¸»è¦ç›®æ ‡: -8%  â†’ æ­¢ç›ˆ40%
   æé™ç›®æ ‡: -12% â†’ æ­¢ç›ˆ30%
   ```

4. **æŒä»“æ—¶é—´**:
   ```
   çŸ­çº¿åšç©º: 12-24å°æ—¶
   æ³¢æ®µåšç©º: 2-5å¤©
   ä¸è¦é•¿æœŸæŒæœ‰ç©ºå•
   ```

---

#### ç­–ç•¥C: ç°è´§å¯¹å†²åšç©º

**æŒæœ‰ç°è´§çš„åŒæ—¶åšç©ºåˆçº¦ï¼Œé”å®šåˆ©æ¶¦**

```python
def hedge_with_short(
    spot_position,      # ç°è´§ä»“ä½
    current_price,
    top_score
):
    """
    ç°è´§å¯¹å†²åšç©ºç­–ç•¥

    é€‚åˆåœºæ™¯: ä¸æƒ³å–ç°è´§ï¼Œä½†æƒ³é”å®šåˆ©æ¶¦
    """
    if top_score < 70:
        return None

    # å¯¹å†²æ¯”ä¾‹: æ ¹æ®ä¿¡å·å¼ºåº¦è°ƒæ•´
    if top_score >= 85:
        hedge_ratio = 0.80  # å¯¹å†²80%
    elif top_score >= 75:
        hedge_ratio = 0.60  # å¯¹å†²60%
    else:
        hedge_ratio = 0.40  # å¯¹å†²40%

    # è®¡ç®—åšç©ºæ•°é‡
    short_size = spot_position * hedge_ratio

    # ä¸ç”¨æ æ†ï¼Œ1:1å¯¹å†²
    leverage = 1

    return {
        'strategy': 'SPOT_HEDGE',
        'spot_position': spot_position,
        'short_position': short_size,
        'hedge_ratio': hedge_ratio,
        'leverage': leverage,
        'entry_price': current_price,
        'benefit': 'é”å®šåˆ©æ¶¦ï¼Œé¿å…å›è°ƒæŸå¤±',
        'cost': 'èµ„é‡‘è´¹ç‡ï¼ˆå¦‚æœä¸ºæ­£ï¼‰',
        'duration': 'çŸ­æœŸæˆ–ä¸­æœŸæŒæœ‰'
    }
```

**å¯¹å†²ç¤ºä¾‹**:
```
æŒæœ‰BTCç°è´§: 1 BTC @ $95,000
å½“å‰ä»·æ ¼: $110,000 (+15.8%)
æµ®ç›ˆ: $15,000

é¡¶éƒ¨ä¿¡å·: 80åˆ†

å¯¹å†²ç­–ç•¥:
â”œâ”€ ä¿ç•™ç°è´§: 1 BTC
â”œâ”€ åšç©ºåˆçº¦: 0.6 BTC (60%å¯¹å†²)
â””â”€ æ æ†: 1å€

ç»“æœ:
- å¦‚æœè·Œè‡³$100,000: ç°è´§äº$10Kï¼Œåˆçº¦èµš$6Kï¼Œå‡€äº$4K
- å¦‚æœæ¶¨è‡³$115,000: ç°è´§èµš$5Kï¼Œåˆçº¦äº$3Kï¼Œå‡€èµš$2K
- é”å®šå¤§éƒ¨åˆ†åˆ©æ¶¦ï¼Œå‡å°‘å›æ’¤
```

---

### 2.5 é€ƒé¡¶åçš„ç®¡ç†

#### å¹³ä»“æ­¢ç›ˆ

```python
def manage_short_position(
    entry_price,
    current_price,
    unrealized_profit_pct
):
    """
    åšç©ºä»“ä½ç®¡ç†
    """
    # å¿«é€Ÿæ­¢ç›ˆ: ç›ˆåˆ© > 5%
    if unrealized_profit_pct > 0.05:
        return "TAKE_PROFIT_30%", "å¿«é€Ÿæ­¢ç›ˆï¼Œå…ˆé”å®šåˆ©æ¶¦"

    # ä¸»è¦ç›®æ ‡: ç›ˆåˆ© > 8%
    if unrealized_profit_pct > 0.08:
        return "TAKE_PROFIT_40%", "è¾¾åˆ°ä¸»è¦ç›®æ ‡ï¼Œæ­¢ç›ˆ40%"

    # æé™ç›®æ ‡: ç›ˆåˆ© > 12%
    if unrealized_profit_pct > 0.12:
        return "TAKE_PROFIT_30%", "è¾¾åˆ°æé™ç›®æ ‡ï¼Œå…¨éƒ¨æ­¢ç›ˆ"

    # æ­¢æŸ: åå¼¹è¶…è¿‡å…¥åœºä»·3%
    if current_price > entry_price * 1.03:
        return "STOP_LOSS", "çªç ´æ­¢æŸä½ï¼Œç«‹å³å¹³ä»“"

    return "HOLD", "ç»§ç»­æŒæœ‰"
```

#### ç©ºå•æ­¢æŸ

```python
# åšç©ºæ­¢æŸåŸåˆ™
ç©ºå•æ­¢æŸ = å…¥åœºä»· Ã— (1 + æ­¢æŸæ¯”ä¾‹)

# ä¸åŒæ æ†çš„æ­¢æŸ
æ æ†2å€: æ­¢æŸ +5%
æ æ†3å€: æ­¢æŸ +4%
æ æ†5å€: æ­¢æŸ +3%
æ æ†10å€: æ­¢æŸ +2%
```

---

## 3. ç»¼åˆå®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹1: BTC é—ªå´©æŠ„åº• (2024-08-05)

**å¸‚åœºèƒŒæ™¯**:
- æ—¥æœŸ: 2024å¹´8æœˆ5æ—¥
- BTCä»$62,000è·Œè‡³$49,000 (-21%)
- å¸‚åœºæåº¦ææ…Œ

**æŠ„åº•ä¿¡å·æ£€æµ‹**:
```python
# 1. è¶…è·Œå¹…åº¦
price_drop_24h = -0.21  # 24å°æ—¶è·Œ21% âœ…

# 2. RSIè¶…å–
rsi_5m = 12   # 5åˆ†é’ŸRSI âœ…
rsi_15m = 18  # 15åˆ†é’ŸRSI âœ…
rsi_1h = 22   # 1å°æ—¶RSI âœ…

# 3. æˆäº¤é‡æ”¾å¤§
volume_ratio = 6.5  # æˆäº¤é‡6.5å€ âœ…

# 4. èµ„é‡‘è´¹ç‡
funding_rate = -0.0015  # -0.15% âœ…

# 5. èªæ˜é’±
hyperliquid_inflow = $350,000  # å¤§é¢æµå…¥ âœ…

# ç»¼åˆè¯„åˆ†
bottom_score = 88åˆ†  # æä½³æŠ„åº•æœºä¼š
```

**æ“ä½œæ‰§è¡Œ**:
```
ç¬¬1æ‰¹: $49,500 â†’ 15%ä»“ä½
ç¬¬2æ‰¹: $48,000 â†’ 10%ä»“ä½ (å›è°ƒ)
ç¬¬3æ‰¹: $51,000 â†’ 10%ä»“ä½ (ä¼ç¨³åå¼¹)

æ€»ä»“ä½: 35%
å¹³å‡æˆæœ¬: $49,571
```

**ç»“æœ**:
```
åå¼¹è‡³ $53,000 (+7%): æ­¢ç›ˆ40% â†’ è·åˆ©$1,143
åå¼¹è‡³ $56,000 (+13%): æ­¢ç›ˆ30% â†’ è·åˆ©$1,929
åå¼¹è‡³ $58,000 (+17%): æ­¢ç›ˆ30% â†’ è·åˆ©$2,529

æ€»è·åˆ©: $5,601 (11.3%)
æŒä»“æ—¶é—´: 36å°æ—¶
```

---

### æ¡ˆä¾‹2: BTC é€ƒé¡¶åšç©º (2024-03-14)

**å¸‚åœºèƒŒæ™¯**:
- æ—¥æœŸ: 2024å¹´3æœˆ14æ—¥
- BTCä»$64,000æ¶¨è‡³$73,700 (+15%)
- RSIæåº¦è¶…ä¹°

**é€ƒé¡¶ä¿¡å·æ£€æµ‹**:
```python
# 1. RSIè¶…ä¹°
rsi_5m = 88   # æåº¦è¶…ä¹° âœ…
rsi_15m = 84  # è¶…ä¹° âœ…
rsi_1h = 78   # è¶…ä¹° âœ…

# 2. é¡¶èƒŒç¦»
price_peaks = [$71,000, $73,700]  # åˆ›æ–°é«˜
rsi_peaks = [82, 78]              # RSIä¸åˆ›æ–°é«˜ âœ…

# 3. æˆäº¤é‡èç¼©
volume_ratio = 0.65  # ä»…65%å‡é‡ âœ…

# 4. èµ„é‡‘è´¹ç‡
funding_rate = 0.0012  # 0.12% âœ…

# 5. èªæ˜é’±
hyperliquid_outflow = -$280,000  # æµå‡º âœ…

# ç»¼åˆè¯„åˆ†
top_score = 86åˆ†  # æä½³é€ƒé¡¶/åšç©ºæœºä¼š
```

**æ“ä½œæ‰§è¡Œ**:
```
å‡ä»“ç°è´§:
â”œâ”€ $73,500 â†’ å‡ä»“30% (é”å®šåˆ©æ¶¦)
â”œâ”€ $74,200 â†’ å‡ä»“20% (ç»§ç»­ä¸Šæ¶¨)
â””â”€ $72,000 â†’ å‡ä»“20% (å›è°ƒ)

åšç©ºåˆçº¦:
â”œâ”€ å…¥åœº: $73,800
â”œâ”€ ä»“ä½: 25%
â”œâ”€ æ æ†: 5å€
â””â”€ æ­¢æŸ: $76,494 (+3.5%)
```

**ç»“æœ**:
```
ä¸‹è·Œè‡³ $70,000 (-5.1%): ç©ºå•æ­¢ç›ˆ40% â†’ è·åˆ©$1,900
ä¸‹è·Œè‡³ $68,000 (-7.9%): ç©ºå•æ­¢ç›ˆ30% â†’ è·åˆ©$1,740
ä¸‹è·Œè‡³ $65,000 (-11.9%): ç©ºå•æ­¢ç›ˆ30% â†’ è·åˆ©$2,640

ç©ºå•æ€»è·åˆ©: $6,280 (33.9%)
ç°è´§ä¿æŠ¤åˆ©æ¶¦: $15,200
æ€»è·åˆ©: $21,480
æŒä»“æ—¶é—´: 72å°æ—¶
```

---

## 4. é£é™©æ§åˆ¶è¦ç‚¹

### 4.1 æŠ„åº•é£é™©æ§åˆ¶

**é£é™©1: æŠ„åœ¨åŠå±±è…°**

```python
# é¢„é˜²æªæ–½
if price_drop < 0.10:
    return "è·Œå¹…ä¸å¤Ÿï¼Œä¸æŠ„åº•"

if not is_stabilized:
    return "æœªä¼ç¨³ï¼Œä¸æŠ„åº•"

if consecutive_losses >= 2:
    return "è¿ç»­æŠ„åº•å¤±è´¥ï¼Œæš‚åœ"
```

**é£é™©2: æŠ„åº•åç»§ç»­è·Œ**

```python
# ä¸¥æ ¼æ­¢æŸ
stop_loss = entry_price * 0.95  # -5%æ­¢æŸ

# åˆ†æ‰¹å»ºä»“ï¼Œä¸ä¸€æŠŠæ¢­
max_position = 0.40  # æœ€å¤š40%
```

---

### 4.2 åšç©ºé£é™©æ§åˆ¶

**é£é™©1: ç©ºå•è¢«è½§**

```python
# ä¸¥æ ¼æ­¢æŸ
if current_price > entry_price * 1.05:
    close_short("æ­¢æŸ")

# é™åˆ¶æ æ†
max_leverage = 5  # æœ€å¤§5å€

# å…³æ³¨èµ„é‡‘è´¹ç‡
if funding_rate > 0.002:  # > 0.2%
    close_short("èµ„é‡‘è´¹ç‡è¿‡é«˜")
```

**é£é™©2: åšç©ºåœ¨åº•éƒ¨**

```python
# ä¸åœ¨è¶…è·Œåç«‹å³åšç©º
if price_drop_24h < -0.15:
    return "è¶…è·Œï¼Œä¸åšç©º"

# ç­‰å¾…åå¼¹ååšç©º
if not has_rebound:
    return "æœªåå¼¹ï¼Œä¸åšç©º"
```

---

### 4.3 é€šç”¨é£é™©æ§åˆ¶

```python
# 1. å•ç¬”æœ€å¤§äºæŸ
max_loss_per_trade = capital * 0.05  # 5%

# 2. æ—¥å†…æœ€å¤§äºæŸ
max_daily_loss = capital * 0.10  # 10%

# 3. è´¦æˆ·å›æ’¤é™åˆ¶
if drawdown > 0.20:  # å›æ’¤ > 20%
    stop_all_trading()

# 4. è¿ç»­äºæŸä¿æŠ¤
if consecutive_losses >= 3:
    pause_trading(duration="24å°æ—¶")
```

---

## 5. æ€»ç»“

### æŠ„åº•è¦ç‚¹
1. âœ… **è¶…è·Œå¹…åº¦** - è‡³å°‘è·Œ10-15%
2. âœ… **RSIè¶…å–** - å¤šå‘¨æœŸRSI < 25
3. âœ… **æˆäº¤é‡æ”¾å¤§** - ææ…Œæ€§æŠ›å”®
4. âœ… **ä»·æ ¼ä¼ç¨³** - å‡ºç°æ­¢è·Œä¿¡å·
5. âœ… **åˆ†æ‰¹å»ºä»“** - ä¸è¦ä¸€æŠŠæ¢­
6. âœ… **å¿«é€Ÿæ­¢ç›ˆ** - åå¼¹5-8%å³å¯

### é€ƒé¡¶è¦ç‚¹
1. âœ… **RSIè¶…ä¹°** - å¤šå‘¨æœŸRSI > 75
2. âœ… **é¡¶èƒŒç¦»** - ä»·æ ¼æ–°é«˜ï¼ŒæŒ‡æ ‡ä¸æ–°é«˜
3. âœ… **æˆäº¤é‡èç¼©** - ä¸Šæ¶¨ä¹åŠ›
4. âœ… **èµ„é‡‘è´¹ç‡é«˜** - å¤šå¤´è¿‡çƒ­
5. âœ… **åˆ†æ‰¹å‡ä»“** - ä¸è¦ä¸€æ¬¡æ€§æ¸…ä»“
6. âœ… **åšç©ºè·åˆ©** - å»ºç«‹ç©ºä»“åˆçº¦

### æ ¸å¿ƒç†å¿µ
> **"æŠ„åº•ä¸æŠ„é¡¶ï¼Œé€ƒé¡¶ä¸é€ƒåº•"**
> **"åˆ†æ‰¹æ“ä½œï¼Œä¸¥æ ¼æ­¢æŸ"**
> **"å¿«è¿›å¿«å‡ºï¼Œä¸è¦è´ªå¿ƒ"**

---

**ç¥ä½ äº¤æ˜“é¡ºåˆ©ï¼** ğŸ¯ğŸ’°
