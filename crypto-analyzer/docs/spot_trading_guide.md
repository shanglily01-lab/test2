# ç°è´§äº¤æ˜“ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

ç°è´§äº¤æ˜“ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„äº¤æ˜“æ¨¡å—ï¼Œä¸åˆçº¦äº¤æ˜“ç³»ç»Ÿäº’ä¸å¹²æ‰°ã€‚é‡‡ç”¨"è¶…çº§å¤§è„‘"çš„ABCDå¤šç­–ç•¥ä¿¡å·ç”Ÿæˆç³»ç»Ÿï¼Œå®ç°æ™ºèƒ½åŒ–çš„ç°è´§äº¤æ˜“ç®¡ç†ã€‚

## æ ¸å¿ƒç‰¹æ€§

### 1. ABCDå¤šç­–ç•¥ä¿¡å·ç³»ç»Ÿ

#### ç­–ç•¥A: è¶‹åŠ¿çªç ´ (Trend Breakout)
- **åŸç†**: ä»·æ ¼çªç ´å¸ƒæ—å¸¦ä¸Šè½¨ + æˆäº¤é‡æ”¾å¤§ + EMAå¤šå¤´æ’åˆ—
- **é€‚ç”¨åœºæ™¯**: å¼ºåŠ¿ä¸Šæ¶¨è¶‹åŠ¿çš„åˆæœŸ
- **ä¿¡å·å¼ºåº¦è®¡ç®—**:
  - çªç ´ä¸Šè½¨è·ç¦» (40åˆ†)
  - EMA9 > EMA21 è¶‹åŠ¿ç¡®è®¤ (30åˆ†)
  - æˆäº¤é‡æ”¾å¤§1.5å€ä»¥ä¸Š (30åˆ†)

#### ç­–ç•¥B: è¶…å–åå¼¹ (Oversold Bounce)
- **åŸç†**: RSIè¶…å– + ä»·æ ¼æ¥è¿‘å¸ƒæ—å¸¦ä¸‹è½¨ + å‡ºç°åè½¬Kçº¿
- **é€‚ç”¨åœºæ™¯**: è¶…è·Œåçš„åå¼¹æœºä¼š
- **ä¿¡å·å¼ºåº¦è®¡ç®—**:
  - RSI < 30 è¶…å– (50åˆ†)
  - è·ç¦»ä¸‹è½¨2%ä»¥å†… (30åˆ†)
  - Kçº¿åè½¬å½¢æ€ (20åˆ†)

#### ç­–ç•¥C: è¶‹åŠ¿è·Ÿéš (Trend Following)
- **åŸç†**: EMAå¤šå¤´æ’åˆ— + ä»·æ ¼å›è¸©å‡çº¿æ”¯æ’‘
- **é€‚ç”¨åœºæ™¯**: ç¨³å¥çš„ä¸­æœŸè¶‹åŠ¿
- **ä¿¡å·å¼ºåº¦è®¡ç®—**:
  - EMA9 > EMA21 > EMA50 å¤šå¤´æ’åˆ— (60åˆ†)
  - è¶‹åŠ¿å¼ºåº¦é¢å¤–åŠ åˆ† (æœ€å¤š20åˆ†)
  - ä»·æ ¼å›è¸©æ”¯æ’‘ (20åˆ†)

#### ç­–ç•¥D: å¤šé‡å…±æŒ¯ (Multi-Confirmation)
- **åŸç†**: Aã€Bã€Cç­–ç•¥ä¸­è‡³å°‘2ä¸ªå‘å‡ºä¿¡å·
- **é€‚ç”¨åœºæ™¯**: é«˜ç¡®å®šæ€§æœºä¼š
- **ä¿¡å·å¼ºåº¦è®¡ç®—**:
  - å–ä¸‰ä¸ªç­–ç•¥å¹³å‡åˆ†
  - æ¯ä¸ªæ´»è·ƒç­–ç•¥é¢å¤–åŠ 15åˆ†

### 2. åˆ†æ‰¹å»ºä»“ç³»ç»Ÿ

é‡‡ç”¨5æ‰¹æ¬¡å»ºä»“ç­–ç•¥ï¼Œæ ¹æ®ä¿¡å·å¼ºåº¦å’Œä»·æ ¼å˜åŒ–æ™ºèƒ½åŠ ä»“:

| æ‰¹æ¬¡ | èµ„é‡‘æ¯”ä¾‹ | åŠ ä»“æ¡ä»¶ |
|------|---------|----------|
| ç¬¬1æ‰¹ | 10% | åˆå§‹å¼€ä»“ (ä¿¡å·å¼ºåº¦ â‰¥ 60) |
| ç¬¬2æ‰¹ | 10% | ä»·æ ¼å›è°ƒ â‰¥ 2% æˆ– ä¸Šæ¶¨ â‰¥ 3% + ä¿¡å·å¼ºåŠ² |
| ç¬¬3æ‰¹ | 20% | åŒä¸Š |
| ç¬¬4æ‰¹ | 20% | åŒä¸Š |
| ç¬¬5æ‰¹ | 40% | åŒä¸Š |

**åŠ ä»“é€»è¾‘**:
- **é€¢ä½åŠ ä»“**: ä»·æ ¼ç›¸æ¯”ä¸Šæ‰¹ä¸‹è·Œ â‰¥ 2%
- **è¿½æ¶¨åŠ ä»“**: ä»·æ ¼ç›¸æ¯”ä¸Šæ‰¹ä¸Šæ¶¨ â‰¥ 3% ä¸”ä¿¡å·ä¾ç„¶å¼ºåŠ²

**ç‰¹æ®Šè°ƒæ•´**:
- å½“ä¿¡å·å¼ºåº¦ > 80 æ—¶ï¼Œç¬¬1æ‰¹é‡‘é¢å¢åŠ 10%

### 3. èµ„é‡‘ç®¡ç†

| å‚æ•° | æ•°å€¼ |
|------|------|
| æ€»èµ„é‡‘ | 50,000 USDT |
| å•å¸èµ„é‡‘ | 10,000 USDT |
| ç°é‡‘å‚¨å¤‡ | 20% (10,000 USDT) |
| æœ€å¤§æŒä»“æ•° | 5ä¸ª |
| æ­¢ç›ˆæ¯”ä¾‹ | 50% |
| æ­¢æŸæ¯”ä¾‹ | 10% |

**èµ„é‡‘åˆ†é…ç¤ºä¾‹**:
- æŒä»“1: BTC/USDT (10,000 USDT)
- æŒä»“2: ETH/USDT (10,000 USDT)
- æŒä»“3: SOL/USDT (10,000 USDT)
- æŒä»“4: BNB/USDT (10,000 USDT)
- æŒä»“5: LTC/USDT (10,000 USDT)
- ç°é‡‘å‚¨å¤‡: 10,000 USDT (ä¸åŠ¨ç”¨)

### 4. é£é™©ç®¡ç†

#### æ­¢ç›ˆç­–ç•¥
- **ç›®æ ‡**: å…¥åœºä»· Ã— 1.50 (50%ç›ˆåˆ©)
- **æ‰§è¡Œ**: è§¦åŠç›®æ ‡ä»·ç«‹å³å…¨éƒ¨å¹³ä»“

#### æ­¢æŸç­–ç•¥
- **ç›®æ ‡**: å…¥åœºä»· Ã— 0.90 (10%äºæŸ)
- **æ‰§è¡Œ**: è§¦åŠæ­¢æŸä»·ç«‹å³å…¨éƒ¨å¹³ä»“

#### å®æ—¶ç›‘æ§
- æ¯ä¸ªäº¤æ˜“å‘¨æœŸ (5åˆ†é’Ÿ) æ£€æŸ¥æ‰€æœ‰æŒä»“
- è‡ªåŠ¨è§¦å‘æ­¢ç›ˆ/æ­¢æŸ
- è‡ªåŠ¨æ£€æµ‹åŠ ä»“æœºä¼š

## æ•°æ®åº“è¡¨ç»“æ„

### spot_positions (ç°è´§æŒä»“è¡¨)
```sql
- id: æŒä»“ID
- symbol: äº¤æ˜“å¯¹
- entry_price: é¦–æ¬¡ä¹°å…¥ä»·æ ¼
- avg_entry_price: å¹³å‡æˆæœ¬ä»·
- quantity: æŒä»“æ•°é‡
- total_cost: æ€»æˆæœ¬
- current_batch: å½“å‰æ‰¹æ¬¡ (1-5)
- take_profit_price: æ­¢ç›ˆä»·æ ¼
- stop_loss_price: æ­¢æŸä»·æ ¼
- status: active/closed
```

### spot_batch_history (åŠ ä»“è®°å½•è¡¨)
```sql
- position_id: å…³è”æŒä»“ID
- batch_number: æ‰¹æ¬¡å·
- buy_price: ä¹°å…¥ä»·æ ¼
- quantity: æ•°é‡
- signal_strength: ä¿¡å·å¼ºåº¦
```

### spot_signals_history (ä¿¡å·å†å²è¡¨)
```sql
- symbol: äº¤æ˜“å¯¹
- signal_strength: ä¿¡å·å¼ºåº¦
- best_strategy: æœ€ä½³ç­–ç•¥ (A/B/C/D)
- score_a, score_b, score_c, score_d: å„ç­–ç•¥å¾—åˆ†
- is_executed: æ˜¯å¦å·²æ‰§è¡Œ
```

## å¯åŠ¨å’Œä½¿ç”¨

### 1. åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿æ¥æ•°æ®åº“
mysql -u root -p binance-data

# å¯¼å…¥ç°è´§äº¤æ˜“è¡¨ç»“æ„
source app/database/spot_trading_schema.sql
```

### 2. å¯åŠ¨æœåŠ¡

```bash
# å‰å°è¿è¡Œ (æµ‹è¯•ç”¨)
python spot_trader_service.py

# åå°è¿è¡Œ (ç”Ÿäº§ç¯å¢ƒ)
nohup python spot_trader_service.py > logs/spot_trader.log 2>&1 &
```

### 3. æŸ¥çœ‹å®æ—¶æ—¥å¿—

```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f logs/spot_trader_$(date +%Y-%m-%d).log

# æŸ¥çœ‹ä»Šæ—¥äº¤æ˜“
tail -n 100 logs/spot_trader_$(date +%Y-%m-%d).log | grep "ğŸ¯"
```

### 4. ç›‘æ§æŒä»“

```sql
-- æŸ¥çœ‹å½“å‰æŒä»“
SELECT
    symbol,
    entry_price,
    avg_entry_price,
    quantity,
    current_batch,
    take_profit_price,
    stop_loss_price,
    ROUND((quantity * avg_entry_price), 2) as invested_usdt,
    signal_strength,
    created_at
FROM spot_positions
WHERE status = 'active'
ORDER BY created_at DESC;

-- æŸ¥çœ‹ä»Šæ—¥äº¤æ˜“ç»Ÿè®¡
SELECT * FROM spot_trading_summary
WHERE trade_date = CURDATE();

-- æŸ¥çœ‹ç›ˆäºTOP10
SELECT
    symbol,
    entry_price,
    exit_price,
    ROUND(pnl, 2) as pnl,
    ROUND(pnl_pct * 100, 2) as pnl_pct,
    close_reason,
    closed_at
FROM spot_positions
WHERE status = 'closed'
ORDER BY pnl DESC
LIMIT 10;
```

### 5. æ‰‹åŠ¨å¹²é¢„

```sql
-- å¼ºåˆ¶å¹³ä»“ (ç´§æ€¥æƒ…å†µ)
UPDATE spot_positions
SET status = 'closed',
    exit_price = <å½“å‰ä»·æ ¼>,
    pnl = (<å½“å‰ä»·æ ¼> - avg_entry_price) * quantity,
    pnl_pct = (<å½“å‰ä»·æ ¼> - avg_entry_price) / avg_entry_price,
    close_reason = 'æ‰‹åŠ¨å¹³ä»“',
    closed_at = NOW()
WHERE id = <æŒä»“ID>;
```

## äº¤æ˜“æµç¨‹ç¤ºä¾‹

### åœºæ™¯1: è¶‹åŠ¿çªç ´å¼€ä»“

```
æ—¶é—´: 2026-01-22 10:00
ä¿¡å·: BTC/USDT çªç ´ä¸Šè½¨ + æˆäº¤é‡æ”¾å¤§
å¼ºåº¦: 85åˆ† (ç­–ç•¥A)

æ“ä½œæµç¨‹:
1. æ£€æµ‹åˆ°ä¿¡å·å¼ºåº¦ â‰¥ 60
2. æ£€æŸ¥å½“å‰æŒä»“æ•° < 5
3. è®¡ç®—ç¬¬1æ‰¹é‡‘é¢: 10,000 Ã— 10% Ã— 1.1 = 1,100 USDT (å¼ºä¿¡å·åŠ 10%)
4. å½“å‰ä»·æ ¼: 42,500 USDT
5. ä¹°å…¥æ•°é‡: 1,100 / 42,500 = 0.0259 BTC
6. è®¾ç½®æ­¢ç›ˆ: 42,500 Ã— 1.50 = 63,750 USDT
7. è®¾ç½®æ­¢æŸ: 42,500 Ã— 0.90 = 38,250 USDT
8. åˆ›å»ºæŒä»“è®°å½•

æ—¥å¿—è¾“å‡º:
âœ… åˆ›å»ºæŒä»“: BTC/USDT @ 42500.0000, æ•°é‡: 0.03, æ‰¹æ¬¡: 1/5
```

### åœºæ™¯2: ä»·æ ¼å›è°ƒåŠ ä»“

```
æ—¶é—´: 2026-01-22 10:30
æŒä»“: BTC/USDT @ 42,500 (ç¬¬1æ‰¹)
å½“å‰ä»·æ ¼: 41,650 USDT
ä»·æ ¼å˜åŒ–: -2.0%

æ“ä½œæµç¨‹:
1. æ£€æµ‹åˆ°ä»·æ ¼å›è°ƒ â‰¥ 2%
2. é‡æ–°ç”Ÿæˆä¿¡å·: å¼ºåº¦ 75åˆ†
3. è®¡ç®—ç¬¬2æ‰¹é‡‘é¢: 10,000 Ã— 10% = 1,000 USDT
4. ä¹°å…¥æ•°é‡: 1,000 / 41,650 = 0.0240 BTC
5. æ›´æ–°å¹³å‡æˆæœ¬: (1,100 + 1,000) / (0.0259 + 0.0240) = 42,084 USDT
6. æ›´æ–°æŒä»“è®°å½•

æ—¥å¿—è¾“å‡º:
âœ… åŠ ä»“: BTC/USDT @ 41650.0000, æ•°é‡: 0.02, æ‰¹æ¬¡: 2/5
   æ–°å¹³å‡æˆæœ¬: 42084.0000, æ€»æ•°é‡: 0.05
```

### åœºæ™¯3: è§¦å‘æ­¢ç›ˆ

```
æ—¶é—´: 2026-01-23 14:00
æŒä»“: BTC/USDT @ 42,084 (ç¬¬3æ‰¹ï¼Œæ€»æ•°é‡ 0.15 BTC)
å½“å‰ä»·æ ¼: 63,750 USDT (æ­¢ç›ˆä»·)

æ“ä½œæµç¨‹:
1. æ£€æµ‹åˆ°ä»·æ ¼ â‰¥ æ­¢ç›ˆä»·
2. è®¡ç®—ç›ˆäº: (63,750 - 42,084) Ã— 0.15 = 3,249.90 USDT
3. ç›ˆäºæ¯”ä¾‹: (63,750 - 42,084) / 42,084 = 51.5%
4. å¹³ä»“å¹¶è®°å½•

æ—¥å¿—è¾“å‡º:
ğŸ¯ è§¦å‘æ­¢ç›ˆ: BTC/USDT @ 63750.0000 (ç›®æ ‡: 63750.0000)
âœ… å¹³ä»“: BTC/USDT @ 63750.0000, ç›ˆäº: 3249.90 USDT (51.50%), åŸå› : æ­¢ç›ˆ
```

## æ€§èƒ½æŒ‡æ ‡

### é¢„æœŸè¡¨ç°
- **èƒœç‡**: 60-70% (åŸºäºå¤šç­–ç•¥å…±æŒ¯)
- **ç›ˆäºæ¯”**: 5:1 (50%æ­¢ç›ˆ vs 10%æ­¢æŸ)
- **å¹³å‡æŒä»“æ—¶é—´**: 1-3å¤©
- **æœˆåº¦é¢„æœŸæ”¶ç›Š**: 10-20%

### é£é™©æ§åˆ¶
- å•ç¬”æœ€å¤§äºæŸ: 1,000 USDT (10% Ã— 10,000)
- æ€»èµ„é‡‘æœ€å¤§å›æ’¤: 20%
- ä»“ä½åˆ†æ•£: 5ä¸ªä¸åŒå¸ç§
- ç°é‡‘å‚¨å¤‡: 20% åº”å¯¹çªå‘æœºä¼š

## æ³¨æ„äº‹é¡¹

1. **ç‹¬ç«‹è¿è¡Œ**: ç°è´§äº¤æ˜“ä¸åˆçº¦äº¤æ˜“å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å½±å“
2. **èµ„é‡‘éš”ç¦»**: ç°è´§ä½¿ç”¨ç‹¬ç«‹çš„5ä¸‡USDTèµ„é‡‘ï¼Œä¸ä¸åˆçº¦èµ„é‡‘æ··ç”¨
3. **å¸ç§é€‰æ‹©**: ä»config.yamlè¯»å–äº¤æ˜“å¯¹åˆ—è¡¨ï¼Œç¡®ä¿æµåŠ¨æ€§å……è¶³
4. **ä¿¡å·é˜ˆå€¼**: åªåœ¨ä¿¡å·å¼ºåº¦ â‰¥ 60 æ—¶å¼€ä»“ï¼Œç¡®ä¿è´¨é‡
5. **æ‰¹æ¬¡çºªå¾‹**: ä¸¥æ ¼æŒ‰ç…§5æ‰¹æ¬¡æ¯”ä¾‹å»ºä»“ï¼Œé¿å…å†²åŠ¨äº¤æ˜“
6. **æ­¢ç›ˆæ­¢æŸ**: è‡ªåŠ¨æ‰§è¡Œï¼Œä¸ä¸»è§‚å¹²é¢„
7. **æ•°æ®ä¾èµ–**: ä¾èµ–5m Kçº¿æ•°æ®å’ŒWebSocketå®æ—¶ä»·æ ¼

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
mysql -u root -p binance-data -e "SELECT 1"

# æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
mysql -u root -p binance-data -e "SHOW TABLES LIKE 'spot_%'"

# æ£€æŸ¥æ—¥å¿—
tail -n 50 logs/spot_trader_$(date +%Y-%m-%d).log
```

### é—®é¢˜2: æ— ä¿¡å·ç”Ÿæˆ
```bash
# æ£€æŸ¥Kçº¿æ•°æ®æ˜¯å¦æ›´æ–°
mysql -u root -p binance-data -e "
SELECT symbol, timeframe, FROM_UNIXTIME(open_time/1000), close_price
FROM kline_data
WHERE timeframe = '5m'
ORDER BY open_time DESC
LIMIT 10
"

# æ£€æŸ¥WebSocketä»·æ ¼æœåŠ¡
tail -f logs/spot_trader_$(date +%Y-%m-%d).log | grep "WebSocket"
```

### é—®é¢˜3: æŒä»“æœªè‡ªåŠ¨å¹³ä»“
```bash
# æ£€æŸ¥æŒä»“çŠ¶æ€
mysql -u root -p binance-data -e "
SELECT id, symbol, avg_entry_price, take_profit_price, stop_loss_price, status
FROM spot_positions
WHERE status = 'active'
"

# æ£€æŸ¥å½“å‰ä»·æ ¼
tail -f logs/spot_trader_$(date +%Y-%m-%d).log | grep "é£é™©ç®¡ç†"
```

## æœªæ¥ä¼˜åŒ–æ–¹å‘

1. **åŠ¨æ€æ­¢ç›ˆæ­¢æŸ**: æ ¹æ®æ³¢åŠ¨ç‡è‡ªé€‚åº”è°ƒæ•´
2. **æ™ºèƒ½æ‰¹æ¬¡è°ƒæ•´**: æ ¹æ®å¸‚åœºçŠ¶æ€è°ƒæ•´æ‰¹æ¬¡æ¯”ä¾‹
3. **å¤šå¸ç§ç›¸å…³æ€§åˆ†æ**: é¿å…åŒç±»å¸ç§é‡å¤æŒä»“
4. **æœºå™¨å­¦ä¹ å¢å¼º**: ä½¿ç”¨å†å²æ•°æ®ä¼˜åŒ–ä¿¡å·æƒé‡
5. **æƒ…ç»ªæŒ‡æ ‡æ•´åˆ**: ç»“åˆå¸‚åœºæƒ…ç»ªæ•°æ®
6. **è‡ªåŠ¨å¤ç›˜**: æ¯æ—¥ç”Ÿæˆäº¤æ˜“æŠ¥å‘Šå’Œæ”¹è¿›å»ºè®®

## è”ç³»å’Œæ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚

---

**ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2026-01-22
**ä½œè€…**: Crypto Analyzer Team
