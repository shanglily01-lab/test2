# 超级大脑完整交易机制详解

> 最后更新: 2026-01-27

## 目录
1. [开仓信号系统](#一开仓信号系统)
2. [分批建仓机制](#二分批建仓机制)
3. [平仓机制](#三平仓机制)
4. [风控与黑名单](#四风控与黑名单)

---

## 一、开仓信号系统

### 1.1 信号生成流程

超级大脑每5分钟扫描100个交易对(币安合约交易量前100),通过**多时间框架分析**生成交易信号。

**扫描周期**: 300秒 (5分钟)
**监控币种**: 100个USDT合约交易对
**评分阈值**: 27分 (从初始的30分优化降低)

### 1.2 信号评分维度

信号由**12个评分维度**组成,分为做多评分和做空评分:

#### 📍 1. 价格位置 (Position)
- **position_low** (底部区域): +20分做多
  - 条件: 当前价格 < 3天最低价 + 15%波动范围
  - 适合抄底

- **position_mid** (中部区域): +10分做多
  - 条件: 价格在15%-70%区间
  - 安全区域

- **position_high** (顶部区域): +20分做空
  - 条件: 当前价格 > 3天最低价 + 70%波动范围
  - 需额外验证(见1.3节)

#### 📈 2. 短期动量 (Momentum)
- **momentum_down_3pct** (24H跌超3%): +15分做多
  - 适合反弹做多

- **momentum_up_3pct** (24H涨超3%): +15分做空
  - 适合回调做空

#### 📊 3. 1小时趋势 (Trend 1H)
基于最近48根1H K线(2天数据):

- **trend_1h_bull** (看涨): +20分做多
  - 条件: 阳线数量 > 30根 (62.5%)

- **trend_1h_bear** (看跌): +20分做空
  - 条件: 阴线数量 > 30根 (62.5%)

#### 🌊 4. 波动率 (Volatility)
- **volatility_high** (高波动): +10分(跟随当前趋势)
  - 条件: 24H价格波动 > 5%
  - 高波动更适合交易
  - 同时会扩大止损到1.5倍

#### 🔥 5. 连续趋势强化 (Consecutive)
基于最近10根1H K线:

- **consecutive_bull** (连续阳线): +15分做多
  - 条件: 7+根阳线,涨幅<5%,不在顶部(position<70%)

- **consecutive_bear** (连续阴线): +15分做空
  - 条件: 7+根阴线,跌幅>-5%,不在底部(position>30%)

#### ⚡ 6-8. K线力量分析 (核心维度)

这是超级大脑的**核心判断依据**,通过量能加权的K线分析:

**净力量计算公式**:
```
净力量 = 高量能阳线数量 - 高量能阴线数量
高量能 = 成交量 > 1.2倍平均量
```

- **6. 1H K线力量** (最近24根,1天数据)
  - 做多条件: `net_power_1h >= 3`  (+15分)
  - 做空条件: `net_power_1h <= -3` (+15分)

- **7. 15M K线力量** (最近24根,6小时数据)
  - 做多条件: `net_power_15m >= 3`  (+15分)
  - 做空条件: `net_power_15m <= -3` (+15分)

- **8. 5M K线力量** (最近24根,2小时数据)
  - 做多条件: `net_power_5m >= 3`   (+10分)
  - 做空条件: `net_power_5m <= -3`  (+10分)

#### 📉 9-10. 破位追踪 (Breakdown/Breakout)

- **9. breakout_long** (破位追多): +15分做多
  - 条件:
    - position < 30% (低位)
    - 1H净力量 > 5 (强势)
    - 当前涨幅 > 2% (正在突破)

- **10. breakdown_short** (破位追空): +15分做空
  - 条件:
    - position > 70% (高位)
    - 1H净力量 < -5 (弱势)
    - 当前跌幅 > -2% (正在破位)

#### 📅 11-12. 日线趋势确认 (Trend 1D)
基于最近30根1D K线:

- **trend_1d_bull** (日线看涨): +10分做多
  - 条件: 阳线>18根(60%) 且1H也看多

- **trend_1d_bear** (日线看跌): +10分做空
  - 条件: 阴线>18根(60%) 且1H也看空

### 1.3 信号验证机制

生成信号后需要通过**4道验证关卡**:

#### ✅ 关卡1: 时间框架一致性检查
```python
规则1: 做多时,1H不能看跌 (trend_1h_bear)
规则2: 做空时,1H不能看涨 (trend_1h_bull)
规则3: 做多时,1D不能看跌 (trend_1d_bear)
规则4: 做空时,1D不能看涨 (trend_1d_bull)
```

#### ✅ 关卡2: Position High增强验证
针对做空信号中包含`position_high`的情况,需要额外确认顶部特征:

1. **不能伴随momentum_up**: 如果价格还在上涨3%+,动能未衰竭
2. **上影线比例检查**: 最近10根1H K线上影线比例需>30%
3. **成交量萎缩检查**: 最近5根K线成交量不能是之前5根的1.2倍以上

#### ✅ 关卡3: 持仓数量检查
- 总持仓数 < max_positions (默认999,不限制)
- 实际由资金控制

#### ✅ 关卡4: 黑名单检查
- 交易对黑名单 (3级评级制度)
- 信号类型黑名单

### 1.4 信号示例

**强做多信号示例** (评分72分):
```
ATOM/USDT LONG
- position_low: 20分      (价格在底部)
- momentum_down_3pct: 15分 (24H跌了4%)
- trend_1h_bull: 20分     (阳线占比65%)
- kline_1h_long: 15分     (1H净力量+5)
- kline_15m_long: 15分    (15M净力量+4)
- consecutive_bull: 15分  (连续8根阳线)
- volatility_high: 10分   (波动率6%)
- trend_1d_bull: 10分     (日线看涨)
```

**强做空信号示例** (评分65分):
```
SOL/USDT SHORT
- position_high: 20分     (价格在顶部,已验证)
- momentum_up_3pct: 15分  (24H涨了5%)
- trend_1h_bear: 20分     (阴线占比70%)
- kline_1h_short: 15分    (1H净力量-6)
- kline_15m_short: 15分   (15M净力量-5)
- breakdown_short: 15分   (破位追空)
- volatility_high: 10分   (波动率7%)
```

---

## 二、分批建仓机制

### 2.1 K线强度驱动的动态建仓策略

超级大脑根据**K线强度评分**动态调整建仓策略,共3种模式:

#### 🚀 激进模式 (K线强度 ≥ 30分)
```
分批比例: 50% / 30% / 20%
建仓窗口: 15分钟
批次超时: 5分钟 / 8分钟 / 10分钟

特点: 快速建仓,抓住强势趋势
适用: 信号极强,需要快速上车
```

#### ⚖️ 平衡模式 (20分 ≤ K线强度 < 30分)
```
分批比例: 30% / 30% / 40%
建仓窗口: 30分钟
批次超时: 15分钟 / 20分钟 / 28分钟

特点: 标准分批,平衡风险收益
适用: 常规信号,默认策略
```

#### 🛡️ 保守模式 (K线强度 < 20分)
```
分批比例: 20% / 30% / 50%
建仓窗口: 45分钟
批次超时: 20分钟 / 28分钟 / 38分钟

特点: 试探性建仓,等待确认
适用: 信号较弱,需要更多确认
```

### 2.2 K线强度评分体系

**满分: 40分**

#### 1H K线评分 (0-15分)
```
净力量 ≥ 7:  15分 (极强)
净力量 = 5-6: 12分 (很强)
净力量 = 3-4: 8分  (强)
净力量 = 1-2: 4分  (一般)
净力量 ≤ 0:   0分  (弱)
```

#### 15M K线评分 (0-15分)
```
净力量 ≥ 7:  15分
净力量 = 5-6: 12分
净力量 = 3-4: 8分
净力量 = 1-2: 4分
净力量 ≤ 0:   0分
```

#### 5M K线评分 (0-10分)
```
净力量 ≥ 5:  10分
净力量 = 3-4: 7分
净力量 = 1-2: 4分
净力量 ≤ 0:   0分
```

**信号质量分级**:
- **强信号**: K线强度 ≥ 25分
- **中信号**: 15分 ≤ K线强度 < 25分
- **弱信号**: K线强度 < 15分

### 2.3 分批建仓执行流程

#### 阶段1: 价格采样 (5分钟)
1. 启动后台价格采样器
2. 建立5分钟滚动窗口
3. 采集初始价格基线

**基线数据**:
```python
{
    'min_price': 最低价,
    'max_price': 最高价,
    'p50': 中位数,
    'p25': 25%分位数,
    'p75': 75%分位数,
    'mean': 平均价,
    'std': 标准差,
    'trend': {
        'direction': 'up'/'down'/'neutral',
        'change_pct': 变化百分比
    }
}
```

#### 阶段2: 动态入场 (持续监控)

每10秒检查一次,判断是否执行当前批次:

**第1批判断逻辑** (立即执行):
```python
条件: 信号生成后立即执行
目的: 快速建立初始仓位
```

**第2批判断逻辑** (优化入场):
```python
做多条件 (满足任一):
1. 当前价格 ≤ 第1批价格 (价格更优)
2. 当前价格 ≤ P50中位数 (不高于基线)
3. 价格略高于第1批但在容忍范围 (+0.3%)
4. 距第1批超时(15/20分钟,根据策略)
5. 距信号超时(20/28分钟,根据策略)

做空条件 (相反):
1. 当前价格 ≥ 第1批价格
2. 当前价格 ≥ P50中位数
3. 价格略低于第1批但在容忍范围 (-0.3%)
4. 距第1批超时
5. 距信号超时
```

**第3批判断逻辑** (完成建仓):
```python
做多条件 (满足任一):
1. 当前价格 ≤ 前两批平均价 (最优入场)
2. 当前价格 ≤ P50中位数
3. 价格接近平均价但在容忍范围 (+0.3%)
4. 距第2批超时(8分钟)
5. 距信号超时(28/38分钟,根据策略)

做空条件 (相反)
```

#### 阶段3: 超时兜底

如果到达建仓窗口仍未完成全部批次,强制以市价完成剩余建仓。

### 2.4 系统重启恢复机制

**问题**: 系统重启会导致后台建仓任务中断,持仓卡在`building`状态

**解决方案**: 启动时自动恢复

```python
启动流程:
1. 检查所有status='building'的持仓
2. 判断创建时间:
   - 超过1小时: 直接标记为open (保留已完成批次)
   - 1小时内: 启动后台任务继续建仓
3. 重建采样器,继续执行未完成批次
```

**恢复逻辑**:
- 读取`batch_plan`和`batch_filled`字段
- 重建plan对象
- 使用简化判断逻辑继续建仓
- 最多尝试20分钟

### 2.5 建仓记录

每完成一个批次,立即更新数据库:

**第1批**: 创建持仓记录,status='building'
```sql
INSERT INTO futures_positions (
    account_id, symbol, position_side, quantity,
    entry_price, avg_entry_price, leverage, margin,
    batch_plan, batch_filled, status, ...
) VALUES (...)
```

**第2/3批**: 更新持仓记录
```sql
UPDATE futures_positions SET
    quantity = quantity + new_quantity,
    avg_entry_price = weighted_avg_price,
    margin = margin + new_margin,
    batch_filled = updated_json,
    updated_at = NOW()
WHERE id = position_id
```

**全部完成**: 标记为open,启动智能平仓监控
```sql
UPDATE futures_positions SET
    status = 'open'
WHERE id = position_id
```

---

## 三、平仓机制

超级大脑使用**K线强度驱动的3阶段智能平仓系统**,共7个优先级检查。

### 3.1 K线强度衰退检测

持仓开仓后,系统持续监控当前K线强度,判断趋势是否衰退:

**衰退判定**:
```
开仓时K线强度: 32分
当前K线强度: 18分
衰退比例: (32-18)/32 = 43.75% > 40%
→ 触发分阶段平仓
```

### 3.2 三阶段渐进平仓机制

#### 阶段0 → 阶段1: 首次平仓50%
**触发条件**:
- K线强度衰退 ≥ 40%
- 且持仓时间 ≥ 10分钟 (避免过早平仓)

**执行**: 平仓50%仓位,保留50%

#### 阶段1 → 阶段2: 再平仓70%
**触发条件**:
- 距离阶段1平仓 ≥ 5分钟
- 且满足以下任一条件:
  1. K线强度继续衰退 ≥ 60%
  2. 持仓收益 < 0 (亏损状态)
  3. 收益率 ≤ 0.5% (收益微薄)

**执行**: 平仓剩余的70%,保留15%

#### 阶段2 → 阶段3: 完全平仓
**触发条件**:
- 距离阶段2平仓 ≥ 3分钟
- 且满足以下任一条件:
  1. K线强度衰退 ≥ 70%
  2. 持仓亏损
  3. 持仓时间 > 2小时

**执行**: 平仓剩余15%,完全退出

### 3.3 七级优先级平仓检查

每个持仓每30秒执行一次全面检查,按优先级顺序:

#### 🔴 优先级1: 固定止损 (最高优先级)
```
触发: 收益率 ≤ -stop_loss_pct (默认-2%,-3%)
动作: 立即全仓平仓
原因: 保护本金,避免大额亏损
```

#### 🟠 优先级2: 顶部/底部检测
```
做多持仓:
- 检测当前是否处于顶部 (position_high验证通过)
- 触发: 顶部特征明显
- 动作: 立即全仓平仓

做空持仓:
- 检测当前是否处于底部 (position_low)
- 触发: 价格 < 3天最低价 + 15%
- 动作: 立即全仓平仓
```

#### 🟡 优先级3: 固定止盈
```
触发: 收益率 ≥ take_profit_pct (默认+2%)
动作: 立即全仓平仓
原因: 锁定利润,防止回撤
```

#### 🟢 优先级4: 动态超时 (核心机制)
```
根据K线强度动态计算超时时间:

max_hold = 360分钟 (6小时)
min_hold = 120分钟 (2小时)

K线强度 ≥ 30分: timeout = 360分钟 (趋势强,多持有)
K线强度 = 20分:  timeout = 240分钟
K线强度 = 10分:  timeout = 180分钟
K线强度 < 10分:  timeout = 120分钟 (趋势弱,少持有)

触发: 持仓时间 > 动态超时
动作:
  - 如果盈利 > 0: 立即全仓平仓 (落袋为安)
  - 如果亏损: 继续持有 (等待反弹)
```

#### 🔵 优先级5: K线强度衰退分阶段平仓
```
触发: 见3.2节
动作:
  - 阶段0→1: 平50%
  - 阶段1→2: 平70%
  - 阶段2→3: 平15% (全清)
```

#### 🟣 优先级6: 绝对超时
```
触发: 持仓时间 > max_hold_minutes (6小时)
动作: 全仓平仓
原因: 防止持仓过久占用资金
```

#### ⚫ 优先级7: 信号反转对冲
```
触发:
1. 当前有新信号,方向与持仓相反
2. 新信号分数 > 持仓分数 + reversal_threshold
3. reversal_threshold根据黑名单等级动态调整:
   - Level 0 (正常): +12分
   - Level 1 (警告): +15分
   - Level 2 (危险): +18分

动作: 平仓当前持仓,并开立反向对冲仓位

示例:
持有 BTC/USDT LONG (开仓评分55分)
新信号 BTC/USDT SHORT (评分70分)
→ 70 > 55 + 12 = 67
→ 触发反向平仓 + 开空
```

### 3.4 平仓延迟保护

如果持仓已经延长过平仓时间(extended),不再允许继续延长:

```python
if close_extended == 1:
    logger.warning(f"持仓 {position_id} 已延长过,不再延长")
    return False
```

### 3.5 智能平仓监控

所有open状态的持仓会被自动加入智能平仓监控:

```python
启动时:
- 遍历所有status='open'的持仓
- 为每个持仓启动后台监控任务
- 每30秒执行一次7级检查

运行中:
- 新持仓建仓完成后自动加入监控
- 持仓平仓后自动移除监控
```

---

## 四、风控与黑名单

### 4.1 三级黑名单制度

根据交易对的历史表现,分为3个评级等级:

#### Level 0: 正常交易对
```
特征: 胜率正常,盈亏比健康
仓位: 400 USDT (标准仓)
反转阈值: +12分
```

#### Level 1: 警告交易对
```
特征: 胜率或盈亏比轻微异常
仓位: 100 USDT (小仓)
反转阈值: +15分 (更难反转)
特殊规则: 开仓前加强验证
```

#### Level 2: 危险交易对
```
特征: 胜率低或盈亏比差
仓位: 50 USDT (极小仓)
反转阈值: +18分 (很难反转)
特殊规则: 严格限制开仓
```

#### Level 3: 完全禁止
```
特征: 持续亏损,无法交易
仓位: 0 (禁止开仓)
```

### 4.2 评级计算逻辑

每日凌晨4点自动更新交易对评级:

```python
最近7天数据:
- 总交易次数 ≥ 5次 (样本要求)
- 计算胜率和盈亏比
- 计算累计盈亏

降级条件:
1. 胜率 < 40% 且交易次数 ≥ 10次
2. 盈亏比 < 0.8
3. 累计亏损 < -10%

升级条件:
1. 连续7天无亏损交易
2. 胜率 > 55% 且交易次数 ≥ 10次
3. 盈亏比 > 1.2
```

### 4.3 仓位控制

```python
标准仓位: 400 USDT
黑名单仓位:
  - Level 1: 100 USDT
  - Level 2: 50 USDT
  - Level 3: 0 USDT (禁止)

杠杆: 5倍 (固定)

实际开仓金额 = 仓位 × 杠杆 = 400 × 5 = 2000 USDT 名义价值
占用保证金 = 400 USDT
```

### 4.4 对冲开仓

如果持有某方向仓位时,收到反向信号且满足反转条件:

```python
执行流程:
1. 平掉当前持仓
2. 开立反向仓位
3. 反向仓位保证金 = 原仓位保证金 × hedge_multiplier

hedge_multiplier (对冲仓位缩减):
- 默认: 0.5 (反向仓位只开一半)
- 目的: 降低双向持仓风险
```

### 4.5 资金管理

```python
账户总余额: 实时查询数据库
可用余额 = 总余额 - 冻结余额
冻结余额 = 所有open/building持仓的保证金总和

开仓检查:
if 可用余额 < 所需保证金:
    跳过该信号,记录"资金不足"
```

---

## 五、完整交易流程示例

### 示例: ATOM/USDT 做多交易

#### 1. 信号生成 (13:00:00)
```
扫描结果:
- ATOM/USDT 做多评分: 72分 (超过阈值27分)
- K线强度: 28分 (激进模式)

信号组成:
position_low: 20分
momentum_down_3pct: 15分
trend_1h_bull: 20分
kline_1h_long: 15分 (净力量+5)
kline_15m_long: 15分 (净力量+4)
kline_5m_long: 10分 (净力量+3)
volatility_high: 10分
trend_1d_bull: 10分
consecutive_bull: 15分

通过验证:
✓ 时间框架一致
✓ 持仓数量充足
✓ 不在黑名单 (Level 0)
✓ 资金充足 (可用$1200)
```

#### 2. 启动分批建仓 (13:00:05)
```
建仓策略: 激进模式
- 比例: 50% / 30% / 20%
- 窗口: 15分钟
- 超时: 5分钟 / 8分钟 / 10分钟

保证金: 400 USDT
杠杆: 5倍
名义价值: 2000 USDT

当前价格: $8.245
```

#### 3. 第1批建仓 (13:00:05)
```
比例: 50% (200 USDT保证金)
价格: $8.245
数量: 121.18 ATOM (= 200×5 / 8.245)

数据库: 创建持仓记录, status='building'
batch_filled: [{batch_num: 0, ratio: 0.5, price: 8.245, ...}]
```

#### 4. 第2批建仓 (13:04:23)
```
等待4分18秒

当前价格: $8.232 (低于第1批,价格更优!)
比例: 30% (120 USDT保证金)
数量: 72.86 ATOM

数据库: 更新持仓
总数量: 121.18 + 72.86 = 194.04 ATOM
平均价格: $8.24
batch_filled: [batch_0, batch_1]
```

#### 5. 第3批建仓 (13:09:12)
```
等待4分49秒

当前价格: $8.228 (低于平均价!)
比例: 20% (80 USDT保证金)
数量: 48.60 ATOM

数据库: 更新持仓, status='open'
总数量: 242.64 ATOM
平均价格: $8.237
batch_filled: [batch_0, batch_1, batch_2]

✅ 建仓完成! 启动智能平仓监控
```

#### 6. 持仓监控 (13:09:12 - 持续)
```
每30秒检查:
- 当前价格
- 未实现盈亏
- K线强度
- 7级平仓条件
```

#### 7. K线强度衰退 (14:25:30)
```
持仓时间: 1小时25分钟

开仓时K线强度: 28分
当前K线强度: 16分
衰退比例: 42.9% > 40%

当前价格: $8.38
未实现盈亏: +$34.71 (+1.74%)

触发: 阶段0→1 首次平仓
动作: 平仓50% (121.32 ATOM)
平仓价格: $8.38
实现盈亏: +$17.36

剩余持仓: 121.32 ATOM @ $8.237 成本
```

#### 8. 继续衰退 (14:35:45)
```
距阶段1平仓: 10分15秒

当前K线强度: 11分
衰退比例: 60.7% > 60%

当前价格: $8.42
剩余持仓盈亏: +$22.20 (+1.83%)

触发: 阶段1→2 二次平仓
动作: 平仓70% (84.92 ATOM)
平仓价格: $8.42
实现盈亏: +$15.54

剩余持仓: 36.40 ATOM @ $8.237 成本
```

#### 9. 最终平仓 (14:48:20)
```
距阶段2平仓: 12分35秒

当前K线强度: 8分
衰退比例: 71.4% > 70%

当前价格: $8.35
剩余持仓盈亏: +$4.11 (+1.37%)

触发: 阶段2→3 完全平仓
动作: 平仓100% (36.40 ATOM)
平仓价格: $8.35
实现盈亏: +$4.11

✅ 交易完成!
```

#### 10. 最终结果
```
总收益: $17.36 + $15.54 + $4.11 = $37.01
收益率: +9.25% (相对400 USDT保证金)
持仓时间: 1小时48分钟
平仓原因: K线强度衰退分阶段平仓

记录到数据库:
- status: 'closed'
- realized_pnl: 37.01
- close_reason: 'K线强度衰退(阶段3完全平仓)'
```

---

## 六、系统优势

### 1. 多维度信号 + 严格验证
- 12个评分维度全面覆盖
- 4道验证关卡确保质量
- position_high增强验证避免错误做空

### 2. K线强度驱动
- 开仓: 根据强度选择激进/平衡/保守策略
- 持仓: 动态超时,强信号持有更久
- 平仓: 强度衰退自动减仓,不必等固定止盈/止损

### 3. 分阶段风控
- 渐进式平仓,不必一次性决策
- 50%→70%→15%,逐步降低风险
- 盈利部分先锁定,剩余部分继续博弈

### 4. 黑名单制度
- 3级评级自动识别"垃圾"交易对
- 小仓位试探,避免重仓亏损
- 动态调整反转阈值

### 5. 系统稳定性
- 分批建仓任务容错(重启恢复)
- 事件循环状态检查
- 完善的日志记录

---

## 七、关键配置参数

```yaml
# 信号生成
signal_threshold: 27        # 开仓评分阈值
leverage: 5                 # 杠杆倍数
position_size: 400          # 标准仓位(USDT)
blacklist_position_size: 100 # 黑名单仓位

# 风控参数
stop_loss_pct: 0.02         # 固定止损 -2%
take_profit_pct: 0.02       # 固定止盈 +2%
max_hold_minutes: 360       # 最大持仓时间 6小时
min_hold_minutes: 120       # 最小持仓时间 2小时

# K线强度衰退
decay_stage1_threshold: 0.40  # 阶段1触发 40%衰退
decay_stage2_threshold: 0.60  # 阶段2触发 60%衰退
decay_stage3_threshold: 0.70  # 阶段3触发 70%衰退

# 分批建仓
batch_ratios:
  aggressive: [0.5, 0.3, 0.2]  # 激进
  balanced: [0.3, 0.3, 0.4]    # 平衡
  conservative: [0.2, 0.3, 0.5] # 保守

# 监控周期
scan_interval: 300          # 扫描间隔 5分钟
check_interval: 30          # 平仓检查间隔 30秒
```

---

## 八、常见问题

### Q1: 为什么有些信号不开仓?
可能原因:
- 评分未达到27分阈值
- 时间框架不一致(被过滤)
- position_high验证未通过
- 在黑名单中
- 资金不足
- 持仓数量已满

### Q2: 为什么持仓会分批平仓?
K线强度驱动的分阶段平仓机制:
- 趋势衰退40%→平50%
- 趋势衰退60%→再平70%
- 趋势衰退70%→全平
- 目的: 逐步降低风险,锁定部分利润

### Q3: 系统重启后建仓任务会丢失吗?
不会!
- 启动时自动检查building状态持仓
- 1小时内的继续建仓
- 超过1小时的标记为open

### Q4: 黑名单交易对还能交易吗?
可以,但有限制:
- Level 1: 小仓位(100 USDT)
- Level 2: 极小仓位(50 USDT)
- Level 3: 完全禁止
- 目的: 控制风险,不完全放弃

### Q5: 如何提高捕获率?
系统已优化:
- 阈值从30降至27分(捕获更多信号)
- K线强度驱动(激进模式快速建仓)
- 分批建仓(不错过好价格)

---

## 九、系统监控指标

### 实时监控
- 当前持仓数量
- 总未实现盈亏
- 可用余额
- 正在building的持仓
- 最近信号生成时间

### 复盘分析
- 24H胜率
- 24H盈亏比
- 24H平均持仓时间
- 信号捕获率
- 错过信号原因分析

### 交易对评级
- Level 0/1/2/3 数量
- 胜率排行
- 盈亏比排行
- 累计盈亏排行

---

**文档版本**: v2.0
**最后更新**: 2026-01-27
**维护者**: 超级大脑开发团队
