# æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## é—®é¢˜ï¼šç­–ç•¥æ‰§è¡Œå™¨æ²¡æœ‰è¿è¡Œ

å¦‚æœä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼Œå‘ç°æ²¡æœ‰è®¢å•åœ¨æ‰§è¡Œï¼Œé€šå¸¸æ˜¯å› ä¸º**ç­–ç•¥æ‰§è¡Œå™¨æ²¡æœ‰å¯åŠ¨**ã€‚

## å¿«é€Ÿæ£€æŸ¥

è¿è¡Œæ£€æŸ¥è„šæœ¬ï¼š
```bash
python scripts/check_server_status.py
```

è¿™ä¸ªè„šæœ¬ä¼šæ£€æŸ¥ï¼š
1. Pythonè¿›ç¨‹æ˜¯å¦åœ¨è¿è¡Œ
2. æ•°æ®åº“è¿æ¥æ˜¯å¦æ­£å¸¸
3. ç­–ç•¥é…ç½®æ˜¯å¦æ­£ç¡®
4. æœ€è¿‘çš„è®¢å•å’ŒæŒä»“æƒ…å†µ
5. æ—¥å¿—æ–‡ä»¶çŠ¶æ€

## å¯åŠ¨ç­–ç•¥æ‰§è¡Œå™¨

### æ–¹æ³•1ï¼šç›´æ¥è¿è¡Œï¼ˆæµ‹è¯•ç”¨ï¼‰

```bash
python app/strategy_scheduler.py
```

è¿™ç§æ–¹å¼ä¼šåœ¨å‰å°è¿è¡Œï¼Œå…³é—­ç»ˆç«¯ä¼šåœæ­¢æœåŠ¡ã€‚

### æ–¹æ³•2ï¼šåå°è¿è¡Œï¼ˆLinux/Macï¼‰

```bash
nohup python app/strategy_scheduler.py > logs/strategy_scheduler.log 2>&1 &
```

æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
tail -f logs/strategy_scheduler.log
```

### æ–¹æ³•3ï¼šä½¿ç”¨ screenï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºæ–°çš„screenä¼šè¯
screen -S strategy

# åœ¨screenä¸­è¿è¡Œç­–ç•¥æ‰§è¡Œå™¨
python app/strategy_scheduler.py

# æŒ‰ Ctrl+A ç„¶åæŒ‰ D æ¥åˆ†ç¦»ä¼šè¯ï¼ˆæœåŠ¡ç»§ç»­è¿è¡Œï¼‰
# é‡æ–°è¿æ¥ï¼šscreen -r strategy
```

### æ–¹æ³•4ï¼šä½¿ç”¨ systemdï¼ˆLinuxï¼Œç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

åˆ›å»ºæœåŠ¡æ–‡ä»¶ `/etc/systemd/system/strategy-scheduler.service`ï¼š

```ini
[Unit]
Description=Strategy Scheduler Service
After=network.target mysql.service

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/crypto-analyzer
ExecStart=/usr/bin/python3 /path/to/crypto-analyzer/app/strategy_scheduler.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl enable strategy-scheduler
sudo systemctl start strategy-scheduler
sudo systemctl status strategy-scheduler
```

## éªŒè¯ç­–ç•¥æ‰§è¡Œå™¨æ˜¯å¦è¿è¡Œ

### 1. æ£€æŸ¥è¿›ç¨‹

**Linux/Mac:**
```bash
ps aux | grep strategy_scheduler
```

**Windows:**
```bash
tasklist | findstr python
```

### 2. æ£€æŸ¥æ—¥å¿—

æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```
åˆå§‹åŒ–ç­–ç•¥æ‰§è¡Œå™¨...
  âœ“ ç­–ç•¥æ‰§è¡Œå™¨åˆå§‹åŒ–æˆåŠŸ
ğŸ”„ ç­–ç•¥å®æ—¶ç›‘æ§æœåŠ¡å·²å¯åŠ¨ï¼ˆé—´éš”: 5ç§’ï¼‰
æ‰¾åˆ° X ä¸ªå¯ç”¨çš„ç­–ç•¥ï¼Œå¼€å§‹æ£€æŸ¥...
```

### 3. æ£€æŸ¥æ•°æ®åº“

æŸ¥è¯¢ç­–ç•¥å‘½ä¸­è®°å½•ï¼š
```sql
SELECT * FROM strategy_hits 
ORDER BY created_at DESC 
LIMIT 10;
```

å¦‚æœæœ‰æ–°çš„è®°å½•ï¼Œè¯´æ˜ç­–ç•¥æ‰§è¡Œå™¨åœ¨è¿è¡Œã€‚

## å¸¸è§é—®é¢˜

### Q1: ç­–ç•¥æ‰§è¡Œå™¨å¯åŠ¨äº†ï¼Œä½†æ²¡æœ‰è®¢å•ï¼Ÿ

**å¯èƒ½åŸå› ï¼š**
1. å¸‚åœºæ²¡æœ‰EMAäº¤å‰ä¿¡å·ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œéœ€è¦ç­‰å¾…ä¿¡å·ï¼‰
2. ä¿¡å·è¢«è¿‡æ»¤æ¡ä»¶è¿‡æ»¤æ‰äº†ï¼ˆå¦‚MA10/EMA10è¿‡æ»¤ã€RSIè¿‡æ»¤ç­‰ï¼‰
3. ç­–ç•¥é…ç½®æœ‰é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**
- è¿è¡Œè¯Šæ–­è„šæœ¬ï¼š`python scripts/diagnose_strategy_signals.py`
- æ£€æŸ¥ç­–ç•¥å‘½ä¸­è®°å½•ï¼š`python scripts/check_strategy_execution.py`
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶äº†è§£è¯¦ç»†ä¿¡æ¯

### Q2: å¦‚ä½•ç¡®è®¤ç­–ç•¥æ‰§è¡Œå™¨åœ¨è¿è¡Œï¼Ÿ

**æ£€æŸ¥æ–¹æ³•ï¼š**
1. æŸ¥çœ‹è¿›ç¨‹ï¼š`ps aux | grep strategy_scheduler`
2. æŸ¥çœ‹æ—¥å¿—ï¼š`tail -f logs/strategy_scheduler.log`
3. æ£€æŸ¥æ•°æ®åº“ï¼šæŸ¥è¯¢ `strategy_hits` è¡¨æ˜¯å¦æœ‰æ–°è®°å½•

### Q3: ç­–ç•¥æ‰§è¡Œå™¨æ„å¤–åœæ­¢æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ³•ï¼š**
1. ä½¿ç”¨ `systemd` æˆ– `supervisor` è‡ªåŠ¨é‡å¯
2. ä½¿ç”¨ `screen` æˆ– `tmux` ä¿æŒä¼šè¯
3. ä½¿ç”¨ `nohup` åå°è¿è¡Œ

### Q4: å¦‚ä½•æŸ¥çœ‹ç­–ç•¥æ‰§è¡Œå™¨çš„å®æ—¶æ—¥å¿—ï¼Ÿ

```bash
# æ–¹æ³•1ï¼štailå®æ—¶æŸ¥çœ‹
tail -f logs/strategy_scheduler.log

# æ–¹æ³•2ï¼šå¦‚æœä½¿ç”¨screen
screen -r strategy

# æ–¹æ³•3ï¼šå¦‚æœä½¿ç”¨systemd
journalctl -u strategy-scheduler -f
```

## éœ€è¦åŒæ—¶è¿è¡Œçš„æœåŠ¡

### 1. æ•°æ®é‡‡é›†å™¨ï¼ˆå¯é€‰ï¼‰
```bash
python app/scheduler.py
```
**ä½œç”¨ï¼š** é‡‡é›†å¸‚åœºæ•°æ®ï¼ˆä»·æ ¼ã€Kçº¿ç­‰ï¼‰
**æ³¨æ„ï¼š** å¦‚æœå·²ç»æœ‰æ•°æ®ï¼Œå¯ä»¥ä¸è¿è¡Œ

### 2. ç­–ç•¥æ‰§è¡Œå™¨ï¼ˆå¿…é¡»ï¼‰â­
```bash
python app/strategy_scheduler.py
```
**ä½œç”¨ï¼š** æ‰§è¡Œäº¤æ˜“ç­–ç•¥ï¼Œæ£€æµ‹ä¿¡å·ï¼Œè‡ªåŠ¨äº¤æ˜“
**æ³¨æ„ï¼š** è¿™æ˜¯å¿…é¡»è¿è¡Œçš„ï¼Œå¦åˆ™ç­–ç•¥ä¸ä¼šæ‰§è¡Œ

### 3. WebæœåŠ¡ï¼ˆå¯é€‰ï¼‰
```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000
```
**ä½œç”¨ï¼š** æä¾›Webç•Œé¢å’ŒAPI
**æ³¨æ„ï¼š** å¦‚æœåªéœ€è¦è‡ªåŠ¨äº¤æ˜“ï¼Œå¯ä»¥ä¸è¿è¡Œ

## å®Œæ•´å¯åŠ¨è„šæœ¬ç¤ºä¾‹

åˆ›å»º `start_services.sh`ï¼š

```bash
#!/bin/bash

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/crypto-analyzer

# å¯åŠ¨ç­–ç•¥æ‰§è¡Œå™¨ï¼ˆä½¿ç”¨screenï¼‰
screen -dmS strategy python app/strategy_scheduler.py

# å¯åŠ¨WebæœåŠ¡ï¼ˆå¯é€‰ï¼‰
screen -dmS web uvicorn app.main:app --host 0.0.0.0 --port 8000

echo "æœåŠ¡å·²å¯åŠ¨"
echo "æŸ¥çœ‹ç­–ç•¥æ‰§è¡Œå™¨: screen -r strategy"
echo "æŸ¥çœ‹WebæœåŠ¡: screen -r web"
```

è¿è¡Œï¼š
```bash
chmod +x start_services.sh
./start_services.sh
```

## ç›‘æ§å’Œç»´æŠ¤

### å®šæœŸæ£€æŸ¥

1. **æ¯å¤©æ£€æŸ¥ä¸€æ¬¡æ—¥å¿—**ï¼Œç¡®è®¤ç­–ç•¥æ‰§è¡Œå™¨æ­£å¸¸è¿è¡Œ
2. **æ¯å‘¨æ£€æŸ¥ä¸€æ¬¡æ•°æ®åº“**ï¼Œç¡®è®¤æœ‰ç­–ç•¥å‘½ä¸­è®°å½•
3. **æ¯æœˆæ£€æŸ¥ä¸€æ¬¡ç­–ç•¥é…ç½®**ï¼Œç¡®è®¤ç­–ç•¥ä»ç„¶å¯ç”¨

### æ—¥å¿—è½®è½¬

å»ºè®®é…ç½®æ—¥å¿—è½®è½¬ï¼Œé¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼š

åˆ›å»º `/etc/logrotate.d/strategy-scheduler`ï¼š
```
/path/to/crypto-analyzer/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
}
```

