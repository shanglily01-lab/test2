# 加密货币交易技术策略需求文档

## 文档概述

**文档版本**: v1.0
**创建日期**: 2025-11-11
**适用系统**: Crypto Analyzer 加密货币交易分析系统
**文档目的**: 定义现货交易和合约交易的技术指标、信号捕捉、操作建议及定制化用户策略的需求规范

---

## 目录

1. [系统概述](#1-系统概述)
2. [技术指标体系](#2-技术指标体系)
3. [现货交易策略](#3-现货交易策略)
4. [合约交易策略](#4-合约交易策略)
5. [买入信号捕捉](#5-买入信号捕捉)
6. [卖出信号捕捉](#6-卖出信号捕捉)
7. [操作建议生成](#7-操作建议生成)
8. [定制化用户策略](#8-定制化用户策略)
9. [风险管理](#9-风险管理)
10. [实施计划](#10-实施计划)

---

## 1. 系统概述

### 1.1 系统定位

本系统是一个综合性的加密货币交易分析平台，通过多维度数据分析为用户提供：
- 技术指标分析
- 买卖信号生成
- 自动化操作建议
- 个性化策略定制
- 模拟交易验证

### 1.2 设计原则

- **多维度分析**: 结合技术面、资金面、情绪面、链上数据
- **灵活配置**: 支持用户自定义权重和参数
- **风险可控**: 严格的风险管理和止损机制
- **实时响应**: 快速捕捉市场变化并生成信号
- **回测验证**: 支持策略历史回测和模拟交易

---

## 2. 技术指标体系

### 2.1 核心技术指标

#### 2.1.1 RSI (相对强弱指标)

**指标说明**: 衡量价格变动速度和幅度的动量振荡器

**计算参数**:
- 默认周期: 14
- 超买阈值: 70
- 超卖阈值: 30

**信号规则**:
- RSI > 70: 超买信号，可能回调
- RSI < 30: 超卖信号，可能反弹
- RSI 在 40-60 之间: 中性区域

**权重配置**: 默认 25%

#### 2.1.2 MACD (平滑异同移动平均线)

**指标说明**: 趋势跟踪动量指标，识别趋势变化

**计算参数**:
- 快速EMA: 12
- 慢速EMA: 26
- 信号线: 9

**信号规则**:
- 金叉 (MACD上穿信号线): 强烈买入信号 (+25分)
- 死叉 (MACD下穿信号线): 强烈卖出信号 (-25分)
- MACD柱状图 > 0: 多头趋势 (+5分)
- MACD柱状图 < 0: 空头趋势 (-5分)

**权重配置**: 默认 25%

#### 2.1.3 布林带 (Bollinger Bands)

**指标说明**: 价格波动区间指标，识别超买超卖

**计算参数**:
- 周期: 20
- 标准差倍数: 2

**信号规则**:
- 价格突破上轨: 超买警告 (-10分)
- 价格跌破下轨: 超卖买入机会 (+15分)
- 价格在上半区: 偏多 (+5分)
- 价格在下半区: 偏空 (-5分)

**权重配置**: 默认 20%

#### 2.1.4 EMA (指数移动平均线)

**指标说明**: 识别趋势方向和强度

**计算参数**:
- 短期EMA: 20
- 长期EMA: 50

**信号规则**:
- 短期EMA上穿长期EMA: 金叉买入 (+15分)
- 短期EMA下穿长期EMA: 死叉卖出 (-15分)
- 价格在均线之上: 上升趋势 (+10分)
- 价格在均线之下: 下降趋势 (-10分)

**权重配置**: 默认 15%

#### 2.1.5 KDJ (随机指标)

**指标说明**: 短期超买超卖指标

**计算参数**:
- 周期: 9
- 信号周期: 3

**信号规则**:
- K值 > 80: 超买 (-10分)
- K值 < 20: 超卖 (+10分)
- K线上穿D线: 买入信号
- K线下穿D线: 卖出信号

**权重配置**: 默认 10%

#### 2.1.6 成交量指标

**指标说明**: 确认价格变动的有效性

**计算参数**:
- 成交量5日均线
- 成交量20日均线

**信号规则**:
- 成交量放大 + 价格上涨: 强化买入信号 (×1.2倍权重)
- 成交量放大 + 价格下跌: 强化卖出信号 (×1.2倍权重)
- 成交量萎缩: 趋势减弱

**权重配置**: 默认 5%

### 2.2 辅助指标

#### 2.2.1 ATR (平均真实波幅)

**用途**:
- 计算止损位置
- 评估市场波动性
- 调整仓位大小

**计算周期**: 14

#### 2.2.2 OBV (能量潮)

**用途**:
- 确认趋势强度
- 识别资金流向
- 辅助判断背离

---

## 3. 现货交易策略

### 3.1 策略目标

- 中长期趋势跟踪
- 波段操作为主
- 注重风险控制
- 复利增长

### 3.2 技术指标权重配置

**五维度分析权重**:

| 维度 | 权重 | 说明 |
|-----|------|------|
| 技术指标 | 40% | RSI、MACD、布林带、EMA、KDJ等 |
| 聪明钱追踪 (Hyperliquid) | 20% | DEX大户交易行为分析 |
| 新闻情绪 | 15% | 新闻面和市场情绪指数 |
| 资金费率 | 15% | 期货资金费率，反映多空情绪 |
| 链上数据 (以太坊) | 10% | 链上转账、钱包活跃度等 |

### 3.3 买入策略

#### 3.3.1 强买入条件 (综合得分 ≥ 75)

**必要条件** (至少满足3个):
1. MACD金叉形成
2. RSI从超卖区域回升 (30-50)
3. 价格突破布林带中轨向上
4. 短期EMA上穿长期EMA
5. KDJ金叉且K值 < 80

**增强条件**:
- 成交量放大 (超过20日均量1.5倍以上)
- Hyperliquid净流入 > 100万美元
- 新闻情绪指数 > 60
- 资金费率为负 (空头付费给多头)

**建议仓位**: 60-100%最大仓位

#### 3.3.2 普通买入条件 (综合得分 60-75)

**必要条件** (至少满足2个):
1. RSI在40-60区间
2. MACD柱状图转正
3. 价格在布林带中轨之上
4. 均线呈上升趋势

**建议仓位**: 30-60%最大仓位

#### 3.3.3 分批建仓条件 (综合得分 50-60)

**特征**:
- 信号不够强烈
- 存在不确定因素
- 可以逢低分批买入

**建议仓位**: 10-30%最大仓位

### 3.4 卖出策略

#### 3.4.1 强卖出条件 (综合得分 ≤ 25)

**必要条件** (至少满足3个):
1. MACD死叉形成
2. RSI进入超买区域 (> 70)
3. 价格跌破布林带中轨
4. 短期EMA下穿长期EMA
5. KDJ死叉且K值 > 80

**增强条件**:
- 成交量放大下跌
- Hyperliquid净流出 > 100万美元
- 新闻情绪指数 < -40
- 资金费率极高 (> 0.01%)

**操作**: 全部清仓

#### 3.4.2 止盈卖出

**条件**:
- 达到预设止盈目标 (默认 +15%)
- RSI > 70 且出现顶背离
- 成交量萎缩但价格新高

**操作**: 分批止盈 (50% → 80% → 100%)

#### 3.4.3 止损卖出

**条件**:
- 达到止损线 (默认 -5%)
- 技术形态破坏 (跌破关键支撑)
- 出现重大利空消息

**操作**: 立即止损

### 3.5 持仓策略

#### 3.5.1 持仓条件

**持有标准**:
- 综合得分在 40-60 之间
- 趋势未破坏
- 未触及止盈/止损

**监控重点**:
- 每日技术指标变化
- 新闻面和市场情绪
- 关键支撑位/压力位

---

## 4. 合约交易策略

### 4.1 策略目标

- 短期交易为主
- 双向操作 (做多/做空)
- 严格杠杆控制
- 快速止损止盈

### 4.2 技术指标权重配置

**五维度分析权重** (激进型):

| 维度 | 权重 | 说明 |
|-----|------|------|
| 技术指标 | 30% | 更注重短期指标 |
| 聪明钱追踪 (Hyperliquid) | 35% | 重点关注大户动向 |
| 新闻情绪 | 10% | 降低新闻面权重 |
| 资金费率 | 15% | 重要的多空风向标 |
| 链上数据 (以太坊) | 10% | 链上大额转账预警 |

### 4.3 做多策略

#### 4.3.1 强做多条件 (综合得分 ≥ 70)

**必要条件**:
1. 短期趋势向上 (15分钟/1小时级别)
2. MACD金叉或柱状图持续为正
3. RSI在50-70区间 (有上涨空间)
4. Hyperliquid大户净流入明显

**杠杆配置**:
- 保守: 2-3倍
- 平衡: 3-5倍
- 激进: 5-10倍

**止损设置**: 入场价 -3%至-8% (根据杠杆调整)

**止盈设置**: 入场价 +10%至+25% (根据杠杆调整)

#### 4.3.2 普通做多条件 (综合得分 60-70)

**特征**:
- 信号强度中等
- 建议使用低杠杆
- 快速获利了结

**杠杆配置**: 2-3倍
**止损**: -5%
**止盈**: +12%

### 4.4 做空策略

#### 4.4.1 强做空条件 (综合得分 ≤ 30)

**必要条件**:
1. 短期趋势向下
2. MACD死叉或柱状图持续为负
3. RSI在30-50区间 (有下跌空间)
4. Hyperliquid大户净流出明显
5. 资金费率极高 (多头过度拥挤)

**杠杆配置**:
- 保守: 2-3倍
- 平衡: 3-5倍
- 激进: 5-10倍

**止损设置**: 入场价 +3%至+8%

**止盈设置**: 入场价 -10%至-25%

#### 4.4.2 普通做空条件 (综合得分 30-40)

**杠杆配置**: 2-3倍
**止损**: +5%
**止盈**: -12%

### 4.5 合约特殊风控

#### 4.5.1 强制平仓保护

**触发条件**:
- 保证金率 < 20%
- 价格距离爆仓价 < 5%

**操作**: 自动减仓或平仓

#### 4.5.2 资金费率套利

**正向套利** (资金费率 > 0.05%):
- 现货做多 + 合约做空
- 赚取资金费率差价

**反向套利** (资金费率 < -0.05%):
- 现货做空 + 合约做多

---

## 5. 买入信号捕捉

### 5.1 信号级别定义

| 信号级别 | 综合得分 | 置信度 | 建议操作 |
|---------|---------|--------|---------|
| 极强买入 | ≥ 85 | ≥ 85% | 重仓买入 |
| 强买入 | 75-85 | 75-85% | 正常仓位买入 |
| 买入 | 60-75 | 60-75% | 小仓位买入 |
| 观望 | 40-60 | - | 持有或等待 |

### 5.2 实时信号监控

#### 5.2.1 MACD金叉监控

**监控逻辑**:
```
IF (前一根K线: MACD <= Signal) AND (当前K线: MACD > Signal) THEN
    生成金叉信号
    计算其他指标确认
    输出综合评分
END IF
```

**输出信息**:
- 币种
- 时间周期
- 金叉点位
- 综合得分
- 建议操作

#### 5.2.2 RSI超卖反弹监控

**监控逻辑**:
```
IF RSI < 30 THEN
    标记为超卖
    IF RSI开始回升 AND MACD柱状图转正 THEN
        生成买入信号
    END IF
END IF
```

#### 5.2.3 布林带下轨反弹监控

**监控逻辑**:
```
IF 价格 < 布林带下轨 THEN
    IF 成交量放大 AND 价格回到下轨之上 THEN
        生成买入信号
    END IF
END IF
```

#### 5.2.4 聪明钱流入监控

**监控逻辑**:
```
IF Hyperliquid净流入 > 100万美元 THEN
    IF 技术面得分 > 50 THEN
        强化买入信号 (+20分)
    END IF
END IF
```

### 5.3 信号确认机制

**多重确认规则**:
1. 至少3个维度得分 ≥ 60
2. 技术指标无明显背离
3. 成交量配合
4. 新闻面无重大利空

**过滤机制**:
- 过滤震荡市假信号
- 过滤极端行情突发信号
- 过滤成交量异常信号

---

## 6. 卖出信号捕捉

### 6.1 信号级别定义

| 信号级别 | 综合得分 | 置信度 | 建议操作 |
|---------|---------|--------|---------|
| 极强卖出 | ≤ 15 | ≥ 85% | 全部清仓 |
| 强卖出 | 15-25 | 75-85% | 大部分清仓 |
| 卖出 | 25-40 | 60-75% | 部分减仓 |
| 观望 | 40-60 | - | 持有 |

### 6.2 实时信号监控

#### 6.2.1 MACD死叉监控

**监控逻辑**:
```
IF (前一根K线: MACD >= Signal) AND (当前K线: MACD < Signal) THEN
    生成死叉信号
    IF RSI > 70 THEN
        强化卖出信号 (+15分)
    END IF
    输出综合评分
END IF
```

#### 6.2.2 RSI超买回落监控

**监控逻辑**:
```
IF RSI > 70 THEN
    标记为超买
    IF RSI开始回落 AND MACD柱状图转负 THEN
        生成卖出信号
    END IF
END IF
```

#### 6.2.3 EMA死叉监控

**监控逻辑**:
```
IF 短期EMA下穿长期EMA THEN
    生成死叉信号
    IF 成交量放大 THEN
        强化卖出信号 (×1.3)
    END IF
END IF
```

#### 6.2.4 聪明钱流出监控

**监控逻辑**:
```
IF Hyperliquid净流出 > 100万美元 THEN
    IF 技术面得分 < 50 THEN
        强化卖出信号 (+20分)
    END IF
END IF
```

### 6.3 止盈止损信号

#### 6.3.1 动态止盈

**规则**:
1. 盈利 > 15%: 设置追踪止盈 (回撤5%止盈)
2. 盈利 > 25%: 先止盈50%，剩余追踪止盈
3. 盈利 > 50%: 止盈80%，剩余追踪止盈

#### 6.3.2 固定止损

**规则**:
1. 现货: 跌破入场价 -5% 立即止损
2. 合约: 根据杠杆动态调整 (-3%至-8%)
3. 跌破关键支撑位: 立即止损

#### 6.3.3 时间止损

**规则**:
- 持仓超过30天无明显盈利: 考虑止损
- 持仓期间综合得分持续 < 40: 提前止损

---

## 7. 操作建议生成

### 7.1 建议格式

**标准输出格式**:

```
【交易信号】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
币种: BTC/USDT
信号: 强买入 (STRONG LONG)
置信度: 82%
综合评分: 78/100
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【价格信息】
当前价格: $45,250
建议入场: $45,000 - $45,500
止损价位: $42,750 (-5%)
止盈价位: $51,975 (+15%)

【仓位建议】
建议仓位: 60%可用资金
最大杠杆: 2倍 (合约)
预期盈亏比: 1:3

【信号依据】
✅ 技术指标表现优秀 (75分, 权重40%)
  • MACD金叉形成
  • RSI从超卖区域回升至48
  • 价格突破布林带中轨
  • EMA呈多头排列

✅ Hyperliquid聪明钱流入 (85分, 权重20%)
  • 24小时净流入: $2,350,000
  • 活跃钱包数: 18个
  • 大单买入占比: 68%

🟢 新闻情绪良好 (65分, 权重15%)
  • 24小时正面新闻: 8条
  • 情绪指数: +52

🟢 资金费率偏低 (60分, 权重15%)
  • 当前费率: -0.005%
  • 空头过度拥挤，可能反弹

【风险提示】
⚠️ 建议分批建仓，首次30%，回调加仓
⚠️ 严格执行止损，不可抱侥幸心理
💡 本信号仅供参考，不构成投资建议

【操作步骤】
1. 在 $45,000 - $45,500 区间分批买入
2. 设置止损单在 $42,750
3. 设置止盈单在 $51,975 (或追踪止盈)
4. 持续监控，如综合得分跌破50考虑提前离场
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 7.2 建议生成规则

#### 7.2.1 入场价格建议

**计算方法**:
- 当前价 ± ATR × 0.5
- 考虑关键支撑/压力位
- 避开整数关口

#### 7.2.2 止损价格建议

**现货交易**:
```
止损价 = 入场价 × (1 - 止损百分比)
默认止损: -5%
激进止损: -3%
保守止损: -8%
```

**合约交易**:
```
止损价 = 入场价 × (1 - 止损百分比 / 杠杆倍数)
2倍杠杆止损: -5%
5倍杠杆止损: -3%
10倍杠杆止损: -2%
```

#### 7.2.3 止盈价格建议

**固定止盈**:
```
止盈价 = 入场价 × (1 + 止盈百分比)
保守止盈: +10%
平衡止盈: +15%
激进止盈: +25%
```

**追踪止盈**:
```
IF 盈利 > 初始止盈目标 THEN
    止盈价 = 最高价 × (1 - 回撤百分比)
    回撤百分比 = 3-5%
END IF
```

### 7.3 建议推送机制

#### 7.3.1 实时推送

**触发条件**:
- 综合得分变化 ≥ 15分
- MACD金叉/死叉形成
- 价格突破关键位置
- 聪明钱大额流入/流出

**推送方式**:
- Web界面实时刷新
- 系统通知 (可选)
- 记录到信号日志

#### 7.3.2 定时推送

**推送频率**:
- 每小时整点扫描
- 每日8:00/20:00深度分析
- 每周日21:00周报

---

## 8. 定制化用户策略

### 8.1 策略模板

#### 8.1.1 保守型策略 (Conservative)

**适用人群**: 风险厌恶型投资者，追求稳健收益

**配置参数**:

```json
{
  "name": "conservative",
  "description": "保守型投资策略，注重风险控制",

  "dimension_weights": {
    "technical": 45,      // 更重视技术面
    "hyperliquid": 15,
    "news": 20,           // 关注新闻面
    "funding_rate": 15,
    "ethereum": 5
  },

  "risk_profile": {
    "level": "conservative",
    "max_position_size": 10,        // 单笔最大10%
    "stop_loss": 3,                 // 止损3%
    "take_profit": 10,              // 止盈10%
    "min_signal_strength": 75,      // 最低信号强度75
    "allow_short": false,           // 不允许做空
    "max_leverage": 1               // 不使用杠杆
  },

  "trading_rules": {
    "hyperliquid_min_wallets": 5,
    "hyperliquid_min_amount": 100000,
    "hyperliquid_min_net_flow": 200000,
    "min_dimensions_agree": 4       // 至少4个维度同意
  }
}
```

**交易特点**:
- 严格控制仓位
- 快速止损，保护本金
- 只做高确定性机会
- 不使用杠杆

#### 8.1.2 平衡型策略 (Balanced)

**适用人群**: 风险收益平衡型投资者

**配置参数**:

```json
{
  "name": "balanced",
  "description": "平衡型投资策略，风险收益均衡",

  "dimension_weights": {
    "technical": 40,
    "hyperliquid": 20,
    "news": 15,
    "funding_rate": 15,
    "ethereum": 10
  },

  "risk_profile": {
    "level": "balanced",
    "max_position_size": 20,        // 单笔最大20%
    "stop_loss": 5,                 // 止损5%
    "take_profit": 15,              // 止盈15%
    "min_signal_strength": 60,      // 最低信号强度60
    "allow_short": false,
    "max_leverage": 2               // 最大2倍杠杆
  },

  "trading_rules": {
    "hyperliquid_min_wallets": 3,
    "hyperliquid_min_amount": 50000,
    "hyperliquid_min_net_flow": 100000,
    "min_dimensions_agree": 3       // 至少3个维度同意
  }
}
```

**交易特点**:
- 适度仓位
- 合理止损止盈比例
- 可使用小杠杆
- 适合大多数用户

#### 8.1.3 激进型策略 (Aggressive)

**适用人群**: 风险偏好型投资者，追求高收益

**配置参数**:

```json
{
  "name": "aggressive",
  "description": "激进型投资策略，追求高收益",

  "dimension_weights": {
    "technical": 30,
    "hyperliquid": 35,      // 重视聪明钱
    "news": 10,
    "funding_rate": 10,
    "ethereum": 15          // 关注链上数据
  },

  "risk_profile": {
    "level": "aggressive",
    "max_position_size": 30,        // 单笔最大30%
    "stop_loss": 8,                 // 止损8%
    "take_profit": 25,              // 止盈25%
    "min_signal_strength": 50,      // 最低信号强度50
    "allow_short": true,            // 允许做空
    "max_leverage": 5               // 最大5倍杠杆
  },

  "trading_rules": {
    "hyperliquid_min_wallets": 2,
    "hyperliquid_min_amount": 30000,
    "hyperliquid_min_net_flow": 50000,
    "min_dimensions_agree": 2       // 至少2个维度同意
  }
}
```

**交易特点**:
- 大仓位操作
- 允许双向交易
- 使用杠杆放大收益
- 风险较高

### 8.2 自定义策略配置

#### 8.2.1 配置界面需求

**基础信息**:
- 策略名称 (必填)
- 策略描述 (选填)
- 策略标签 (选填)

**维度权重配置** (总和必须为100%):
```
技术指标权重: [滑动条 0-100%] 默认40%
Hyperliquid权重: [滑动条 0-100%] 默认20%
新闻情绪权重: [滑动条 0-100%] 默认15%
资金费率权重: [滑动条 0-100%] 默认15%
以太坊链上权重: [滑动条 0-100%] 默认10%
```

**风险配置**:
```
风险等级: [单选] 保守 / 平衡 / 激进
最大仓位: [输入框 1-100%] 默认20%
止损比例: [输入框 1-50%] 默认5%
止盈比例: [输入框 1-100%] 默认15%
最低信号强度: [滑动条 0-100] 默认60
允许做空: [开关] 默认关闭
最大杠杆: [下拉框 1-10倍] 默认1倍
```

**交易规则**:
```
Hyperliquid最小钱包数: [输入框] 默认3
Hyperliquid最小交易额: [输入框] 默认50000
Hyperliquid最小净流入: [输入框] 默认100000
最少同意维度数: [输入框 1-5] 默认3
```

**技术指标配置** (高级选项):
```
RSI周期: [输入框] 默认14
RSI超买线: [输入框] 默认70
RSI超卖线: [输入框] 默认30

MACD快线: [输入框] 默认12
MACD慢线: [输入框] 默认26
MACD信号线: [输入框] 默认9

EMA短期: [输入框] 默认20
EMA长期: [输入框] 默认50

布林带周期: [输入框] 默认20
布林带标准差: [输入框] 默认2
```

#### 8.2.2 策略管理功能

**功能需求**:
1. 创建新策略
2. 编辑现有策略
3. 复制策略 (基于模板快速创建)
4. 删除策略 (不能删除系统默认策略)
5. 切换激活策略
6. 导出策略 (JSON格式)
7. 导入策略
8. 策略对比 (同时查看多个策略的分析结果)

**界面展示**:
```
┌─────────────────────────────────────────────┐
│ 我的策略                          [+ 新建策略] │
├─────────────────────────────────────────────┤
│                                              │
│ ○ conservative (保守型)            [激活中]   │
│   风险等级: 保守 | 最大仓位: 10%             │
│   [编辑] [复制] [导出]                       │
│                                              │
│ ● balanced (平衡型)               [使用中]   │
│   风险等级: 平衡 | 最大仓位: 20%             │
│   [编辑] [复制] [导出]                       │
│                                              │
│ ○ aggressive (激进型)                        │
│   风险等级: 激进 | 最大仓位: 30%             │
│   [编辑] [复制] [导出]                       │
│                                              │
│ ○ my_custom_strategy (我的自定义)           │
│   风险等级: 自定义 | 最大仓位: 25%           │
│   [编辑] [复制] [导出] [删除]               │
│                                              │
└─────────────────────────────────────────────┘
```

### 8.3 策略回测功能

#### 8.3.1 回测需求

**回测参数**:
- 回测时间段 (开始日期 - 结束日期)
- 回测币种 (单个或多个)
- 初始资金
- 手续费率
- 滑点设置

**回测逻辑**:
1. 加载历史K线数据
2. 计算技术指标
3. 模拟信号生成
4. 执行虚拟交易
5. 记录每笔交易
6. 统计回测结果

**回测报告**:
```
【回测报告】
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
策略名称: balanced
回测周期: 2024-01-01 至 2024-12-31
回测币种: BTC/USDT
初始资金: $10,000

【收益统计】
最终资金: $14,250
总收益: $4,250 (+42.5%)
最大回撤: -15.8%
夏普比率: 1.85
盈亏比: 2.3

【交易统计】
总交易次数: 48
盈利交易: 32 (66.7%)
亏损交易: 16 (33.3%)
平均盈利: +8.2%
平均亏损: -3.5%

【月度收益】
2024-01: +5.2%
2024-02: +3.8%
2024-03: -2.1%
...

【建议】
✅ 该策略在回测期间表现良好
✅ 胜率和盈亏比均符合预期
⚠️ 注意最大回撤控制
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 9. 风险管理

### 9.1 仓位管理

#### 9.1.1 固定比例仓位

**规则**:
- 每笔交易使用固定百分比的资金
- 根据策略配置调整 (10%-30%)
- 不同信号强度使用不同仓位

**示例**:
```
可用资金: $10,000
策略配置最大仓位: 20%

强买入信号: 使用 20% = $2,000
普通买入信号: 使用 12% = $1,200
弱买入信号: 使用 6% = $600
```

#### 9.1.2 凯利公式仓位

**公式**:
```
f* = (bp - q) / b

其中:
f* = 最优仓位比例
b = 盈亏比
p = 胜率
q = 1 - p (败率)
```

**示例**:
```
假设:
胜率 p = 60%
盈亏比 b = 2

f* = (2×0.6 - 0.4) / 2 = 0.4 = 40%

实际使用: 40% × 0.5 (降低风险) = 20%
```

#### 9.1.3 动态仓位调整

**规则**:
- 连续盈利 → 增加仓位 (最多+50%)
- 连续亏损 → 减少仓位 (最多-50%)
- 回撤超过10% → 暂停交易

### 9.2 止损策略

#### 9.2.1 固定百分比止损

**规则**:
```
止损价 = 入场价 × (1 - 止损百分比)

保守策略: -3%
平衡策略: -5%
激进策略: -8%
```

#### 9.2.2 ATR止损

**规则**:
```
止损价 = 入场价 - (ATR × 2)

优点: 根据市场波动性动态调整
```

#### 9.2.3 移动止损

**规则**:
```
当盈利 > 初始止盈目标的50%时:
    止损价 = MAX(原止损价, 当前价 × (1 - 5%))

优点: 保护已有利润
```

### 9.3 止盈策略

#### 9.3.1 固定目标止盈

**规则**:
```
止盈价 = 入场价 × (1 + 止盈百分比)

保守策略: +10%
平衡策略: +15%
激进策略: +25%
```

#### 9.3.2 分批止盈

**规则**:
```
第一目标 (+10%): 止盈 30%
第二目标 (+15%): 止盈 30%
第三目标 (+25%): 止盈 40%
```

#### 9.3.3 追踪止盈

**规则**:
```
当价格达到初始止盈目标后:
    止盈价 = 最高价 × (1 - 回撤百分比)
    回撤百分比 = 3-5%
```

### 9.4 资金管理

#### 9.4.1 总仓位控制

**规则**:
- 现货总仓位不超过80%
- 合约总仓位不超过30%
- 保留至少20%现金

#### 9.4.2 单币种仓位控制

**规则**:
- 单个币种现货仓位不超过30%
- 单个币种合约仓位不超过10%

#### 9.4.3 杠杆使用控制

**规则**:
- 保守策略: 禁用杠杆
- 平衡策略: 最大2倍
- 激进策略: 最大5倍
- 极端行情: 禁用杠杆

---

## 10. 实施计划

### 10.1 开发阶段

#### 阶段一: 核心功能开发 (2周)

**任务**:
- [ ] 完善技术指标计算模块
- [ ] 优化信号生成器
- [ ] 实现买卖信号监控
- [ ] 开发操作建议生成器

**交付物**:
- 技术指标模块
- 信号生成模块
- 实时监控服务

#### 阶段二: 策略系统开发 (2周)

**任务**:
- [ ] 实现策略配置管理
- [ ] 开发三种默认策略
- [ ] 构建自定义策略编辑器
- [ ] 实现策略切换功能

**交付物**:
- 策略管理系统
- 策略配置界面

#### 阶段三: 风控系统开发 (1周)

**任务**:
- [ ] 实现仓位管理
- [ ] 开发止损止盈模块
- [ ] 实现资金管理规则

**交付物**:
- 风险管理模块

#### 阶段四: 回测系统开发 (2周)

**任务**:
- [ ] 开发历史数据回测引擎
- [ ] 实现策略回测报告
- [ ] 集成到Web界面

**交付物**:
- 回测系统
- 回测报告生成器

#### 阶段五: 测试与优化 (1周)

**任务**:
- [ ] 单元测试
- [ ] 集成测试
- [ ] 性能优化
- [ ] 文档完善

### 10.2 部署计划

#### 10.2.1 测试环境部署

**步骤**:
1. 部署到测试服务器
2. 使用历史数据验证
3. 内部用户测试
4. 收集反馈并优化

#### 10.2.2 生产环境部署

**步骤**:
1. 灰度发布 (10%用户)
2. 监控运行状态
3. 逐步扩大到100%
4. 持续监控和优化

### 10.3 后续优化

#### 10.3.1 功能增强

- 机器学习信号优化
- 更多技术指标支持
- 多币种组合策略
- 自动交易执行 (需谨慎)

#### 10.3.2 性能优化

- 实时计算优化
- 数据库查询优化
- 缓存机制改进

#### 10.3.3 用户体验优化

- 界面美化
- 交互优化
- 移动端适配

---

## 附录

### A. 技术指标参考资料

- RSI指标详解: [相对强弱指标](https://www.investopedia.com/terms/r/rsi.asp)
- MACD指标详解: [平滑异同移动平均线](https://www.investopedia.com/terms/m/macd.asp)
- 布林带详解: [布林线指标](https://www.investopedia.com/terms/b/bollingerbands.asp)

### B. 策略配置示例文件

参见:
- `config/strategies/conservative.json`
- `config/strategies/balanced.json`
- `config/strategies/aggressive.json`

### C. API文档

参见:
- `app/api/strategy_api.py` - 策略管理API
- `app/analyzers/signal_generator.py` - 信号生成API
- `app/analyzers/technical_indicators.py` - 技术指标API

### D. 数据库表设计

参见:
- `docs/数据库存储说明.md`

---

## 文档变更记录

| 版本 | 日期 | 作者 | 变更说明 |
|-----|------|------|---------|
| v1.0 | 2025-11-11 | System | 初始版本 |

---

**文档结束**
