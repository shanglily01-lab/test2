# å¿«é€Ÿéƒ¨ç½²æŒ‡å— - å®Œæ•´è‡ªé€‚åº”ç³»ç»Ÿ

## âœ… å·²å®Œæˆçš„å·¥ä½œ

æˆåŠŸè§£å†³äº†æ‚¨æå‡ºçš„ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š

### é—®é¢˜1: é…ç½®æŒä¹…åŒ–é—®é¢˜ âœ… å·²è§£å†³

**ä¹‹å‰**:
- âŒ ä¼˜åŒ–å™¨æ›´æ–°config.yamlé»‘åå•
- âŒ ä½†SmartDecisionBrainä¸è¯»å–é»‘åå•
- âŒ ä¼˜åŒ–æ²¡æœ‰å®é™…æ•ˆæœ

**ç°åœ¨**:
- âœ… SmartDecisionBrainå®Œæ•´è¯»å–é»‘åå•
- âœ… è‡ªåŠ¨è¿‡æ»¤é»‘åå•äº¤æ˜“å¯¹
- âœ… reload_config()è®©ä¼˜åŒ–ç«‹å³ç”Ÿæ•ˆ

### é—®é¢˜2: å‚æ•°è‡ªåŠ¨è°ƒæ•´é—®é¢˜ âœ… å·²è§£å†³

**ä¹‹å‰**:
- âŒ ä¼˜åŒ–å™¨åªç”Ÿæˆå»ºè®®æ–‡æœ¬
- âŒ æ­¢æŸã€æŒä»“æ—¶é—´ç­‰ç¡¬ç¼–ç 
- âŒ æ— æ³•çœŸæ­£åº”ç”¨ä¼˜åŒ–

**ç°åœ¨**:
- âœ… config.yamlæ–°å¢è‡ªé€‚åº”å‚æ•°é…ç½®
- âœ… ä¼˜åŒ–å™¨è‡ªåŠ¨æ›´æ–°è¿™äº›å‚æ•°
- âœ… å¼€ä»“æ—¶è¯»å–å¹¶åº”ç”¨åŠ¨æ€å‚æ•°
- âœ… æœ€å°æŒä»“æ—¶é—´é˜²æ­¢è¿‡æ—©æ­¢æŸ

---

## ğŸš€ ç«‹å³éƒ¨ç½² (3åˆ†é’Ÿ)

### æœåŠ¡å™¨æ“ä½œ

```bash
# 1. SSHç™»å½•
ssh ec2-user@13.212.252.171

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/crypto-analyzer

# 3. æ‹‰å–æœ€æ–°ä»£ç  (2ä¸ªæ–°commit)
git pull origin master

# åº”è¯¥çœ‹åˆ°:
# 2fbf798 feat: é›†æˆè‡ªé€‚åº”ä¼˜åŒ–å™¨åˆ°æ™ºèƒ½äº¤æ˜“æœåŠ¡,å®ç°è‡ªæˆ‘å­¦ä¹ èƒ½åŠ›
# 85f45de feat: å®ç°å®Œæ•´çš„å‚æ•°è‡ªé€‚åº”ç³»ç»Ÿ,è§£å†³é…ç½®æŒä¹…åŒ–å’Œè‡ªåŠ¨è°ƒæ•´é—®é¢˜

# 4. æ£€æŸ¥config.yamlæ˜¯å¦æœ‰æ–°é…ç½®
cat config.yaml | grep -A 15 "adaptive:"

# åº”è¯¥çœ‹åˆ°adaptiveé…ç½®æ®µ

# 5. é‡å¯æœåŠ¡
kill $(pgrep -f smart_trader_service.py)
nohup python3 smart_trader_service.py > logs/smart_trader.log 2>&1 &

# 6. éªŒè¯å¯åŠ¨æˆåŠŸ
tail -50 logs/smart_trader.log
```

### é¢„æœŸæ—¥å¿—è¾“å‡º

```
2026-01-20 XX:XX:XX | INFO     | ============================================================
2026-01-20 XX:XX:XX | INFO     | æ™ºèƒ½è‡ªåŠ¨äº¤æ˜“æœåŠ¡å·²å¯åŠ¨
2026-01-20 XX:XX:XX | INFO     | è´¦æˆ·ID: 2
2026-01-20 XX:XX:XX | INFO     | ä»“ä½: $400 | æ æ†: 5x | æœ€å¤§æŒä»“: 999
2026-01-20 XX:XX:XX | INFO     | âœ… ä»config.yamlåŠ è½½é…ç½®:
2026-01-20 XX:XX:XX | INFO     |    æ€»äº¤æ˜“å¯¹: 50
2026-01-20 XX:XX:XX | INFO     |    é»‘åå•: 5 ä¸ª
2026-01-20 XX:XX:XX | INFO     |    å¯äº¤æ˜“: 45 ä¸ª
2026-01-20 XX:XX:XX | INFO     |    ğŸ“Š è‡ªé€‚åº”å‚æ•°:
2026-01-20 XX:XX:XX | INFO     |       LONGæ­¢æŸ: 3.0%, æ­¢ç›ˆ: 2.0%, æœ€å°æŒä»“: 60åˆ†é’Ÿ
2026-01-20 XX:XX:XX | INFO     |       SHORTæ­¢æŸ: 3.0%, æ­¢ç›ˆ: 2.0%, æœ€å°æŒä»“: 60åˆ†é’Ÿ
2026-01-20 XX:XX:XX | INFO     |    ğŸš« é»‘åå•äº¤æ˜“å¯¹: IP/USDT, VIRTUAL/USDT, LDO/USDT, ATOM/USDT, ADA/USDT
2026-01-20 XX:XX:XX | INFO     | ç™½åå•: 45ä¸ªå¸ç§ | æ‰«æé—´éš”: 300ç§’
2026-01-20 XX:XX:XX | INFO     | ğŸ§  è‡ªé€‚åº”ä¼˜åŒ–å™¨å·²å¯ç”¨ (æ¯æ—¥å‡Œæ™¨2ç‚¹è‡ªåŠ¨è¿è¡Œ)
2026-01-20 XX:XX:XX | INFO     | ============================================================
```

**å…³é”®æ£€æŸ¥ç‚¹**:
- âœ… çœ‹åˆ°"ä»config.yamlåŠ è½½é…ç½®"
- âœ… çœ‹åˆ°"é»‘åå•: 5 ä¸ª"
- âœ… çœ‹åˆ°"ğŸ“Š è‡ªé€‚åº”å‚æ•°"
- âœ… çœ‹åˆ°"ğŸ§  è‡ªé€‚åº”ä¼˜åŒ–å™¨å·²å¯ç”¨"

---

## ğŸ“Š å…³é”®å˜åŒ–æ€»ç»“

### 1. é»‘åå•ç”Ÿæ•ˆ

**ä¹‹å‰**:
```python
# SmartDecisionBrainä¸è¯»å–é»‘åå•
self.whitelist = config.get('symbols', [])  # åŒ…å«æ‰€æœ‰äº¤æ˜“å¯¹
```

**ç°åœ¨**:
```python
# è‡ªåŠ¨è¿‡æ»¤é»‘åå•
all_symbols = config.get('symbols', [])
self.blacklist = config.get('signals', {}).get('blacklist', [])
self.whitelist = [s for s in all_symbols if s not in self.blacklist]  # âœ… è¿‡æ»¤äº†
```

**éªŒè¯**:
```bash
# æ£€æŸ¥é»‘åå•äº¤æ˜“å¯¹æ˜¯å¦è¿˜æœ‰æ–°è®¢å•
mysql -h localhost -u admin -p'Tonny@1000' -D binance-data -e "
SELECT symbol, COUNT(*)
FROM futures_positions
WHERE symbol IN ('IP/USDT', 'VIRTUAL/USDT', 'LDO/USDT', 'ATOM/USDT', 'ADA/USDT')
AND status = 'open'
AND open_time > NOW() - INTERVAL 1 HOUR
GROUP BY symbol;
"
```

**é¢„æœŸç»“æœ**: æ— è®°å½•ï¼ˆé»‘åå•ç”Ÿæ•ˆï¼‰

### 2. åŠ¨æ€å‚æ•°åº”ç”¨

**ä¹‹å‰**:
```python
# ç¡¬ç¼–ç 
stop_loss = current_price * 0.97   # å›ºå®š3%
margin = self.position_size_usdt    # å›ºå®š$400
# æ— æœ€å°æŒä»“æ—¶é—´
```

**ç°åœ¨**:
```python
# ä»config.yamlè¯»å–
stop_loss_pct = self.brain.adaptive_long['stop_loss_pct']  # å¯èƒ½æ˜¯4%
position_multiplier = self.brain.adaptive_long['position_size_multiplier']  # å¯èƒ½æ˜¯0.5
min_holding = self.brain.adaptive_long['min_holding_minutes']  # å¯èƒ½æ˜¯120åˆ†é’Ÿ

stop_loss = current_price * (1 - stop_loss_pct)  # åŠ¨æ€
adjusted_position_size = self.position_size_usdt * position_multiplier  # åŠ¨æ€

# æŒä»“æ£€æŸ¥
if holding_minutes < min_holding:
    # è·³è¿‡æ­¢æŸ
    continue
```

**è§‚å¯Ÿä¸‹ä¸€ç¬”è®¢å•æ—¥å¿—**:
```
[SUCCESS] BTC/USDT LONGå¼€ä»“æˆåŠŸ |
   æ­¢æŸ: $96000.00 (-3.0%) | æ­¢ç›ˆ: $102000.00 (+2.0%) | ä»“ä½: $400 (x1.0)
```

å‚æ•°è§£é‡Šï¼š
- `-3.0%` = å½“å‰æ­¢æŸç™¾åˆ†æ¯”ï¼ˆåˆå§‹å€¼ï¼‰
- `x1.0` = å½“å‰ä»“ä½å€æ•°ï¼ˆåˆå§‹å€¼ï¼‰

### 3. è‡ªåŠ¨ä¼˜åŒ–æµç¨‹

**å‡Œæ™¨2ç‚¹ä¼šå‘ç”Ÿä»€ä¹ˆ**:

```
â° 02:00:00 | è§¦å‘æ¯æ—¥è‡ªé€‚åº”ä¼˜åŒ–
   â†“
ğŸ“Š 02:00:05 | åˆ†æè¿‡å»24å°æ—¶æ•°æ®
   â†“
ğŸ” 02:00:10 | å‘ç°é—®é¢˜:
                - SMART_BRAIN_20 LONG äºæŸ$-1026.91
                - å¹³å‡æŒä»“24åˆ†é’Ÿ (å¤ªçŸ­)
                - èƒœç‡8.3% (å¤ªä½)
   â†“
âš™ï¸  02:00:15 | è‡ªåŠ¨è°ƒæ•´å‚æ•°:
                âœ… LONGæœ€å°æŒä»“æ—¶é—´: 60åˆ†é’Ÿ â†’ 120åˆ†é’Ÿ
                âœ… LONGæ­¢æŸ: 3.0% â†’ 4.0%
                âœ… LONGä»“ä½å€æ•°: 1.0 â†’ 0.5
   â†“
ğŸ’¾ 02:00:20 | æ›´æ–°config.yaml
   â†“
ğŸ”„ 02:00:25 | reload_config() é‡æ–°åŠ è½½
   â†“
âœ… 02:00:30 | ä¼˜åŒ–å®Œæˆï¼Œæ–°å‚æ•°å·²ç”Ÿæ•ˆ
   â†“
ğŸ“ 02:05:00 | ä¸‹ä¸€ç¬”LONGè®¢å•ä½¿ç”¨æ–°å‚æ•°:
                - æ­¢æŸ4%
                - ä»“ä½$200
                - æœ€å°æŒä»“120åˆ†é’Ÿ
```

---

## ğŸ” éªŒè¯ä¼˜åŒ–æ•ˆæœ

### æ–¹æ³•1: æŸ¥çœ‹æ¬¡æ—¥å‡Œæ™¨2ç‚¹æ—¥å¿—

```bash
# æ¬¡æ—¥å‡Œæ™¨2ç‚¹åæ£€æŸ¥
grep -A 50 "è§¦å‘æ¯æ—¥è‡ªé€‚åº”ä¼˜åŒ–" logs/smart_trader_2026-01-*.log
```

**é¢„æœŸè¾“å‡ºç¤ºä¾‹**:
```
â° è§¦å‘æ¯æ—¥è‡ªé€‚åº”ä¼˜åŒ– (æ—¶é—´: 2026-01-21 02:00:00)
================================================================================
ğŸ§  å¼€å§‹è¿è¡Œè‡ªé€‚åº”ä¼˜åŒ–...
================================================================================
ğŸ“Š å¼€å§‹åˆ†ææœ€è¿‘24å°æ—¶çš„äº¤æ˜“è¡¨ç°...

[ä¼˜åŒ–æŠ¥å‘Šå†…å®¹]

âœ… è‡ªåŠ¨è°ƒæ•´ 3 ä¸ªå‚æ•°
   ğŸ“Š LONGæœ€å°æŒä»“æ—¶é—´: 60åˆ†é’Ÿ â†’ 120åˆ†é’Ÿ
   ğŸ“Š LONGæ­¢æŸ: 3.0% â†’ 4.0%
   ğŸ“Š LONGä»“ä½å€æ•°: 1.0 â†’ 0.5

ğŸ”„ é…ç½®å·²é‡æ–°åŠ è½½ï¼Œå½“å‰å¯äº¤æ˜“: 43 ä¸ªå¸ç§
```

### æ–¹æ³•2: æ£€æŸ¥config.yamlå˜åŒ–

```bash
# æŸ¥çœ‹ä¼˜åŒ–åçš„config.yaml
cat config.yaml | grep -A 15 "adaptive:"
```

**åˆå§‹çŠ¶æ€**:
```yaml
adaptive:
  long:
    stop_loss_pct: 0.03          # 3%
    min_holding_minutes: 60      # 60åˆ†é’Ÿ
    position_size_multiplier: 1.0 # æ­£å¸¸ä»“ä½
```

**ä¼˜åŒ–å** (å¦‚æœè§¦å‘):
```yaml
adaptive:
  long:
    stop_loss_pct: 0.04           # 4% â† å·²è°ƒæ•´
    min_holding_minutes: 120      # 120åˆ†é’Ÿ â† å·²è°ƒæ•´
    position_size_multiplier: 0.5  # 50%ä»“ä½ â† å·²è°ƒæ•´
```

### æ–¹æ³•3: è§‚å¯Ÿæ–°è®¢å•å‚æ•°

```bash
# æŸ¥çœ‹æœ€æ–°çš„LONGè®¢å•å¼€ä»“æ—¥å¿—
tail -1000 logs/smart_trader.log | grep "LONGå¼€ä»“æˆåŠŸ"
```

**ä¼˜åŒ–å‰**:
```
[SUCCESS] BTC/USDT LONGå¼€ä»“æˆåŠŸ | æ­¢æŸ: $97000.00 (-3.0%) | ... | ä»“ä½: $400 (x1.0)
```

**ä¼˜åŒ–å**:
```
[SUCCESS] ETH/USDT LONGå¼€ä»“æˆåŠŸ | æ­¢æŸ: $3840.00 (-4.0%) | ... | ä»“ä½: $200 (x0.5)
```

### æ–¹æ³•4: æ•°æ®åº“æŸ¥è¯¢éªŒè¯

```bash
# æŸ¥çœ‹æœ€è¿‘LONGè®¢å•çš„å¹³å‡æŒä»“æ—¶é—´
mysql -h localhost -u admin -p'Tonny@1000' -D binance-data -e "
SELECT
    position_side,
    COUNT(*) as orders,
    AVG(TIMESTAMPDIFF(MINUTE, open_time, close_time)) as avg_hold_minutes,
    AVG(realized_pnl) as avg_pnl
FROM futures_positions
WHERE status = 'closed'
AND close_time > NOW() - INTERVAL 24 HOUR
GROUP BY position_side;
"
```

**ç›®æ ‡**:
- LONGå¹³å‡æŒä»“æ—¶é—´ä»24åˆ†é’Ÿæå‡åˆ°120+åˆ†é’Ÿ
- LONGå¹³å‡ç›ˆäºä»è´Ÿæ•°è½¬ä¸ºæ­£æ•°

---

## ğŸ“ˆ é¢„æœŸæ”¹å–„æ•ˆæœ

### ç¬¬1å¤© (éƒ¨ç½²å)
- âœ… é»‘åå•ç«‹å³ç”Ÿæ•ˆï¼Œ5ä¸ªäºæŸäº¤æ˜“å¯¹ä¸å†å¼€ä»“
- âœ… ä½¿ç”¨åˆå§‹å‚æ•°ï¼ˆ3%æ­¢æŸï¼Œ60åˆ†é’Ÿæœ€å°æŒä»“ï¼‰
- âœ… é¢„æœŸå‡€åˆ©æ¶¦æå‡30%-50%ï¼ˆä»…é»‘åå•æ•ˆæœï¼‰

### ç¬¬2å¤© (é¦–æ¬¡ä¼˜åŒ–å)
- âœ… å‡Œæ™¨2ç‚¹è‡ªåŠ¨ä¼˜åŒ–
- âœ… LONGå‚æ•°è°ƒæ•´ï¼ˆ4%æ­¢æŸï¼Œ120åˆ†é’Ÿæœ€å°æŒä»“ï¼Œ50%ä»“ä½ï¼‰
- âœ… é¢„æœŸLONGèƒœç‡æå‡ï¼ŒäºæŸå‡å°‘

### ç¬¬3-7å¤© (æŒç»­ä¼˜åŒ–)
- âœ… æ¯æ—¥è‡ªåŠ¨ä¼˜åŒ–
- âœ… å‚æ•°é€æ­¥è¶‹äºæœ€ä¼˜
- âœ… é¢„æœŸç›ˆåˆ©å› å­ä»1.47æå‡åˆ°2.0+

### ç¬¬8-30å¤© (ç¨³å®šè¿è¡Œ)
- âœ… å‚æ•°è¶‹äºç¨³å®š
- âœ… ç³»ç»Ÿè¾¾åˆ°æœ€ä¼˜çŠ¶æ€
- âœ… ROIæ˜¾è‘—æå‡

---

## âš ï¸ é‡è¦æé†’

### 1. é¦–æ¬¡è¿è¡Œå»ºè®®

```bash
# å¦‚æœæƒ³ç«‹å³æµ‹è¯•ä¼˜åŒ–å™¨ï¼Œä¸ç­‰å‡Œæ™¨2ç‚¹
python3 test_optimizer.py

# æŸ¥çœ‹æŠ¥å‘Šï¼Œä½†ä¸è¦è‡ªåŠ¨åº”ç”¨ï¼ˆè§‚å¯Ÿå»ºè®®æ˜¯å¦åˆç†ï¼‰
```

### 2. ç›‘æ§è¦ç‚¹

**æ¯å¤©æ£€æŸ¥**:
- [ ] é»‘åå•æ˜¯å¦ç”Ÿæ•ˆï¼ˆæ— æ–°è®¢å•ï¼‰
- [ ] è‡ªé€‚åº”å‚æ•°æ˜¯å¦æ›´æ–°
- [ ] LONGå¹³å‡æŒä»“æ—¶é—´æ˜¯å¦å»¶é•¿

**æ¯å‘¨æ£€æŸ¥**:
- [ ] config.yamlå‚æ•°å˜åŒ–è®°å½•
- [ ] ä¼˜åŒ–å‰åç›ˆäºå¯¹æ¯”
- [ ] èƒœç‡ã€ç›ˆåˆ©å› å­å˜åŒ–

### 3. æ‰‹åŠ¨è°ƒæ•´

å¦‚æœä¼˜åŒ–å™¨è°ƒæ•´ä¸åˆç†ï¼Œå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ï¼š

```bash
# ç¼–è¾‘config.yaml
nano config.yaml

# ä¿®æ”¹adaptiveå‚æ•°
# é‡å¯æœåŠ¡åº”ç”¨æ–°å‚æ•°
kill $(pgrep -f smart_trader_service.py)
nohup python3 smart_trader_service.py > logs/smart_trader.log 2>&1 &
```

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- **å®Œæ•´è¯´æ˜**: [ADAPTIVE_SYSTEM_EXPLAINED.md](ADAPTIVE_SYSTEM_EXPLAINED.md) - ç³»ç»ŸåŸç†è¯¦è§£
- **ä½¿ç”¨æŒ‡å—**: [ADAPTIVE_OPTIMIZATION_GUIDE.md](ADAPTIVE_OPTIMIZATION_GUIDE.md) - ä¼˜åŒ–å™¨ä½¿ç”¨æ–¹æ³•
- **é›†æˆæ–‡æ¡£**: [SELF_LEARNING_INTEGRATION.md](SELF_LEARNING_INTEGRATION.md) - æŠ€æœ¯å®ç°ç»†èŠ‚
- **é»‘åå•è®°å½•**: [BLACKLIST_UPDATE_2026-01-20.md](BLACKLIST_UPDATE_2026-01-20.md) - é¦–æ¬¡é»‘åå•

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ—¥å¿—æ²¡æœ‰"ä»config.yamlåŠ è½½é…ç½®"

**åŸå› **: ä»£ç æœªæ›´æ–°
**è§£å†³**:
```bash
git pull origin master
git log --oneline -5  # åº”è¯¥çœ‹åˆ°commit 85f45de
```

### é—®é¢˜2: é»‘åå•æ²¡æœ‰ç”Ÿæ•ˆ

**æ£€æŸ¥1**: config.yamlæ˜¯å¦æœ‰é»‘åå•
```bash
cat config.yaml | grep -A 10 blacklist
```

**æ£€æŸ¥2**: æ˜¯å¦é‡å¯äº†æœåŠ¡
```bash
ps aux | grep smart_trader
```

**æ£€æŸ¥3**: æ—¥å¿—æ˜¯å¦æ˜¾ç¤ºé»‘åå•åŠ è½½
```bash
tail -100 logs/smart_trader.log | grep "é»‘åå•"
```

### é—®é¢˜3: å‚æ•°æ²¡æœ‰è‡ªåŠ¨è°ƒæ•´

**å¯èƒ½åŸå› **:
1. è¿˜æœªåˆ°å‡Œæ™¨2ç‚¹
2. æ•°æ®ä¸è¶³ï¼ˆéœ€è¦è‡³å°‘5ç¬”è®¢å•ï¼‰
3. æœªè¾¾åˆ°é«˜ä¸¥é‡æ€§é˜ˆå€¼ï¼ˆäºæŸ<$500ï¼‰

**æ‰‹åŠ¨æµ‹è¯•**:
```bash
python3 test_optimizer.py
```

---

**éƒ¨ç½²æ—¶é—´**: 2026-01-20
**æœ€æ–°Commit**: 85f45de
**çŠ¶æ€**: âœ… å‡†å¤‡å°±ç»ªï¼Œç«‹å³å¯ç”¨
**é¦–æ¬¡ä¼˜åŒ–**: æ˜æ—¥å‡Œæ™¨2ç‚¹è‡ªåŠ¨è¿è¡Œ
