# è¶…çº§å¤§è„‘è‡ªæˆ‘ä¼˜åŒ–æœºåˆ¶è¯¦è§£

## æ¦‚è¿°

è¶…çº§å¤§è„‘é€šè¿‡**è‡ªé€‚åº”ä¼˜åŒ–å™¨**ï¼ˆ`AdaptiveOptimizer`ï¼‰å®ç°è‡ªæˆ‘å­¦ä¹ å’ŒæŒç»­æ”¹è¿›ï¼ŒåŸºäºå®ç›˜äº¤æ˜“è¡¨ç°åŠ¨æ€è°ƒæ•´ç­–ç•¥ã€äº¤æ˜“å¯¹å’Œä¿¡å·æƒé‡ã€‚

---

## æ ¸å¿ƒç»„ä»¶

### 1. è‡ªé€‚åº”ä¼˜åŒ–å™¨ (AdaptiveOptimizer)
**æ–‡ä»¶**: [app/services/adaptive_optimizer.py](app/services/adaptive_optimizer.py)

**åŠŸèƒ½**:
- åˆ†æå†å²äº¤æ˜“è¡¨ç°
- è¯†åˆ«è¡¨ç°ä¸ä½³çš„äº¤æ˜“å¯¹å’Œä¿¡å·
- è‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–å»ºè®®
- åŠ¨æ€æ›´æ–°é»‘åå•ã€å‚æ•°å’Œæƒé‡

### 2. è¯„åˆ†æƒé‡ä¼˜åŒ–å™¨ (ScoringWeightOptimizer)
**æ–‡ä»¶**: [app/services/scoring_weight_optimizer.py](app/services/scoring_weight_optimizer.py)

**åŠŸèƒ½**:
- åˆ†æä¸åŒä¿¡å·ç»„åˆçš„è¡¨ç°
- ä¼˜åŒ–ä¿¡å·è¯„åˆ†æƒé‡
- è°ƒæ•´å¼€ä»“é˜ˆå€¼

### 3. æ™ºèƒ½å†³ç­–å¤§è„‘ (SmartDecisionBrain)
**æ–‡ä»¶**: [app/services/smart_decision_brain.py](app/services/smart_decision_brain.py)

**åŠŸèƒ½**:
- ç»´æŠ¤é»‘åå•å’Œç™½åå•
- åŸºäºKçº¿å¤šç»´åº¦åˆ†æ
- è®¡ç®—äº¤æ˜“è¯„åˆ†

---

## ä¼˜åŒ–ç»´åº¦

### ğŸ“Š 1. äº¤æ˜“å¯¹ä¼˜åŒ–

#### é»‘åå•æœºåˆ¶

**è§¦å‘æ¡ä»¶**:
```python
thresholds = {
    'blacklist_loss_threshold': -20,      # äºæŸè¶…è¿‡20 USDT
    'blacklist_win_rate_threshold': 0.1,  # èƒœç‡ä½äº10%
    'min_orders_for_analysis': 5          # æœ€å°‘5ç¬”è®¢å•
}
```

**ç™½åå•ä¿æŠ¤**:
```python
# å››å¤§å¤©ç‹æ°¸ä¸æ‹‰é»‘
BLACKLIST_WHITELIST = {
    'BTC/USDT',
    'ETH/USDT',
    'SOL/USDT',
    'BNB/USDT'
}
```

**å®é™…æ¡ˆä¾‹**ï¼ˆæ¥è‡ªä»£ç æ³¨é‡Šï¼‰:
```python
blacklist = [
    'IP/USDT',        # äºæŸ $79.34 (2ç¬”è®¢å•, 0%èƒœç‡)
    'VIRTUAL/USDT',   # äºæŸ $35.65 (4ç¬”è®¢å•, 0%èƒœç‡)
    'LDO/USDT',       # äºæŸ $35.88 (5ç¬”è®¢å•, 0%èƒœç‡)
    'ATOM/USDT',      # äºæŸ $27.56 (5ç¬”è®¢å•, 20%èƒœç‡)
    'ADA/USDT',       # äºæŸ $22.87 (6ç¬”è®¢å•, 0%èƒœç‡)
]
```

**ä¼˜åŒ–æµç¨‹**:
```
äº¤æ˜“æ‰§è¡Œ â†’ è®°å½•åˆ°futures_positionsè¡¨
    â†“
æ¯24å°æ—¶åˆ†æ
    â†“
è®¡ç®—æ¯ä¸ªäº¤æ˜“å¯¹çš„:
  - æ€»ç›ˆäº
  - èƒœç‡
  - è®¢å•æ•°é‡
    â†“
ç¬¦åˆé»‘åå•æ¡ä»¶? â†’ YES â†’ æ›´æ–°trading_symbol_ratingè¡¨
    â”‚
    â”œâ”€ é¦–æ¬¡è§¦å‘ â†’ rating_level = 1 (è­¦å‘Š)
    â”œâ”€ äºŒæ¬¡è§¦å‘ â†’ rating_level = 2 (é™åˆ¶)
    â””â”€ æŒç»­å·® â†’ rating_level = 3 (æ°¸ä¹…ç¦æ­¢)
    â†“
NO â†’ ä¿ç•™åœ¨ç™½åå• (rating_level = 0)
```

**é»‘åå•ç­‰çº§æå‡é€»è¾‘**:
```python
# æ£€æŸ¥ç°æœ‰è®°å½•
existing = db.query("SELECT rating_level FROM trading_symbol_rating WHERE symbol = ?")

if existing:
    # å·²å­˜åœ¨è®°å½•ï¼Œæå‡ç­‰çº§
    current_level = existing['rating_level']
    new_level = min(current_level + 1, 2)  # æœ€é«˜2çº§

    db.update("""
        UPDATE trading_symbol_rating
        SET rating_level = new_level,
            total_loss_amount = total_loss_amount + abs(new_loss),
            previous_level = current_level,
            level_changed_at = NOW()
        WHERE symbol = ?
    """)
else:
    # é¦–æ¬¡åŠ å…¥é»‘åå•ï¼Œç­‰çº§1
    db.insert("""
        INSERT INTO trading_symbol_rating
        (symbol, rating_level, reason, ...)
        VALUES (?, 1, ?, ...)
    """)
```

**ç­‰çº§å¯¹åº”çš„é™åˆ¶**:
```python
# åœ¨å¼€ä»“é€»è¾‘ä¸­æ£€æŸ¥
rating = get_symbol_rating(symbol)

if rating['rating_level'] == 1:
    # è­¦å‘Šçº§åˆ«ï¼šé™ä½ä»“ä½50%
    position_size *= 0.5
    logger.warning(f"{symbol} é»‘åå•L1ï¼Œä»“ä½å‡åŠ")

elif rating['rating_level'] == 2:
    # é™åˆ¶çº§åˆ«ï¼šé™ä½ä»“ä½75%æˆ–è·³è¿‡
    position_size *= 0.25
    logger.warning(f"{symbol} é»‘åå•L2ï¼Œä»“ä½å¤§å¹…é™ä½")

elif rating['rating_level'] >= 3:
    # æ°¸ä¹…ç¦æ­¢ï¼šç›´æ¥è·³è¿‡
    logger.error(f"{symbol} é»‘åå•L3ï¼Œç¦æ­¢å¼€ä»“")
    return False
```

#### ç™½åå•æœºåˆ¶

**åªåšLONGæ–¹å‘çš„äº¤æ˜“å¯¹**ï¼ˆåŸºäºå›æµ‹æ•°æ®ï¼‰:
```python
whitelist_long = [
    'BCH/USDT',    # 4ç¬” +1.28%, 100%èƒœç‡
    'ENA/USDT',    # 3ç¬” +1.26%, 100%èƒœç‡
    'WIF/USDT',    # 3ç¬” +0.84%, 100%èƒœç‡
    'TAO/USDT',    # 3ç¬” +0.80%, 100%èƒœç‡
    'DASH/USDT',   # 1ç¬” +2.10%
    'ETC/USDT',    # 2ç¬” +1.36%, 100%èƒœç‡
    # ... æ›´å¤šé«˜èƒœç‡å¸ç§
]
```

**ç‰¹ç‚¹**:
- åªåšå¤šï¼Œä¸åšç©º
- åŸºäºå†å²èƒœç‡å’Œæ”¶ç›Šç‡ç­›é€‰
- åŠ¨æ€æ›´æ–°ï¼ˆè¡¨ç°å·®çš„ä¼šè¢«ç§»é™¤ï¼‰

---

### ğŸ¯ 2. ä¿¡å·ä¼˜åŒ–

#### ä¿¡å·è¡¨ç°åˆ†æ

**SQLæŸ¥è¯¢**:
```sql
SELECT
    entry_signal_type,           -- ä¿¡å·ç±»å‹ï¼ˆå¦‚ TREND_FORWARD_LONG_35ï¼‰
    position_side,               -- æ–¹å‘ï¼ˆLONG/SHORTï¼‰
    COUNT(*) as order_count,     -- è®¢å•æ•°é‡
    SUM(realized_pnl) as total_pnl,  -- æ€»ç›ˆäº
    AVG(realized_pnl) as avg_pnl,    -- å¹³å‡ç›ˆäº
    AVG(hold_minutes) as avg_hold_minutes  -- å¹³å‡æŒä»“æ—¶é—´
FROM futures_positions
WHERE status = 'closed' AND close_time >= æœ€è¿‘24å°æ—¶
GROUP BY entry_signal_type, position_side
HAVING order_count >= 5
```

#### é—®é¢˜ä¿¡å·è¯†åˆ«

**è§¦å‘æ¡ä»¶**:
```python
thresholds = {
    'signal_direction_loss_threshold': -100  # ä¿¡å·+æ–¹å‘äºæŸè¶…è¿‡100 USDT
}
```

**ç”Ÿæˆä¼˜åŒ–å»ºè®®**:
```python
def _generate_recommendation(signal_type, direction, total_pnl, win_rate, avg_hold_minutes):
    # åšå¤šç‰¹æ®Šä¼˜åŒ–
    if direction == 'LONG':
        if avg_hold_minutes < 90:
            return "å¢åŠ æœ€å°æŒä»“æ—¶é—´åˆ°120åˆ†é’Ÿ"

        if win_rate < 0.15:
            return "æ”¾å®½æ­¢æŸåˆ°4%"

        if total_pnl < -500:
            return "é™ä½ä»“ä½åˆ°50%æˆ–æš‚æ—¶ç¦ç”¨"

    # åšç©ºä¼˜åŒ–
    elif direction == 'SHORT':
        if total_pnl < -100:
            return "æ£€æŸ¥ä¿¡å·é€»è¾‘,å¯èƒ½éœ€è¦è°ƒæ•´é˜ˆå€¼"

    # ä¿¡å·åˆ†æ•°ç›¸å…³
    score = int(signal_type.split('_')[-1])  # æå–è¯„åˆ†
    if score >= 40 and total_pnl < -200:
        return f"é™ä½{score}åˆ†ä¿¡å·çš„æƒé‡"
```

---

### âš–ï¸ 3. è¯„åˆ†æƒé‡ä¼˜åŒ–

#### ä¿¡å·ç»„ä»¶åˆ†æ

**è·Ÿè¸ªçš„ä¿¡å·ç»„ä»¶**:
```python
signal_components = {
    'position_shift': 'ä½ç½®åç§»',      # ä»·æ ¼ç›¸å¯¹æ”¯æ’‘ä½çš„åç§»
    'volume_confirm': 'æˆäº¤é‡ç¡®è®¤',    # æˆäº¤é‡æ˜¯å¦æ”¾å¤§
    'macd_confirm': 'MACDç¡®è®¤',        # MACDæ˜¯å¦é‡‘å‰/æ­»å‰
    'rsi_oversold': 'RSIè¶…å–',         # RSIæ˜¯å¦è¶…å–(<30)
    'rsi_overbought': 'RSIè¶…ä¹°',       # RSIæ˜¯å¦è¶…ä¹°(>70)
    'trend_strength': 'è¶‹åŠ¿å¼ºåº¦',      # è¶‹åŠ¿å¼ºå¼±
    # ... æ›´å¤šç»„ä»¶
}
```

#### æƒé‡è°ƒæ•´é€»è¾‘

**ç›®æ ‡**: è®©è¡¨ç°å¥½çš„ä¿¡å·ç»„ä»¶è·å¾—æ›´é«˜æƒé‡

**æµç¨‹**:
```
1. ç»Ÿè®¡æ¯ä¸ªä¿¡å·ç»„ä»¶çš„è¡¨ç°:
   SELECT signal_components, AVG(realized_pnl), COUNT(*)
   FROM futures_positions
   WHERE signal_components LIKE '%position_shift%'

2. è®¡ç®—ç»„ä»¶çš„è´¡çŒ®åº¦:
   contribution = (å¹³å‡ç›ˆäº Ã— è®¢å•æ•°é‡) / æ€»è®¢å•æ•°

3. è°ƒæ•´æƒé‡:
   new_weight = old_weight Ã— (1 + contribution_rate)

4. æ›´æ–°åˆ°æ•°æ®åº“:
   UPDATE signal_weights SET weight = new_weight
   WHERE component = 'position_shift'
```

**ç¤ºä¾‹**:
```python
# å‡è®¾ position_shift ç»„ä»¶è¡¨ç°è‰¯å¥½
old_weight = 10
avg_pnl = 5.2 USDT  # å¹³å‡ç›ˆåˆ©5.2U
contribution_rate = 0.15  # è´¡çŒ®ç‡15%

new_weight = 10 Ã— (1 + 0.15) = 11.5
```

---

### ğŸšï¸ 4. ç­–ç•¥å‚æ•°ä¼˜åŒ–

#### åŠ¨æ€è°ƒæ•´çš„å‚æ•°

**æ­¢æŸå‚æ•°**:
```python
# åšå¤šæ­¢æŸç‰¹æ®Šå¤„ç†
if direction == 'LONG' and win_rate < 0.15:
    stop_loss_pct = 4.0  # ä»2%æ”¾å®½åˆ°4%
    logger.info(f"åšå¤šèƒœç‡ä½ï¼Œæ”¾å®½æ­¢æŸåˆ°{stop_loss_pct}%")
```

**æŒä»“æ—¶é—´**:
```python
# åšå¤šæœ€å°æŒä»“æ—¶é—´
if direction == 'LONG' and avg_hold_minutes < 90:
    min_holding_time = 120  # å¢åŠ åˆ°120åˆ†é’Ÿ
    logger.info(f"åšå¤šæŒä»“æ—¶é—´çŸ­ï¼Œå¢åŠ åˆ°{min_holding_time}åˆ†é’Ÿ")
```

**å¼€ä»“é˜ˆå€¼**:
```python
# å†³ç­–é˜ˆå€¼åŠ¨æ€è°ƒæ•´
threshold = 30  # åŸºç¡€é˜ˆå€¼30åˆ†

# å¦‚æœæŸä¸ªè¯„åˆ†æ®µè¡¨ç°å·®ï¼Œæé«˜é˜ˆå€¼
if score_30_40_total_pnl < -200:
    threshold = 40  # æé«˜åˆ°40åˆ†
```

---

## ä¼˜åŒ–æ‰§è¡Œæµç¨‹

### è‡ªåŠ¨ä¼˜åŒ–å‘¨æœŸ

```
ç³»ç»Ÿå¯åŠ¨
    â†“
æ¯24å°æ—¶è§¦å‘ä¸€æ¬¡
    â†“
1. åˆ†ææœ€è¿‘24å°æ—¶äº¤æ˜“è¡¨ç°
   - æŒ‰äº¤æ˜“å¯¹ç»Ÿè®¡
   - æŒ‰ä¿¡å·ç±»å‹ç»Ÿè®¡
   - æŒ‰ä¿¡å·ç»„ä»¶ç»Ÿè®¡
    â†“
2. è¯†åˆ«é—®é¢˜
   - é»‘åå•å€™é€‰
   - é—®é¢˜ä¿¡å·
   - ä½æ•ˆç»„ä»¶
    â†“
3. ç”Ÿæˆä¼˜åŒ–æŠ¥å‘Š
   - å»ºè®®åŠ å…¥é»‘åå•çš„äº¤æ˜“å¯¹
   - å»ºè®®è°ƒæ•´çš„ä¿¡å·æƒé‡
   - å»ºè®®ä¿®æ”¹çš„å‚æ•°
    â†“
4. åº”ç”¨ä¼˜åŒ–ï¼ˆå¦‚æœauto_apply=Trueï¼‰
   - æ›´æ–°trading_symbol_ratingè¡¨ï¼ˆé»‘åå•ç­‰çº§ï¼‰
   - æ›´æ–°signal_weightsè¡¨ï¼ˆä¿¡å·æƒé‡ï¼‰
   - æ›´æ–°adaptive_paramsè¡¨ï¼ˆç­–ç•¥å‚æ•°ï¼‰
    â†“
5. è®°å½•ä¼˜åŒ–å†å²
   - ä¼˜åŒ–æ—¶é—´
   - ä¼˜åŒ–å†…å®¹
   - é¢„æœŸæ•ˆæœ
```

### æ‰‹åŠ¨è§¦å‘ä¼˜åŒ–

**APIç«¯ç‚¹**:
```python
POST /api/optimize
{
    "hours": 24,           # åˆ†ææ—¶é—´èŒƒå›´
    "auto_apply": true,    # æ˜¯å¦è‡ªåŠ¨åº”ç”¨
    "apply_params": true,  # æ˜¯å¦è°ƒæ•´å‚æ•°
    "apply_weights": true  # æ˜¯å¦è°ƒæ•´æƒé‡
}
```

**å‘½ä»¤è¡Œ**:
```bash
python scripts/run_optimizer.py --hours 24 --auto-apply
```

---

## æ•°æ®åº“è¡¨ç»“æ„

### trading_symbol_rating (äº¤æ˜“å¯¹è¯„çº§è¡¨)
```sql
CREATE TABLE trading_symbol_rating (
    id INT PRIMARY KEY AUTO_INCREMENT,
    symbol VARCHAR(50) NOT NULL UNIQUE,
    rating_level INT NOT NULL DEFAULT 0,          -- è¯„çº§ç­‰çº§
                                                   -- 0=ç™½åå•
                                                   -- 1=é»‘åå•1çº§(è­¦å‘Š)
                                                   -- 2=é»‘åå•2çº§(é™åˆ¶)
                                                   -- 3=é»‘åå•3çº§(æ°¸ä¹…ç¦æ­¢)
    margin_multiplier DECIMAL(10,4) DEFAULT 1.0,  -- ä¿è¯é‡‘å€æ•°
    score_bonus INT DEFAULT 0,                     -- å¼€ä»“è¯„åˆ†åŠ åˆ†
    reason TEXT,                                   -- è¯„çº§åŸå› 
    hard_stop_loss_count INT DEFAULT 0,            -- ç¡¬æ­¢æŸæ¬¡æ•°
    total_loss_amount DECIMAL(20,8) DEFAULT 0,     -- æ€»äºæŸé‡‘é¢
    total_profit_amount DECIMAL(20,8) DEFAULT 0,   -- æ€»ç›ˆåˆ©é‡‘é¢
    win_rate DECIMAL(5,4) DEFAULT 0,               -- èƒœç‡
    total_trades INT DEFAULT 0,                    -- æ€»äº¤æ˜“æ¬¡æ•°
    previous_level INT,                            -- ä¸Šä¸€ä¸ªç­‰çº§
    level_changed_at TIMESTAMP,                    -- ç­‰çº§å˜æ›´æ—¶é—´
    level_change_reason VARCHAR(500),              -- ç­‰çº§å˜æ›´åŸå› 
    stats_start_date DATE NOT NULL,                -- ç»Ÿè®¡å¼€å§‹æ—¥æœŸ
    stats_end_date DATE NOT NULL,                  -- ç»Ÿè®¡ç»“æŸæ—¥æœŸ
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

**è¯„çº§ç­‰çº§è¯´æ˜**:
- **Level 0 (ç™½åå•)**: æ­£å¸¸äº¤æ˜“ï¼Œæ— é™åˆ¶
- **Level 1 (è­¦å‘Š)**: é¦–æ¬¡è§¦å‘é»‘åå•æ¡ä»¶ï¼Œé™ä½ä»“ä½50%
- **Level 2 (é™åˆ¶)**: äºŒæ¬¡è§¦å‘ï¼Œä»“ä½é™ä½75%æˆ–æš‚æ—¶ç¦ç”¨
- **Level 3 (æ°¸ä¹…ç¦æ­¢)**: æŒç»­è¡¨ç°å·®ï¼Œå®Œå…¨ç¦æ­¢äº¤æ˜“

### signal_weights
```sql
CREATE TABLE signal_weights (
    id INT PRIMARY KEY AUTO_INCREMENT,
    component VARCHAR(50) NOT NULL UNIQUE,  -- ä¿¡å·ç»„ä»¶å
    weight DECIMAL(10,4) DEFAULT 1.0,       -- æƒé‡
    performance_score DECIMAL(10,4),        -- è¡¨ç°è¯„åˆ†
    last_updated DATETIME,
    update_reason TEXT
);
```

### strategy_params
```sql
CREATE TABLE strategy_params (
    id INT PRIMARY KEY AUTO_INCREMENT,
    param_name VARCHAR(50) NOT NULL UNIQUE,
    param_value TEXT NOT NULL,
    param_type VARCHAR(20),  -- int, float, string
    description TEXT,
    last_updated DATETIME,
    update_reason TEXT
);
```

### optimization_history
```sql
CREATE TABLE optimization_history (
    id INT PRIMARY KEY AUTO_INCREMENT,
    optimization_type VARCHAR(50),  -- blacklist, weight, param
    target VARCHAR(100),            -- ä¼˜åŒ–ç›®æ ‡ï¼ˆäº¤æ˜“å¯¹/ä¿¡å·/å‚æ•°ï¼‰
    old_value TEXT,
    new_value TEXT,
    reason TEXT,
    expected_impact TEXT,           -- é¢„æœŸå½±å“
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

---

## ä¼˜åŒ–æŠ¥å‘Šç¤ºä¾‹

### æŠ¥å‘Šæ ¼å¼

```json
{
    "timestamp": "2026-02-09 10:00:00",
    "analysis_hours": 24,
    "summary": {
        "total_symbols_analyzed": 15,
        "blacklist_candidates_count": 2,
        "problematic_signals_count": 3,
        "high_severity_issues": 1
    },
    "blacklist_candidates": [
        {
            "symbol": "ATOM/USDT",
            "total_pnl": -27.56,
            "win_rate": 0.2,
            "order_count": 5,
            "reason": "äºæŸ$27.56, èƒœç‡20.0%"
        }
    ],
    "problematic_signals": [
        {
            "signal_type": "TREND_FORWARD_LONG_35",
            "direction": "LONG",
            "total_pnl": -156.82,
            "win_rate": 0.12,
            "order_count": 8,
            "avg_hold_minutes": 67,
            "severity": "medium",
            "recommendation": "å¢åŠ æœ€å°æŒä»“æ—¶é—´åˆ°120åˆ†é’Ÿ; æ”¾å®½æ­¢æŸåˆ°4%"
        }
    ],
    "weight_adjustments": [
        {
            "component": "position_shift",
            "old_weight": 10.0,
            "new_weight": 11.5,
            "performance_improvement": "+15%",
            "reason": "è¯¥ç»„ä»¶å¹³å‡ç›ˆåˆ©5.2 USDT"
        }
    ]
}
```

---

## ä¼˜åŒ–æ•ˆæœè¿½è¸ª

### å‰åå¯¹æ¯”

**ä¼˜åŒ–å‰**ï¼ˆ2026-01-15ï¼‰:
```
äº¤æ˜“å¯¹è¡¨ç°:
  ATOM/USDT: 5ç¬”, èƒœç‡20%, -27.56 USDT
  VIRTUAL/USDT: 4ç¬”, èƒœç‡0%, -35.65 USDT

ä¿¡å·è¡¨ç°:
  TREND_FORWARD_LONG_35: 8ç¬”, èƒœç‡12%, -156.82 USDT
```

**ä¼˜åŒ–å**ï¼ˆ2026-01-20ï¼‰:
```
è¡ŒåŠ¨:
  âœ… ATOM/USDT â†’ åŠ å…¥é»‘åå•
  âœ… VIRTUAL/USDT â†’ åŠ å…¥é»‘åå•
  âœ… TREND_FORWARD_LONG_35 åšå¤š â†’ å¢åŠ æŒä»“æ—¶é—´åˆ°120åˆ†é’Ÿ
  âœ… TREND_FORWARD_LONG_35 åšå¤š â†’ æ”¾å®½æ­¢æŸåˆ°4%

æ•ˆæœ:
  - é¿å…äº†ç»§ç»­åœ¨äºæŸå¸ç§ä¸Šäº¤æ˜“
  - åšå¤šä¿¡å·èƒœç‡æå‡åˆ°28%
  - æ€»ä½“ç›ˆåˆ©æ”¹å–„+12%
```

---

## é…ç½®é€‰é¡¹

### config.yaml
```yaml
adaptive_optimizer:
  enabled: true                    # æ˜¯å¦å¯ç”¨è‡ªé€‚åº”ä¼˜åŒ–
  schedule: "0 */24 * * *"        # æ¯24å°æ—¶è¿è¡Œä¸€æ¬¡
  auto_apply: true                # æ˜¯å¦è‡ªåŠ¨åº”ç”¨ä¼˜åŒ–
  analysis_hours: 24              # åˆ†ææ—¶é—´èŒƒå›´

  thresholds:
    min_orders_for_analysis: 5
    blacklist_loss_threshold: -20
    blacklist_win_rate_threshold: 0.1
    signal_direction_loss_threshold: -100

  safety:
    whitelist_protection: true    # ä¿æŠ¤å››å¤§å¤©ç‹
    max_blacklist_per_run: 5      # å•æ¬¡æœ€å¤šæ‹‰é»‘5ä¸ª
    require_confirmation: false   # æ˜¯å¦éœ€è¦äººå·¥ç¡®è®¤
```

---

## å®‰å…¨æœºåˆ¶

### 1. ç™½åå•ä¿æŠ¤
```python
# å››å¤§å¤©ç‹æ°¸ä¸æ‹‰é»‘
BLACKLIST_WHITELIST = {'BTC/USDT', 'ETH/USDT', 'SOL/USDT', 'BNB/USDT'}
```

### 2. æœ€å°æ ·æœ¬è¦æ±‚
```python
min_orders_for_analysis = 5  # è‡³å°‘5ç¬”è®¢å•æ‰è¿›è¡Œåˆ†æ
```

### 3. æ¸è¿›å¼è°ƒæ•´
```python
# æƒé‡è°ƒæ•´å¹…åº¦é™åˆ¶
max_weight_change_pct = 0.3  # å•æ¬¡æœ€å¤šè°ƒæ•´30%
```

### 4. å›æ»šæœºåˆ¶
```python
# ä¿å­˜ä¼˜åŒ–å†å²,å¯ä»¥å›æ»š
if new_performance < old_performance:
    rollback_to_previous_weights()
```

---

## æ€»ç»“

è¶…çº§å¤§è„‘çš„è‡ªæˆ‘ä¼˜åŒ–æœºåˆ¶é€šè¿‡ï¼š

1. **äº¤æ˜“å¯¹ç­›é€‰**: é»‘åå•æ·˜æ±°è¡¨ç°å·®çš„ï¼Œç™½åå•ä¿ç•™é«˜èƒœç‡çš„
2. **ä¿¡å·ä¼˜åŒ–**: è¯†åˆ«é—®é¢˜ä¿¡å·ï¼Œè°ƒæ•´å‚æ•°å’Œæƒé‡
3. **æƒé‡å­¦ä¹ **: è®©è¡¨ç°å¥½çš„ä¿¡å·ç»„ä»¶è·å¾—æ›´é«˜æƒé‡
4. **ç­–ç•¥è°ƒä¼˜**: åŠ¨æ€è°ƒæ•´æ­¢æŸã€æŒä»“æ—¶é—´ç­‰å‚æ•°

å®ç°äº†**æŒç»­å­¦ä¹ ã€è‡ªæˆ‘æ”¹è¿›**çš„é—­ç¯ç³»ç»Ÿï¼Œè®©äº¤æ˜“ç­–ç•¥éšç€å¸‚åœºå˜åŒ–ä¸æ–­ä¼˜åŒ–ã€‚

**æ ¸å¿ƒç†å¿µ**:
- ğŸ“Š æ•°æ®é©±åŠ¨å†³ç­–
- ğŸ”„ æŒç»­è¿­ä»£ä¼˜åŒ–
- ğŸ›¡ï¸ å®‰å…¨ä¿æŠ¤æœºåˆ¶
- ğŸ“ˆ è¿½æ±‚ç¨³å®šæ”¶ç›Š
